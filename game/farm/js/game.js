/*! For license information please see game.js.LICENSE.txt */
!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="./",i(i.s=11)}([function(t,e){t.exports=function(t,e,i){if(t&&"number"!=typeof t){if(t.hasOwnProperty(e))return t[e];if(-1!==e.indexOf(".")){for(var s=e.split("."),n=t,r=i,a=0;a<s.length;a++){if(!n.hasOwnProperty(s[a])){r=i;break}r=n[s[a]],n=n[s[a]]}return r}return i}return i}},function(t,e){const i=Math.PI/180;t.exports=function(t){return t*i}},function(t,e,i){var s=i(6),n=i(7),r=i(8);t.exports=function(t,e,i,a){i.addToRenderList(e);var o=t.pipelines.set(this.pipeline),h=n(e,i,a),l=o.calcMatrix.copyFrom(h.calc),d=e._displayOriginX,c=e._displayOriginY,u=i.alpha*e.alpha;e.isFilled&&s(o,l,e,u,d,c),e.isStroked&&r(o,e,u,d,c)}},function(t,e,i){var s=i(9),n=i(10),r=Phaser.Renderer.Canvas.SetTransform;t.exports=function(t,e,i,a){i.addToRenderList(e);var o=t.currentContext;if(r(t,o,e,i,a)){var h=e._displayOriginX,l=e._displayOriginY,d=e.pathData,c=d.length-1,u=d[0]-h,p=d[1]-l;o.beginPath(),o.moveTo(u,p),e.closePath||(c-=2);for(var g=2;g<c;g+=2){var m=d[g]-h,f=d[g+1]-l;o.lineTo(m,f)}o.closePath(),e.isFilled&&(s(o,e),o.fill()),e.isStroked&&(n(o,e),o.stroke()),o.restore()}}},function(t,e){var i=Phaser.Renderer.WebGL.Utils;t.exports=function(t,e,s,n){if(0!==e.width&&0!==e.height){s.addToRenderList(e);var r=e.frame,a=r.width,o=r.height,h=i.getTintAppendFloatAlpha,l=t.pipelines.set(this.pipeline,e),d=l.setTexture2D(r.glTexture,e);l.batchTexture(e,r.glTexture,a,o,e.x,e.y,a/e.style.resolution,o/e.style.resolution,e.scaleX,e.scaleY,e.rotation,e.flipX,e.flipY,e.scrollFactorX,e.scrollFactorY,e.displayOriginX,e.displayOriginY,0,0,a,o,h(e.tintTopLeft,s.alpha*e._alphaTL),h(e.tintTopRight,s.alpha*e._alphaTR),h(e.tintBottomLeft,s.alpha*e._alphaBL),h(e.tintBottomRight,s.alpha*e._alphaBR),e.tintFill,0,0,s,n,!1,d)}}},function(t,e){t.exports=function(t,e,i,s){0!==e.width&&0!==e.height&&(i.addToRenderList(e),t.batchSprite(e,e.frame,i,s))}},function(t,e){var i=Phaser.Renderer.WebGL.Utils;t.exports=function(t,e,s,n,r,a){for(var o=i.getTintAppendFloatAlpha(s.fillColor,s.fillAlpha*n),h=s.pathData,l=s.pathIndexes,d=0;d<l.length;d+=3){var c=2*l[d],u=2*l[d+1],p=2*l[d+2],g=h[c+0]-r,m=h[c+1]-a,f=h[u+0]-r,v=h[u+1]-a,b=h[p+0]-r,x=h[p+1]-a,y=e.getX(g,m),w=e.getY(g,m),k=e.getX(f,v),C=e.getY(f,v),_=e.getX(b,x),S=e.getY(b,x);t.batchTri(y,w,k,C,_,S,o,o,o)}}},function(t,e){const i=Phaser.GameObjects.Components.TransformMatrix;var s=new i,n=new i,r=new i,a={camera:s,sprite:n,calc:r};t.exports=function(t,e,i){var o=s,h=n,l=r;return h.applyITRS(t.x,t.y,t.rotation,t.scaleX,t.scaleY),o.copyFrom(e.matrix),i?(o.multiplyWithOffset(i,-e.scrollX*t.scrollFactorX,-e.scrollY*t.scrollFactorY),h.e=t.x,h.f=t.y):(h.e-=e.scrollX*t.scrollFactorX,h.f-=e.scrollY*t.scrollFactorY),o.multiply(h,l),a}},function(t,e){var i=Phaser.Renderer.WebGL.Utils;t.exports=function(t,e,s,n,r){var a=t.strokeTint,o=i.getTintAppendFloatAlpha(e.strokeColor,e.strokeAlpha*s);a.TL=o,a.TR=o,a.BL=o,a.BR=o;var h=e.pathData,l=h.length-1,d=e.lineWidth,c=d/2,u=h[0]-n,p=h[1]-r;e.closePath||(l-=2);for(var g=2;g<l;g+=2){var m=h[g]-n,f=h[g+1]-r;t.batchLine(u,p,m,f,c,c,d,g-2,!!e.closePath&&g===l-1),u=m,p=f}}},function(t,e){t.exports=function(t,e,i,s){var n=i||e.fillColor,r=s||e.fillAlpha,a=(16711680&n)>>>16,o=(65280&n)>>>8,h=255&n;t.fillStyle="rgba("+a+","+o+","+h+","+r+")"}},function(t,e){t.exports=function(t,e,i,s){var n=i||e.strokeColor,r=s||e.strokeAlpha,a=(16711680&n)>>>16,o=(65280&n)>>>8,h=255&n;t.strokeStyle="rgba("+a+","+o+","+h+","+r+")",t.lineWidth=e.lineWidth}},function(t,e,i){"use strict";i.r(e);class s extends Phaser.Scene{constructor(){super("boot")}setPreloadSprite(t){this.preloadSprite={sprite:t,width:t.width*t.scaleX,height:t.height},this.load.on("progress",this.onProgress,this)}onProgress(t){if(this.preloadSprite){let e=Math.floor(this.preloadSprite.width*t);this.preloadSprite.sprite.frame.width=e<=0?1:e,this.preloadSprite.sprite.frame.cutWidth=e,this.preloadSprite.sprite.frame.updateUVs()}}preload(){this.load.image("loading","../Mark/preloader.gif"),this.load.image("dauchung","../Mark/dauchung.png"),this.load.image("press","../Mark/press.png"),this.load.image("cover","./assets/cover.png"),this.load.image("bg_menu","./assets/preScreen/bg_menu.jpg"),this.load.image("bg_loading","./assets/preScreen/bg_loading.jpg"),this.load.image("company","./assets/preScreen/company.png"),this.load.spritesheet("logo","./assets/preScreen/logo.png",{frameWidth:375,frameHeight:150}),this.load.spritesheet("menu_player","./assets/preScreen/menu_player.png",{frameWidth:350,frameHeight:400}),this.load.spritesheet("loading_img","./assets/preScreen/loading_img.jpg",{frameWidth:245,frameHeight:255}),this.load.bitmapFont("farmText_White","./assets/farmText_White.png","./assets/farmText_White.fnt"),this.load.bitmapFont("farmText_Black","./assets/farmText_Black.png","./assets/farmText_Black.fnt"),this.load.audio("bgmSE","./assets/audio/bgm.mp3"),this.load.audio("startGameSE","./assets/audio/startGame.mp3")}create(){this.add.sprite(game.config.width/2,.4*game.config.height,"dauchung"),this.loadingbar=this.add.sprite(game.config.width/2,.65*game.config.height,"loading"),this.setPreloadSprite(this.loadingbar),this.scene.start("menu")}}class n extends Phaser.Scene{constructor(){super("load")}updateBar(t){this.newGraphics.clear(),this.newGraphics.fillStyle(13427096,1),this.newGraphics.fillRectShape(new Phaser.Geom.Rectangle(game.config.width/2-150,game.config.height-120,300*t,20)),t*=100}complete(){}preload(){this.anims.create({key:"changing",frames:this.anims.generateFrameNumbers("loading_img",{start:0,end:1}),duration:8e3,repeat:-1}),this.add.sprite(game.config.width/2,game.config.height/2,"bg_loading"),this.pic=this.add.sprite(game.config.width/2-48,game.config.height/2+40,"loading_img",0).setAngle(-3),this.pic.anims.play("changing"),this.graphics=this.add.graphics();var t=new Phaser.Geom.Rectangle(game.config.width/2-150,game.config.height-120,300,20);this.graphics.fillStyle(3550763,1),this.graphics.fillRectShape(t),this.newGraphics=this.add.graphics(),this.newGraphics.fillStyle(13427096,1),this.add.bitmapText(game.config.width/2,t.y+45,"farmText_White","讀取中...",28).setOrigin(.5),this.load.on("progress",this.updateBar,{newGraphics:this.newGraphics}),this.load.on("complete",this.complete,{scene:this.scene}),this.load.spritesheet("connecting","./assets/connecting.png",{frameWidth:200,frameHeight:200}),this.load.image("background","./assets/background.jpg"),this.load.image("beginGift","./assets/beginGift.png"),this.load.image("bg_info","./assets/bg_info.png"),this.load.image("info_photo","./assets/info_photo.png"),this.load.image("info_expStar","./assets/info_expStar.png"),this.load.image("info_expOuter","./assets/info_expOuter.png"),this.load.image("info_expInner","./assets/info_expInner.png"),this.load.image("btn_close","./assets/btn_close.png"),this.load.image("btn_add","./assets/btn_add.png"),this.load.image("btn_less","./assets/btn_less.png"),this.load.image("btn_yes","./assets/btn_yes.png"),this.load.image("btn_no","./assets/btn_no.png"),this.load.image("btn_QA","./assets/btn_QA.png"),this.load.spritesheet("btn_receive","./assets/btn_receive.png",{frameWidth:65,frameHeight:40}),this.load.spritesheet("obj_coin","./assets/obj_coin.png",{frameWidth:110,frameHeight:110}),this.load.spritesheet("obj_crop","./assets/obj_crop.png",{frameWidth:120,frameHeight:100}),this.load.image("land_dig","./assets/land_dig.png"),this.load.image("land_seed","./assets/land_seed.png"),this.load.image("land_water","./assets/land_water.png"),this.load.image("land_fertilizer","./assets/land_fertilizer.png"),this.load.image("land_quickBG","./assets/land_quickBG.png"),this.load.image("land_quickBtn","./assets/land_quickBtn.png"),this.load.spritesheet("land_actions","./assets/land_actions.png",{frameWidth:65,frameHeight:70}),this.load.spritesheet("land_rainbow","./assets/land_rainbow.png",{frameWidth:110,frameHeight:70}),this.load.image("bg_action","./assets/bg_action.png"),this.load.image("uibtn_task","./assets/uibtn_task.png"),this.load.image("uibtn_signIn","./assets/uibtn_signIn.png"),this.load.image("uibtn_achievement","./assets/uibtn_achievement.png"),this.load.image("uibtn_book","./assets/uibtn_book.png"),this.load.image("uibtn_shop","./assets/uibtn_shop.png"),this.load.image("uibtn_warehouse","./assets/uibtn_warehouse.png"),this.load.image("uibtn_crop","./assets/uibtn_crop.png"),this.load.image("uibtn_tool","./assets/uibtn_tool.png"),this.load.audio("coinSE","./assets/audio/coin.mp3"),this.load.audio("actionSE","./assets/audio/action.mp3"),this.load.audio("harvestSE","./assets/audio/harvest.mp3"),this.load.audio("warningSE","./assets/audio/warning.mp3"),this.load.audio("btnCloseSE","./assets/audio/btnClose.mp3"),this.load.audio("giftBoardSE","./assets/audio/giftBoard.mp3"),this.load.audio("unlockBookSE","./assets/audio/unlockBook.mp3"),this.load.audio("clickSE","./assets/audio/click.mp3"),this.load.audio("clickPartnerSE","./assets/audio/clickPartner.mp3")}create(){this.time.addEvent({delay:500,callback:function(){this.count()},callbackScope:this,loop:!0})}count(){this.scene.start("play")}}for(var r,a=10,o=10,h=!1,l="勤勞の貓貓",d=1,c=900,u=86e3,p=88e3,g=!0,m=3,f=3,v=5,b=[10,20,30,5,30],x=[50,30,50,20,10,0,0,0,0,0,0,0,0,0,0],y=[10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],w=[20,20,20,0,0,0,0,0],k=[!1,!1,!1,!1,!1,!1,!1,!1],C=[!1,!1,!1],_=[],S=[],T=[],O=[],E=[],P=[],M=[],I=[],B=[],j=[],z=[],D=[],L=[],R=[],U=[],F=0;F<10;F++)_.push(0),S.push(0),T.push(0),O.push(!1),E.push(!1),P.push(!1),M.push(!0),I.push(!0),B.push(!0),j.push(20),z.push(30),D.push(50),L.push(0),R.push(0),U.push(0);var W=[],Y=[],A=[];for(F=0;F<15;F++)W.push(30),Y.push(0),A.push(!1);var H=[],V=[],N=[];for(F=0;F<20;F++)H.push(20),V.push(0),N.push(!1);var G=[],X=[],J=[];for(F=0;F<10;F++)G.push(7),X.push(0),J.push(!1);var K=[{type:"obj_coin",id:1,num:300},{type:"obj_seed",id:0,num:1},{type:"obj_tool",id:0,num:2},{type:"obj_coin",id:1,num:400},{type:"obj_seed",id:1,num:2},{type:"obj_tool",id:1,num:3},{type:"obj_seed",id:0,num:3}],Z=[],q=[],$=[],Q=[],tt=[20,40,60,240,720,2160,2880,5760,12960,17280,13440,17280,20160,34560,38880],et=2,it=1e3,st=[{type:"obj_coin",id:0,num:6e3},{type:"obj_seed",id:1,num:5},{type:"obj_tool",id:2,num:3}],nt=[{type:"land",id:5,pic_index:0},{type:"warehouse",id:4,pic_index:0},{type:"plant",id:2,pic_index:1}],rt=[3,4,5,6,7,8,9,10,11,12,13,14,15],at=[3e3,6e3,1e4,15e3,21e3,28e3,36e3,45e3,55e3,66e3,78e3,91e3,105e3],ot=[[{type:"obj_coin",id:0,num:4e3},{type:"obj_seed",id:2,num:5},{type:"obj_tool",id:0,num:2}],[{type:"obj_coin",id:0,num:2e3},{type:"obj_tool",id:0,num:2},{type:"obj_tool",id:1,num:5}],[{type:"obj_seed",id:4,num:5},{type:"obj_tool",id:1,num:5},{type:"obj_tool",id:2,num:3}],[{type:"obj_coin",id:0,num:4e3},{type:"obj_seed",id:11,num:5},{type:"obj_tool",id:0,num:2}],[{type:"obj_coin",id:0,num:2e3},{type:"obj_seed",id:8,num:5},{type:"obj_tool",id:2,num:3}],[{type:"obj_coin",id:0,num:4e3},{type:"obj_tool",id:0,num:2},{type:"obj_tool",id:1,num:5}],[{type:"obj_coin",id:0,num:2e3},{type:"obj_tool",id:1,num:5},{type:"obj_tool",id:2,num:3}],[{type:"obj_seed",id:12,num:5},{type:"obj_seed",id:3,num:5},{type:"obj_tool",id:0,num:1}],[{type:"obj_seed",id:13,num:5},{type:"obj_tool",id:0,num:1},{type:"obj_tool",id:2,num:3}],[{type:"obj_coin",id:0,num:800},{type:"obj_seed",id:9,num:5},{type:"obj_tool",id:2,num:3}],[{type:"obj_seed",id:6,num:5},{type:"obj_tool",id:0,num:1},{type:"obj_tool",id:1,num:4}],[{type:"obj_coin",id:0,num:800},{type:"obj_seed",id:7,num:5},{type:"obj_seed",id:10,num:5}],[{type:"obj_tool",id:0,num:1},{type:"obj_tool",id:1,num:4},{type:"obj_tool",id:2,num:1}]],ht=[1,4,8,10,12,13,14,15],lt=[2e3,3e3,5e3,6e3,9e3,16e3,2e4],dt=[],ct=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],ut=[0,0,0,0,0,300,500,1e3,1800,2100,2400,3e3,0,0,0,0,0,0,0,0],pt=[0,0,0,0,0,0,0,0,0,0,0,0,300,400,600,800,1100,1400,1800,2200],gt=["鏟子","水壺","初級肥料","中級肥料","高級肥料"],mt=[1800,4800,12e3],ft=["稻米","紅蘿蔔","玉米","蕃茄","豌豆","馬鈴薯","甜菜根","蔥","辣椒","高麗菜","南瓜","茄子","鳳梨","甜椒","白花椰菜"],vt=[],bt=[],xt=[],yt=[],wt=[],kt=[180,110,216,576,990],Ct=[10,10,10,10,10],_t=[100,110,120,130,150,200,300,400,520,660,720,840,900,1200,1500],St=[11,14,17,22,26,35,45,55,60,75,78,80,74,96,98],Tt=[20,40,60,240,720,2160,2880,5760,12960,17280,13440,17280,20160,34560,38880],Ot=[40,80,240,360,1080,2040,3420,9540,9840,10920,21060,26520,31140,22440,27120],Et=[30,29700,25800,26700,22500,22200,19500,18900,15e3,15900,11700,11400,8700,8100,4200],Pt=[10,9,9,8,8,9,10,8,12,12,10,14,13,14,16],Mt=[100,300,400,600,200,400,700,500,300,400,200,800,600,800,1e3],It=[1,2,2,2,2,2,2,2,5,5],Bt=["累計收成作物","累計種植作物","累計使用澆水","前往商店購買工具","前往商店購買種子","點擊來訪小夥伴","累計販售獲取貓鑽","累計消耗歐兔幣"],jt=[5,10,15,5,10,1,3e3,30],zt=[{type:"obj_coin",id:0,num:300},{type:"obj_seed",id:0,num:1},{type:"obj_tool",id:0,num:2},{type:"obj_coin",id:0,num:400},{type:"obj_seed",id:1,num:2},{type:"obj_tool",id:1,num:3},{type:"obj_seed",id:0,num:3},{type:"obj_tool",id:0,num:2}],Dt=[{type:"obj_coin",id:0,num:200},{type:"obj_seed",id:1,num:3},{type:"obj_tool",id:2,num:2}],Lt=["作伙來呷飯","東方小人參","金黃色的澱粉","蔬菜水果傻傻不分","四胞胎也不奇怪","傳說的地下人蔘","植物界的奶媽","有人喜歡有人討厭","喝水是沒有用的","火鍋好搭檔","不要再玩食物了","都給你不用搶","旺來旺旺來","爆量維生素C","減醣好夥伴"],Rt=["累計種植稻米","累計種植紅蘿蔔","累計種植玉米","累計種植蕃茄","累計種植豌豆","累計種植馬鈴薯","累計種植甜菜根","累計種植蔥","累計種植辣椒","累計種植高麗菜","累計種植南瓜","累計種植茄子","累計種植鳳梨","累計種植甜椒","累計種植白花椰菜"],Ut=[3600,1800,720,360,120,80,80,70,50,50,40,40,30,25,25],Ft=[{type:"obj_tool",id:0,num:1},{type:"obj_seed",id:2,num:1},{type:"obj_coin",id:0,num:1e3},{type:"obj_tool",id:2,num:1},{type:"obj_tool",id:0,num:1},{type:"obj_seed",id:13,num:1},{type:"obj_tool",id:0,num:1},{type:"obj_coin",id:0,num:1e3},{type:"obj_tool",id:0,num:1},{type:"obj_tool",id:2,num:1},{type:"obj_coin",id:0,num:1e3},{type:"obj_tool",id:1,num:1},{type:"obj_tool",id:2,num:1},{type:"obj_tool",id:1,num:1},{type:"obj_coin",id:0,num:8e3}],Wt=["鼠來寶","行走的零食庫","開口就讓你閉嘴","犯人就是你","橘貓才不胖！","拼命的小豬","我只想下班","只想整到你","紅得像蘋果","你的笑容幾分甜？","哪裡都能滑","壞小孩最怕","一起chill","NASA都想挖角","好玩到咩噗","世界為我打轉","打球打起來！","童玩小能手","教練我想打球","走路自帶BGM"],Yt=["和羅尼親密度達到","和諾可親密度達到","和米米親密度達到","和萌萌親密度達到","和小橘親密度達到","和潘蒂親密度達到","和布司親密度達到","和步妮親密度達到","和寶拉親密度達到","和嘿琪親密度達到","和撲麥親密度達到","和卡卡親密度達到","和婕絲霓親密度達到","和阿奈親密度達到","和奇塔親密度達到","和碰碰親密度達到","和阿庫親密度達到","和喀布親密度達到","和奇弟親密度達到","和吉特斯親密度達到"],At=[20,20,20,20,20,30,30,30,30,30,50,50,30,50,50,20,50,50,30,30],Ht=[{type:"obj_coin",id:0,num:1e3},{type:"obj_coin",id:0,num:3e3},{type:"obj_coin",id:0,num:3e3},{type:"obj_coin",id:0,num:1e3},{type:"obj_coin",id:0,num:2e3},{type:"obj_tool",id:0,num:1},{type:"obj_tool",id:2,num:1},{type:"obj_tool",id:0,num:1},{type:"obj_tool",id:1,num:1},{type:"obj_tool",id:0,num:1},{type:"obj_seed",id:2,num:15},{type:"obj_tool",id:2,num:1},{type:"obj_tool",id:0,num:1},{type:"obj_seed",id:0,num:10},{type:"obj_tool",id:1,num:1},{type:"obj_coin",id:0,num:2e3},{type:"obj_coin",id:0,num:4e3},{type:"obj_coin",id:0,num:6e3},{type:"obj_coin",id:0,num:3e3},{type:"obj_coin",id:0,num:2e3}],Vt=["脫胎換骨","只要用心就做得到","我是大富翁","振興市場經濟","長得跟大樹一樣","沒事多喝水","農場生活不簡單","一隻都不能少","給我更多的寶物！","勤勞寶寶"],Nt=["等級達成","連續簽到","累計持有貓鑽","累計販售獲取貓鑽","累計施肥","累計澆水","累計挖除","累計收集圖鑑","累計開啟任務寶箱","累計完成每日任務"],Gt=[10,7,1e6,65e3,100,200,100,120,25,60],Xt=[{type:"obj_coin",id:0,num:1e3},{type:"obj_coin",id:0,num:2e3},{type:"obj_tool",id:2,num:5},{type:"obj_tool",id:1,num:5},{type:"obj_coin",id:0,num:3e3},{type:"obj_coin",id:0,num:4e3},{type:"obj_tool",id:0,num:5},{type:"obj_coin",id:0,num:3e3},{type:"obj_tool",id:1,num:5},{type:"obj_tool",id:2,num:3}];function Jt(){return d}function Kt(){return c}function Zt(t,e){1==e?c+=t:c=t}function qt(){return u}function $t(t,e){1==e?u+=t:u=t}function Qt(){return p}function te(t,e){1==e?p+=t:p=t}function ee(){return Q}function ie(t,e){Q[t]=e}function se(){return tt}function ne(t,e){tt[t]=e}function re(){return v}function ae(){return f}function oe(){return b}function he(t,e,i){1==i?b[t]+=e:b[t]=e}function le(){return x}function de(t,e,i){1==i?x[t]+=e:x[t]=e}function ce(){return y}function ue(t,e,i){1==i?y[t]+=e:y[t]=e}function pe(){return w}function ge(t,e,i){e=parseInt(e),1==i?w[t]+=e:w[t]=e}function me(){return k}function fe(){return W}function ve(t,e,i){1==i?W[t]+=e:W[t]=e}function be(){return Y}function xe(){return A}function ye(){return H}function we(t,e,i){1==i?H[t]+=e:H[t]=e}function ke(){return V}function Ce(){return N}function _e(){return G}function Se(t,e,i){1==i?G[t]+=e:G[t]=e}function Te(){return X}function Oe(){return J}function Ee(){return m}function Pe(){return K}function Me(){return _}function Ie(t,e,i){1==i?_[t]+=e:_[t]=e}function Be(){return M}function je(t,e){M[t]=e}function ze(){return L}function De(){return S}function Le(t,e,i){1==i?S[t]+=e:S[t]=e}function Re(){return I}function Ue(t,e){I[t]=e}function Fe(){return R}function We(){return T}function Ye(t,e,i){1==i?T[t]+=e:T[t]=e}function Ae(){return B}function He(t,e){B[t]=e}function Ve(){return U}function Ne(){return O}function Ge(){return E}function Xe(){return P}function Je(){return et}function Ke(){return it}function Ze(){return gt}function qe(){return mt}function $e(){return ft}function Qe(){return Tt}function ti(){return Ot}function ei(){return Et}function ii(){return Bt}function si(){return jt}function ni(){return zt}function ri(){return Lt}function ai(){return Rt}function oi(){return Ut}function hi(){return Ft}function li(){return Wt}function di(){return Yt}function ci(){return At}function ui(){return Ht}function pi(){return Vt}function gi(){return Nt}function mi(){return Gt}function fi(){return Xt}function vi(t,e,i){Oi(t,"clickSE");var s=void 0;return"Sprite"==e.type&&(s=e.texture.key),t.tweens.add({targets:e,scaleX:{from:.8,to:1},scaleY:{from:.8,to:1},duration:100,ease:"Bounce.Out",callbackScope:this,onComplete:function(){switch(s){case"btn_close":if(0==i)return;null!=t.smallBoard?(Ci(t),_i(t)):t.events.emit("btn_close");break;case"btn_QA":e.rexContainer.parent.getElement("btn_QA").setInteractive();var n=e.rexContainer.parent.rexContainer.parent;t.smallCover=t.add.sprite(n.x+1,n.y-5,"smallCover"),"book"==e.rexContainer.parent.name?t.events.emit("showTeach",{page:2}):"warehouse"==e.rexContainer.parent.name&&t.events.emit("showTeach",{page:3});break;case"btn_no":"UI"==t.sys.config?(wi(t),ki(t),t.releaseUIbtn()):"loadObjects"==t.sys.config&&(Ci(t),_i(t)),t.events.emit("releaseDrag");break;case"btn_yes":if(0==i)return;t.events.emit("releaseDrag")}}})}function bi(t,e){var i=t.cameras.main.midPoint.x,s=t.cameras.main.midPoint.y,n=20*e.length+20,r=t.add.container(i-n/2,s).setDepth(1),a=t.add.graphics();a.fillStyle(0,.6),a.fillRoundedRect(0,0,n,35,10),r.add(a);var o=t.add.bitmapText(10,5,"farmText_White",e,20);r.add(o),t.tweens.add({targets:r,y:r.y-50,alpha:0,ease:"Linear",duration:800})}function xi(t,e){t.tweens.add({targets:e,scaleX:{from:.8,to:1},scaleY:{from:.8,to:1},ease:"Back",duration:400})}function yi(t){null==t.cover&&(t.cover=t.add.sprite(0,0,"cover").setOrigin(0,0).setDepth(1)),t.events.emit("lockLand")}function wi(t){null!=t.board&&("rexDialog"==t.board.type?t.board.scaleDownDestroy(100):"rexScrollablePanel"==t.board.type&&t.board.moveToDestroy(200,void 0,t.y),t.board=void 0)}function ki(t){null!=t.cover&&(t.cover.setVisible(!1),t.cover=void 0),t.events.emit("releaseLand")}function Ci(t){null!=t.smallBoard&&(t.smallBoard.scaleDownDestroy(100),t.smallBoard=void 0)}function _i(t){null!=t.smallCover&&(t.smallCover.setVisible(!1),t.smallCover=void 0)}function Si(t,e,i){var s=e.texture.key,n=e.frame.name,r=t.add.sprite(e.x,e.y-40,s,n);r.setScale(.5);var a,o,h=t.cameras.main.midPoint.x-70,l=t.cameras.main.midPoint.y-320,d=t.cameras.main.midPoint.x+140,c=t.cameras.main.midPoint.y+320;"obj_coin"==s?(a=h,o=l):(a=d,o=c);var u=Phaser.Math.Distance.Between(r.x,r.y-30,a,o),p=t.tweens.createTimeline();p.add({targets:r,y:"-=15",duration:300,ease:"Back"}),p.add({targets:r,x:{from:r.x,to:a},y:{from:r.y-30,to:o},duration:1.2*u,onComplete:function(){r.destroy()}}),p.play(),Ti(t,e,i)}function Ti(t,e,i){var s=e.texture.key,n=e.frame.name,r=parseInt(i);switch(s){case"obj_coin":"loadObjects"==t.sys.config?t.events.emit("calculate",{coinInc:r,O2pointInc:0}):"UI"==t.sys.config&&($t(r,!0),t.updateMemberCoin());break;case"obj_seed":de(n,r,!0);break;case"obj_tool":he(n,r,!0);break;case"obj_crop":ue(n,r,!0)}}function Oi(t,e){var i=t.sound.add(e);try{i.play()}catch(t){}}function Ei(t){return PlantPicIndexData[t]}function Pi(t){return PropPicIndexData[t]}var Mi;class Ii extends Phaser.Scene{constructor(){super("menu")}init(){}create(){this.sound.add("bgmSE",{volume:1,loop:!0}).play();let t=this.add.sprite(0,0,"bg_menu").setOrigin(0);t.setInteractive().on("pointerdown",(function(){Oi(this,"startGameSE"),t.input.enabled=!1,this.scene.start("load")}),this);let e=this.add.sprite(game.config.width/2,-150,"logo");this.tweens.add({targets:e,y:100,duration:1e3,ease:"Bounce.Out",onComplete:function(){this.anims.create({key:"logo",frames:this.anims.generateFrameNumbers("logo",{start:0,end:3}),duration:800,repeat:-1}),e.play("logo")},callbackScope:this});let i=this.add.sprite(290,570,"menu_player");this.anims.create({key:"menu_player",frames:this.anims.generateFrameNumbers("menu_player",{start:0,end:14}),frameRate:10,repeat:-1}),i.play("menu_player");let s=this.add.sprite(game.config.width/2,game.config.height-80,"press");this.tweens.add({targets:s,alpha:0,duration:600,yoyo:!0,repeat:-1,repeatDelay:800}),this.add.sprite(game.config.width-10,game.config.height-10,"company").setOrigin(1,1)}}class Bi{create(t){t.load.image([{key:"bg_smallBoard",url:"/games/farm/assets/bg_smallBoard.png"}]),t.load.spritesheet([{key:"title_afterUnboxing",url:"/games/farm/assets/title_afterUnboxing.png",frameConfig:{frameWidth:425,frameHeight:280}}]),t.load.once("complete",(function(){t.smallBoard=Di(t)}),t),t.load.start()}}var ji,zi,Di=function(t){Oi(t,"giftBoardSE"),t.anims.create({key:"title_afterUnboxing",frames:t.anims.generateFrameNumbers("title_afterUnboxing",{start:0,end:3}),frameRate:6,repeat:-1});var e=Dt;Mi=t.rexUI.add.dialog({x:game.config.width/2,y:game.config.height/2,width:600,height:365,scrollMode:1,background:t.add.image(0,0,"bg_smallBoard"),title:t.add.sprite(0,0,"title_afterUnboxing").anims.play("title_afterUnboxing"),actions:[Li(t,e[0].type,e[0].id,e[0].num),Li(t,e[1].type,e[1].id,e[1].num),Li(t,e[2].type,e[2].id,e[2].num)],space:{left:10,right:10,top:-70,bottom:0,actionsLeft:30,title:-50,action:10},expand:{title:!1,content:!1}}).layout(),t.rexUI.add.click(Mi,{threshold:10}).on("click",(function(){Ci(t),_i(t)}));for(var i=Mi.getElement("actions"),s=0;s<i.length;s++)Ti(t,i[s].getElement("gift"),i[s].getElement("num").text.substr(1));return Mi},Li=function(t,e,i,s){var n;switch(e){case"obj_coin":n=0;break;case"obj_seed":case"obj_tool":n=i}var r=t.add.sprite(0,0,e,n),a=90/r.width;r.setScale(a);var o=t.add.bitmapText(0,0,"farmText_Black","+"+s,20);return t.rexUI.add.sizer({orientation:0,space:{left:0,right:0,top:0,bottom:0,item:0}}).add(r,0,"center",{left:0},!1,"gift").add(o,0,"center",{left:-5,top:50},!1,"num")};class Ri{create(t){t.anims.create({key:"boxShining",frames:t.anims.generateFrameNumbers("obj_box",{start:1,end:3}),frameRate:5,repeat:-1}),ji=t.rexUI.add.dialog({x:game.config.width/2,y:game.config.height/2-10,width:500,height:565,background:t.add.sprite(0,0,"bg_table"),title:Fi(t),content:Yi(t),description:t.rexUI.add.tabs({x:game.config.width/2,y:game.config.height/2,scrollMode:0,panel:t.rexUI.add.gridTable({background:t.add.sprite(0,0,"bg_rect"),scrollMode:0,table:{width:460,height:380,cellHeight:85,columns:1},createCellContainerCallback:function(t,e){var i=t.scene,s=t.width,n=t.item,r=t.index;null===e&&(e=Xi(i)),e.setMinSize(s,80),e.getElement("script").setText(n.taskList);var a=Gi(e.getElement("script").text,"(");r=Ni(a);n.taskNum=si()[r],n.taskGift=ni()[r],n.memberTask=pe()[r],n.isReceived=me()[r],n.memberTask>n.taskNum&&(n.memberTask=n.taskNum);var o,h=a+"("+n.memberTask+"/"+n.taskNum+")";switch(n.taskGift.type){case"obj_coin":o=0;break;case"obj_seed":case"obj_tool":o=n.taskGift.id}return e.getElement("prize").setTexture(n.taskGift.type).setFrame(o),e.getElement("awardNum").setText(n.taskGift.num),e.getElement("script").setText(h),1==n.isReceived?e.getElement("btn_receive").setFrame(2):n.memberTask>=n.taskNum?e.getElement("btn_receive").setFrame(1):e.getElement("btn_receive").setFrame(0),e},space:{left:10,right:10,top:5,bottom:5}}),topButtons:[Zi(t)],space:{left:10,right:10}}).layout(),space:{title:15},expand:{title:!1,content:!1,description:!1},align:{title:"center",description:"center"}}).layout();var e=Ji(8,"label_daily");return zi="label_daily",ji.getElement("description").getTopButton(0).getElement(zi).getElement("background").setFrame(0),ji.getElement("description").getElement("panel").setItems(e).scrollToTop(),ji.getElement("description").getElement("panel").on("cell.click",(function(e,i){var s,n=e.getElement("btn_receive");if(t.rexUI.isInTouching(n)){if(null!=t.smallCover)return;if(1==n.frame.name){vi(t,n);var r=Gi(e.getElement("script").text,"("),a=Ni(r);if(null==a)return;ge(a,si()[a],!1),s=!0,k[a]=s,Se(9,1,!0),Ki(),Si(t,e.getElement("prize"),e.getElement("awardNum").text),n.setFrame(2)}}}),t),xi(t,ji),ji}}var Ui,Fi=function(t){var e=t.add.sprite(0,0,"title_task");return t.rexUI.add.sizer({orientation:0,space:{left:0,right:0,top:0,bottom:0,item:0}}).add(e,0,"center",{left:30,right:-15},!1,"title").add(Wi(t,"btn_close"),0,"top",{top:-10},!1,"btn_close")},Wi=function(t,e){var i=t.add.sprite(0,0,e,0).setInteractive().on("pointerdown",(function(){null==t.smallCover&&vi(t,i)}));return i},Yi=function(t){return t.rexUI.add.sizer({orientation:1,space:{left:0,right:0,top:0,bottom:0,item:-30}}).add(Vi(t),0,"center",{top:0},!1,"contentBar").add(Ai(t),0,"left",{left:0},!1,"contentButton")},Ai=function(t){return t.rexUI.add.sizer({}).add(Hi(t,"obj_box1"),0,"center",{left:140},!1,"obj_box1").add(Hi(t,"obj_box2"),0,"center",{left:100},!1,"obj_box2").add(Hi(t,"obj_box3"),0,"center",{left:55},!1,"obj_box3")},Hi=function(t,e){var i,s=e.indexOf("x")+1,n=e.substr(s)-1;i=1==C[n]?4:0;var r=t.add.sprite(0,0,"obj_box",i).setInteractive().on("pointerup",(function(){null==t.smallCover&&r.anims.isPlaying&&($i(t),Se(8,1,!0),function(t,e){C[t]=e}(n,!0),r.stop(),r.setFrame(4),r.removeInteractive())}),t);return r},Vi=function(t){var e=t.rexUI.add.numberBar({width:380,background:t.rexUI.add.roundRectangle(0,0,0,0,5,2493956),slider:{track:t.rexUI.add.roundRectangle(0,0,0,0,5,6310975),indicator:t.rexUI.add.roundRectangle(0,0,0,0,5,16299565)},valuechangeCallback:function(t,e,i){var s,n=120*t;n>=120?s=3:n>=90?s=2:n>=45&&(s=1);for(var r=1;r<=s;r++){var a=ji.getElement("content").getElement("contentButton");4!=a.getElement("obj_box"+r).frame.name&&a.getElement("obj_box"+r).anims.play("boxShining")}}}).layout();return e.setValue(0,0,120),e},Ni=function(t){for(var e=ii(),i=0;i<e.length;i++)if(e[i]==t)return i},Gi=function(t,e){var i=t.indexOf(e);return t.substr(0,i)},Xi=function(t){var e=t.add.sprite(0,0,"bg_taskRect"),i=t.add.sprite(0,0,"obj_seed",0).setScale(.45),s=t.add.bitmapText(0,0,"farmText_Black","",14),n=t.add.bitmapText(0,0,"farmText_Black","",20),r=t.add.sprite(0,0,"btn_receive",0);return t.rexUI.add.sizer({orientation:0}).addBackground(e).add(i,0,"center",{left:5},!1,"prize").add(s,1,"center",{left:-30,top:50},!1,"awardNum").add(n,1,"left",{left:-250},!1,"script").add(r,0,"center",{right:10},!1,"btn_receive")},Ji=function(t,e){let i,s,n,r,a;switch(Ki(),e){case"label_daily":i=ii(),s=si(),r=pe(),n=ni(),a=me()}for(var o,h=[],l=0;l<t;l++)o=r[l]>=s[l],h.push({taskList:i[l]+"("+r[l]+"/"+s[l]+")",taskNum:s[l],memberTask:r[l],taskGift:n[l],isComplete:o,isReceived:a[l]});var d=[],c=[],u=[];for(l=0;l<t;l++)1==a[l]&&1==h[l].isComplete?u.push(h[l]):1==h[l].isComplete?d.push(h[l]):c.push(h[l]);return d.concat(c).concat(u)},Ki=function(){for(var t=0,e=me(),i=0;i<e.length;i++)1==e[i]&&t++;ji.getElement("content").getElement("contentBar").setValue(15*t,0,120)},Zi=function(t){return t.rexUI.add.sizer({orientation:0,space:{left:10,right:0,top:0,bottom:0,item:80}}).add(qi(t,"label_daily",8),0,"bottom",{left:0},!1,"label_daily")},qi=function(t,e,i){var s=t.rexUI.add.label({width:80,height:35,orientation:0,background:t.add.sprite(0,0,e,1),align:"center"});return s.setInteractive().on("pointerdown",(function(){if(null==t.smallCover){s.getElement("background").setFrame(0);var n=Ji(i,e);ji.getElement("description").getElement("panel").setItems(n).scrollToTop(),zi!=e&&ji.getElement("description").getTopButton(0).getElement(zi).getElement("background").setFrame(1),zi=e}})),s},$i=function(t){t.smallCover=t.add.sprite(ji.x+1,ji.y-5,"smallCover"),(new Bi).create(t)};class Qi{create(t,e,i,s){t.load.image([{key:"bg_smallBoard",url:"/games/farm/assets/bg_smallBoard.png"}]),t.load.spritesheet([{key:"title_afterSignIn",url:"/games/farm/assets/title_afterSignIn.png",frameConfig:{frameWidth:425,frameHeight:280}}]),t.load.once("complete",(function(){t.smallBoard=es(t,e,i,s)}),t),t.load.start()}}var ts,es=function(t,e,i,s){return Oi(t,"giftBoardSE"),t.anims.create({key:"title_afterSignIn",frames:t.anims.generateFrameNumbers("title_afterSignIn",{start:0,end:3}),frameRate:6,repeat:-1}),Ui=t.rexUI.add.dialog({x:game.config.width/2,y:game.config.height/2,width:600,height:365,scrollMode:1,background:t.add.image(0,0,"bg_smallBoard"),title:t.add.sprite(0,0,"title_afterSignIn").anims.play("title_afterSignIn"),content:is(t,e,i,s),space:{left:10,right:10,top:-70,bottom:0,title:-50},expand:{title:!1}}).layout().popUp(300).setDepth(1),t.rexUI.add.click(Ui,{threshold:10}).on("click",(function(){Ci(t),_i(t)})),Ui},is=function(t,e,i,s){var n=t.add.sprite(0,0,e,i).setScale(1.3);s=t.rexUI.add.label({width:50,height:50,text:t.add.bitmapText(0,0,"farmText_Black","+"+s,20)});return t.rexUI.add.sizer({orientation:1,space:{left:0,right:0,top:0,bottom:0,item:0}}).add(n,0,"center",{left:0},!1,"awards").add(s,0,"center",{left:170,top:-30},!1,"num")};class ss{create(t){var e=g;ts=t.rexUI.add.dialog({x:game.config.width/2,y:game.config.height/2-10,width:500,height:565,background:t.add.sprite(0,0,"bg_signInBoard"),title:os(t),choices:[ls(t,3,1),ls(t,4,4)],space:{left:10,right:10,top:0,bottom:0,title:135},expand:{title:!1,choices:!1},align:{title:"right",choices:"center"}}).layout(),xi(t,ts);var i=Ee();if(1==e)if((i+=1)>3){ts.getChoice(1).getElement("day"+i).getElement("background").setFrame(1);for(var s=4;s<i;s++)ts.getChoice(1).getElement("day"+s).getElement("background").setFrame(2).setDepth(1),ts.getChoice(1).getElement("day"+s).getElement("text").setTint(2960685).setDepth(1);for(s=1;s<=3;s++)ts.getChoice(0).getElement("day"+s).getElement("background").setFrame(2).setDepth(1),ts.getChoice(0).getElement("day"+s).getElement("text").setTint(2960685).setDepth(1)}else{ts.getChoice(0).getElement("day"+i).getElement("background").setFrame(1);for(s=1;s<i;s++)ts.getChoice(0).getElement("day"+s).getElement("background").setFrame(2).setDepth(1),ts.getChoice(0).getElement("day"+s).getElement("text").setTint(2960685).setDepth(1)}else if(i>3){for(s=4;s<=i;s++)ts.getChoice(1).getElement("day"+s).getElement("background").setFrame(2).setDepth(1),ts.getChoice(1).getElement("day"+s).getElement("text").setTint(2960685).setDepth(1);for(s=1;s<=3;s++)ts.getChoice(0).getElement("day"+s).getElement("background").setFrame(2).setDepth(1),ts.getChoice(0).getElement("day"+s).getElement("text").setTint(2960685).setDepth(1)}else for(s=1;s<=i;s++)ts.getChoice(0).getElement("day"+s).getElement("background").setFrame(2).setDepth(1),ts.getChoice(0).getElement("day"+s).getElement("text").setTint(2960685).setDepth(1);return ts}}var ns,rs,as,os=function(t){return t.rexUI.add.sizer({orientation:0,space:{left:0,right:-14,top:0,bottom:0,item:0}}).add(hs(t,"btn_close"),0,"center",{top:-10},!1,"btn_close")},hs=function(t,e){var i=t.add.sprite(0,0,e,0).setInteractive().on("pointerdown",(function(){null==t.smallCover&&vi(t,i)}));return i},ls=function(t,e,i){let s,n;1==i?(s=70,n=0):(s=10,n=-70);for(var r=t.rexUI.add.sizer({width:105,height:140,orientation:0,space:{left:s,right:s,top:45,bottom:45,item:5}}),a=Pe(),o=i+e-1,h=i-1;h<o;h++){var l;switch(a[h].type){case"obj_coin":l=0;break;case"obj_seed":case"obj_tool":l=a[h].id}r.add(ds(t,a[h].type,l,a[h].num,h),1,"center",{top:n},!1,"day"+(h+1))}return r},ds=function(t,e,i,s,n){var r=t.rexUI.add.label({width:105,height:140,orientation:1,background:t.add.sprite(0,0,"obj_signInBack",0),text:t.add.bitmapText(0,0,"farmText_White","第"+["一","二","三","四","五","六","七"][n]+"天",16),action:t.add.sprite(0,0,e,i).setScale(.8),space:{top:10,text:15}}).setInteractive().on("pointerdown",(function(){if(null==t.smallCover&&1==r.getElement("background").frame.name){!function(t){var e,i=[];switch(i.push(Pe()[Ee()]),function(t){g=t}(!1),function(t,e){1==e?m+=t:m=t}(1,!0),i[0].type){case"obj_coin":e=0;break;case"obj_seed":case"obj_tool":e=i[0].id}t.smallCover=t.add.sprite(ts.x+1,ts.y-5,"smallCover"),(new Qi).create(t,i[0].type,e,i[0].num)}(t),r.getElement("background").setFrame(2).setDepth(1),r.getElement("text").setTint(2960685).setDepth(1),Ti(t,r.getElement("action"),s)}}),t);return r};var cs=["友好","親近","知己","知己"];class us{create(t){ns=t.rexUI.add.dialog({x:game.config.width/2,y:game.config.height/2-10,width:500,height:565,background:t.add.sprite(0,0,"bg_table"),title:gs(t),description:t.rexUI.add.tabs({x:game.config.width/2,y:game.config.height/2,scrollMode:0,panel:t.rexUI.add.gridTable({background:t.add.sprite(0,0,"bg_rect"),scrollMode:0,table:{width:460,height:380,cellHeight:85,columns:1},createCellContainerCallback:function(t,e){var i=t.scene,s=t.width,n=t.item;t.index;null===e&&(e=fs(i)),e.setMinSize(s,80),e.getElement("script").getElement("id").setText(n.id);var r,a,o=e.getElement("script").getElement("id").text,h=xs(o);switch(as){case"label_manage":n.achievList=ai()[h],n.starFrame=be()[h],n.achievNumLV=oi()[h],n.achievGiftLV=hi()[h],n.memberAchiev=fe()[h],n.isReceived=xe()[h];break;case"label_book":n.achievList=di()[h],n.starFrame=ke()[h],n.achievNumLV=ci()[h],n.achievGiftLV=ui()[h],n.memberAchiev=ye()[h],n.isReceived=Ce()[h];break;case"label_grow":n.achievList=gi()[h],n.starFrame=Te()[h],n.achievNumLV=mi()[h],n.achievGiftLV=fi()[h],n.memberAchiev=_e()[h],n.isReceived=Oe()[h]}switch("label_book"==as?r=n.achievList+cs[n.starFrame]:(n.memberAchiev>n.achievNumLV&&(n.memberAchiev=n.achievNumLV),r=n.achievList+"("+n.memberAchiev+"/"+n.achievNumLV+")"),n.achievGiftLV.type){case"obj_coin":a=0;break;case"obj_seed":case"obj_tool":a=n.achievGiftLV.id}return e.getElement("star").setFrame(n.starFrame),e.getElement("awardSizer").getElement("prize").setTexture(n.achievGiftLV.type).setFrame(a),e.getElement("awardSizer").getElement("num").setText(n.achievGiftLV.num),e.getElement("script").getElement("achievScript").setText(r),n.starFrame>=3?e.getElement("btn_receive").setFrame(2):n.memberAchiev>=n.achievNumLV?e.getElement("btn_receive").setFrame(1):e.getElement("btn_receive").setFrame(0),e},space:{left:10,right:10,top:5,bottom:5}}),topButtons:[ws(t)],space:{left:10,right:10}}).layout(),expand:{title:!1,content:!1,description:!1},align:{title:"center",description:"center"}}).layout();var e=ys(15,"label_manage");return rs="label_manage",ns.getElement("description").getTopButton(0).getElement(rs).getElement("background").setFrame(0),ns.getElement("description").getElement("panel").setItems(e).scrollToTop(),ns.getElement("description").getElement("panel").on("cell.click",(function(e,i){var s=e.getElement("btn_receive");if(t.rexUI.isInTouching(s)){if(null!=t.smallCover)return;if(1==s.frame.name){vi(t,s).on("complete",(function(t,e){s.setFrame(2)}));var n=e.getElement("script").getElement("id").text,r=xs(n);if(null==r)return;switch(as){case"label_manage":Cs(e),ai()[r],fe()[r],oi(),hi();break;case"label_book":Cs(e),di()[r],ye()[r],ci(),ui();break;case"label_grow":Cs(e),gi()[r],_e()[r],mi(),fi()}Si(t,e.getElement("awardSizer").getElement("prize"),e.getElement("awardSizer").getElement("num").text)}}}),t),xi(t,ns),ns}}var ps,gs=function(t){var e=t.add.sprite(0,0,"title_achievement");return t.rexUI.add.sizer({orientation:0,space:{left:0,right:0,top:0,bottom:0,item:0}}).add(e,0,"center",{left:30,right:-15},!1,"title").add(ms(t,"btn_close"),0,"top",{top:-10},!1,"btn_close")},ms=function(t,e){var i=t.add.sprite(0,0,e,0).setInteractive().on("pointerdown",(function(){null==t.smallCover&&vi(t,i)}));return i},fs=function(t){var e=t.add.sprite(0,0,"bg_achievementRect"),i=t.add.sprite(0,0,"obj_star",0),s=t.add.sprite(0,0,"btn_receive",0);return t.rexUI.add.sizer({orientation:0}).addBackground(e).add(vs(t),0,"center",{left:5},!1,"awardSizer").add(i,0,"center",{left:20,top:-35},!1,"star").add(bs(t),1,"center",{left:10,top:0},!1,"script").add(s,0,"center",{right:10},!1,"btn_receive")},vs=function(t){var e=t.add.sprite(0,0,"obj_seed",0).setScale(.45),i=t.add.bitmapText(0,0,"farmText_Black","50",14).setOrigin(.5);return t.rexUI.add.sizer({orientation:1}).add(e,0,"center",{left:0},!1,"prize").add(i,1,"center",{left:0,top:-5},!1,"num")},bs=function(t){var e=t.add.bitmapText(0,0,"farmText_Black","",20),i=t.add.bitmapText(0,0,"farmText_Black","",18);return t.rexUI.add.sizer({orientation:1}).add(e,0,"left",{left:0},!1,"id").add(i,0,"left",{left:-65,top:10},!1,"achievScript")},xs=function(t){var e;switch(as){case"label_manage":e=ri();break;case"label_book":e=li();break;case"label_grow":e=pi()}for(var i=0;i<e.length;i++)if(e[i]==t)return i},ys=function(t,e){let i,s,n,r,a,o,h;switch(as=e,e){case"label_manage":i=be(),s=ri(),n=ai(),r=oi(),a=hi(),o=fe(),h=xe();break;case"label_book":i=ke(),s=li(),n=di(),r=ci(),a=ui(),o=ye(),h=Ce();break;case"label_grow":i=Te(),s=pi(),n=gi(),r=mi(),a=fi(),o=_e(),h=Oe()}for(var l=[],d=0;d<t;d++)l.push({starFrame:i[d],id:s[d],achievList:n[d],achievNumLV:r[d],achievGiftLV:a[d],memberAchiev:o[d],isReceived:h[d]});var c=[],u=[],p=[];for(d=0;d<t;d++)l[d].starFrame>=3?p.push(l[d]):o[d]>=r[d]?c.push(l[d]):u.push(l[d]);return c.concat(u).concat(p)},ws=function(t){return t.rexUI.add.sizer({orientation:0,space:{left:10,right:0,top:0,bottom:0,item:0}}).add(ks(t,"label_manage",15),0,"bottom",{left:0},!1,"label_manage").add(ks(t,"label_book",20),0,"bottom",{left:0},!1,"label_book").add(ks(t,"label_grow",10),0,"bottom",{left:0},!1,"label_grow")},ks=function(t,e,i){var s=t.rexUI.add.label({width:80,height:35,orientation:0,background:t.add.sprite(0,0,e,1),align:"center"});return s.setInteractive().on("pointerdown",(function(){if(null==t.smallCover){s.getElement("background").setFrame(0);var n=ys(i,e);ns.getElement("description").getElement("panel").setItems(n).scrollToTop(),rs!=e&&ns.getElement("description").getTopButton(0).getElement(rs).getElement("background").setFrame(1),rs=e}})),s};function Cs(t){var e,i,s,n,r,a,o,h,l,d=t.getElement("script").getElement("id").text,c=xs(d);switch(as){case"label_manage":"plant",function(t,e){Y[t]=e}(c,3),e=!0,A[c]=e;break;case"label_book":"partner",function(t,e){V[t]=e}(c,3),function(t,e){N[t]=e}(c,!0);break;case"label_grow":"other",function(t,e){X[t]=e}(c,3),function(t,e){J[t]=e}(c,!0)}switch(as){case"label_manage":i=hi()[c],s=be()[c],n=ai()[c],r=oi()[c],a=fe()[c],o=oi()[c],xe()[c];break;case"label_book":i=ui()[c],s=ke()[c],n=di()[c],r=ci()[c],a=ye()[c],o=ci()[c],Ce()[c];break;case"label_grow":i=fi()[c],s=Te()[c],n=gi()[c],r=mi()[c],a=_e()[c],o=mi()[c],Oe()[c]}switch("label_book"==as?h=n+cs[s]:(a>r&&(a=r),h=n+"("+a+"/"+o+")"),i.type){case"obj_coin":l=0;break;case"obj_seed":case"obj_tool":l=i.id}t.getElement("star").setFrame(s),t.getElement("awardSizer").getElement("prize").setTexture(i.type).setFrame(l),t.getElement("awardSizer").getElement("num").setText(i.num),t.getElement("script").getElement("achievScript").setText(h),3==t.getElement("star").frame.name?t.getElement("btn_receive").setFrame(2):a>=o?t.getElement("btn_receive").setFrame(1):t.getElement("btn_receive").setFrame(0)}class _s{create(t,e,i){t.load.spritesheet([{key:"obj_bigN",url:"/games/farm/assets/obj_bigN.png",frameConfig:{frameWidth:500,frameHeight:565}},{key:"obj_bigSR",url:"/games/farm/assets/obj_bigSR.png",frameConfig:{frameWidth:500,frameHeight:565}},{key:"obj_bigSSR",url:"/games/farm/assets/obj_bigSSR.png",frameConfig:{frameWidth:500,frameHeight:565}}]),t.load.once("complete",(function(){t.smallBoard=Es(t,e,i)}),t),t.load.start()}}var Ss,Ts,Os,Es=function(t,e,i){var s;switch(i){case"label_N":s="obj_bigN";break;case"label_SR":s="obj_bigSR";break;case"label_SSR":s="obj_bigSSR"}return ps=t.rexUI.add.dialog({x:game.config.width/2,y:game.config.height/2-10,width:500,height:565,background:t.add.sprite(0,0,s,e)}).layout().setDepth(1),t.rexUI.add.click(ps,{threshold:10}).on("click",(function(){Ci(t),_i(t)})),ps};class Ps{create(t){Ss=t.rexUI.add.dialog({x:game.config.width/2,y:game.config.height/2-10,width:500,height:565,background:t.add.sprite(0,0,"bg_table"),title:Is(t),description:t.rexUI.add.tabs({x:game.config.width/2,y:game.config.height/2,scrollMode:0,panel:t.rexUI.add.gridTable({background:t.add.sprite(0,0,"bg_rect"),scrollMode:0,table:{width:460,height:370,cellWidth:155,cellHeight:190,columns:3},createCellContainerCallback:function(t,e){var i=t.scene,s=t.item,n=t.index;switch(null===e&&(e=js(i)),e.setMinSize(150,175),e.getElement("background").setFrame(s.bgFrame),"obj_bookLock"==s.key?e.getElement("pic").setTexture(s.key):e.getElement("pic").setTexture(s.key,s.frame),s.key){case"obj_N":s.memberBook=Me()[n],s.owned=Ne()[n],s.lockMask=Be()[n],s.intimacy=ze()[n];break;case"obj_SR":s.memberBook=De()[n],s.owned=Ge()[n],s.lockMask=Re()[n],s.intimacy=Fe()[n];break;case"obj_SSR":s.memberBook=We()[n],s.owned=Xe()[n],s.lockMask=Ae()[n],s.intimacy=Ve()[n]}return 0==s.owned?(e.getElement("lockMask").setFrame(0),e.getElement("lockMask").setVisible(!0)):1==s.lockMask?Ls(i,e.getElement("lockMask")):e.getElement("lockMask").setFrame(2),e.getElement("obj_heart").setFrame(s.intimacy),e.getElement("collectNum").setText(s.memberBook),3!=s.intimacy&&1!=e.getElement("lockMask").frame.name||e.getElement("collectNum").setText("MAX").setFontSize(12),e},space:{left:10,right:10,top:10,bottom:10}}),topButtons:[Ds(t,"label_N",10),Ds(t,"label_SR",10),Ds(t,"label_SSR",10)]}).layout(),expand:{title:!1,content:!1,description:!1},align:{title:"center",description:"center"}}).layout();var e=zs(10,"label_N");return Ts=Ss.getElement("description").getTopButton(0),Ss.getElement("description").getTopButton(0).getElement("background").setFrame(0),Ss.getElement("description").getElement("panel").setItems(e).scrollToTop(),Ss.getElement("description").getElement("panel").on("cell.click",(function(e,i){if(null==t.smallCover){var s=e.getElement("lockMask");if(1!=s.frame.name)2==s.frame.name&&(t.smallCover=t.add.sprite(Ss.x+1,Ss.y-5,"smallCover"),(new _s).create(t,e.getElement("pic").frame.name,Os));else{Oi(t,"unlockBookSE"),s.setFrame(2);var n={status_value:1,lockMask:!1,lock_status:3,next_status_value:1};switch(e.getElement("pic").texture.key){case"obj_N":case"obj_SR":case"obj_SSR":Rs(e,n)}}}}),t),xi(t,Ss),Ss}}var Ms,Is=function(t){var e=t.add.sprite(0,0,"title_book");return t.rexUI.add.sizer({orientation:0,space:{left:0,right:0,top:0,bottom:0,item:0},name:"book"}).add(Bs(t,"btn_QA"),0,"center",{left:5,right:-40},!1,"btn_QA").add(e,0,"center",{left:30,right:-15},!1,"title").add(Bs(t,"btn_close"),0,"top",{top:-10},!1,"btn_close")},Bs=function(t,e){var i=t.add.sprite(0,0,e,0).setInteractive().on("pointerdown",(function(){null==t.smallCover&&(i.disableInteractive(),vi(t,i))}));return i},js=function(t){var e=t.add.sprite(0,0,"bg_bookRect"),i=t.add.sprite(0,0,"obj_heart",0),s=t.add.bitmapText(0,0,"farmText_White","",14).setOrigin(.5),n=t.add.sprite(0,0,"obj_N",0),r=t.add.sprite(0,0,"bg_locked",0);return t.rexUI.add.sizer({width:150,height:175,orientation:1}).addBackground(e,"background").add(i,0,"center",{left:-110,top:10},!1,"obj_heart").add(s,0,"center",{right:-106,top:-18},!1,"collectNum").add(n,0,"center",{left:-1,top:-11},!1,"pic").add(r,0,"center",{top:-153},!1,"lockMask")},zs=function(t,e){let i,s,n,r,a,o;switch(Os=e,e){case"label_N":i=0,s="obj_N",n=Me(),r=Ne(),a=Be(),o=ze();break;case"label_SR":i=1,s="obj_SR",n=De(),r=Ge(),a=Re(),o=Fe();break;case"label_SSR":i=2,s="obj_SSR",n=We(),r=Xe(),a=Ae(),o=Ve()}for(var h,l=[],d=0;d<t;d++)h=0==n[d]&&0==r[d]?"obj_bookLock":s,l.push({bgFrame:i,key:h,memberBook:n[d],frame:d,owned:r[d],lockMask:a[d],intimacy:o[d]});return l},Ds=function(t,e,i){var s=t.rexUI.add.label({width:80,height:35,orientation:0,background:t.add.sprite(0,0,e,1),align:"center"});return s.setInteractive().on("pointerdown",(function(){if(null==t.smallCover){s.getElement("background").setFrame(0);var n=zs(i,e);Ss.getElement("description").getElement("panel").setItems(n).scrollToTop(),Os=e,Ts!=s&&Ts.getElement("background").setFrame(1),Ts=s}})),s},Ls=function(t,e){e.setFrame(1),t.tweens.addCounter({from:255,to:100,yoyo:!0,repeat:-1,duration:700,onUpdate:function(t){const i=Math.floor(t.getValue());e.setTint(Phaser.Display.Color.GetColor(i,i,i))}})};function Rs(t,e){var i,s=t.getElement("pic").texture.key,n=t.getElement("pic").frame.name,r=e.status_value,a=e.lock_mask,o=e.lock_status,h=e.next_status_value;switch(s){case"obj_N":Ie(n,r,!1),je(n,a),function(t,e){var i;switch(L[t]=e,t){case 0:i=0;break;case 3:i=1;break;case 6:i=2;break;case 7:i=3;break;case 9:i=4;break;case 2:i=15}null!=i&&we(i,L[t])}(n,o),i=h,j[n]=i;break;case"obj_SR":Le(n,r,!1),Ue(n,a),function(t,e){var i;switch(R[t]=e,t){case 3:i=5;break;case 4:i=6;break;case 7:i=7;break;case 8:i=8;break;case 9:i=9;break;case 2:i=12;break;case 6:i=18;break;case 1:i=19}null!=i&&we(i,R[t])}(n,o),function(t,e){z[t]=e}(n,h);break;case"obj_SSR":Ye(n,r,!1),He(n,a),function(t,e){var i;switch(U[t]=e,t){case 2:i=10;break;case 4:i=11;break;case 7:i=13;break;case 8:i=14;break;case 5:i=16;break;case 0:i=17}null!=i&&we(i,U[t])}(n,o),function(t,e){D[t]=e}(n,h)}t.getElement("obj_heart").setFrame(o),t.getElement("collectNum").setText(r),3==o&&t.getElement("collectNum").setText("MAX").setFontSize(12)}class Us{create(t,e,i,s){for(var n,r=qt(),a=Qt(),o=t.rexUI.add.roundRectangle(0,0,0,0,20,7167060).setStrokeStyle(4,4141095),h={},l=!0,d=0,c="0123456789✔⬅".length;d<c;d++)h[n="0123456789✔⬅"[d]]=Ws(t,n);return Ms=t.rexUI.add.gridButtons({x:e.getElement("content").getElement("num").x,y:e.getElement("content").getElement("num").y-110,width:200,height:160,background:o,buttons:[[h[1],h[2],h[3],h["⬅"]],[h[4],h[5],h[6],h[0]],[h[7],h[8],h[9],h["✔"]]],space:{left:10,right:10,top:15,bottom:15,row:10,column:10}}).layout().setDepth(1),t.rexUI.add.click(Ms,{clickInterval:100}).on("click",(function(){for(var n,o=0,h=e.getElement("content").getElement("num").getElement("text").text,d=0;d<Ms.getElement("buttons").length;d++)t.rexUI.isInTouching(Ms.getButton(d))&&(vi(t,Ms.getButton(d)),n=Ms.getButton(d).text);if(null!=n)if("✔"===n)t.newPad=void 0,Ms.scaleDownDestroy(100);else{"⬅"===n?h.length>1?o=h.substring(0,h.length-1):(o=1,l=!0):(1==l&&"0"!=n?(o=n,l=!1):o=h+n,parseInt(o)>=i&&(o=i));var c=s*o;e.getElement("content").getElement("num").getElement("text").setText(o),e.getElement("description").getElement("text").setText(c),"buying"==e.name&&(c>r?(e.getElement("description").getElement("text").setFont("farmText_White"),e.getElement("description").getElement("text").setTint(16711680)):e.getElement("description").getElement("text").setFont("farmText_Black")),"changing"==e.name&&(o>a?(e.getElement("content").getElement("num").getElement("text").setFont("farmText_White"),e.getElement("content").getElement("num").getElement("text").setTint(16711680)):e.getElement("content").getElement("num").getElement("text").setFont("farmText_Black"))}})),Ms}}var Fs,Ws=function(t,e){return t.rexUI.add.label({background:t.rexUI.add.roundRectangle(0,0,0,0,10,9009781),text:t.add.text(0,0,e,{fontSize:"20px"}),align:"center"})};class Ys{create(t,e,i){t.load.image([{key:"bg_goodsBoard",url:"/games/farm/assets/bg_goodsBoard.png"}]),t.load.once("complete",(function(){t.smallBoard=Vs(t,e,i)}),t),t.load.start()}}var As,Hs,Vs=function(t,e,i){var s,n=e.getElement("pic").texture.key,r=e.getElement("pic").frame.name,a=e.getElement("name").text,o=e.getElement("num").text;return("label_crop"==i||"label_tool"==i)&&(s=e.getElement("name").getElement("action").text),(Fs=t.rexUI.add.dialog({x:game.config.width/2,y:game.config.height/2,width:400,height:365,background:t.add.image(0,0,"bg_goodsBoard"),title:Ns(t,n,r,a),content:Gs(t,o,s),description:Zs(t,o*s),actions:[t.add.sprite(0,0,"btn_no",0),t.add.sprite(0,0,"btn_yes",0)],space:{left:0,right:0,top:20,bottom:0,title:50,content:15,description:10,action:70},expand:{title:!1,content:!1,actions:!1},name:"selling"}).layout()).getElement("content").getElement("num").getElement("text").setOrigin(.5,0),Fs.getElement("description").getElement("text").setOrigin(.2,0),t.rexUI.add.click(Fs,{clickInterval:100}).on("click",(function(){var e;t.rexUI.isInTouching(Fs.getElement("content").getElement("num"))?null==t.newPad&&(t.newPad=(new Us).create(t,Fs,o,s)):t.rexUI.isInTouching(Fs.getAction(0))?e=Fs.getAction(0):t.rexUI.isInTouching(Fs.getAction(1))?e=Fs.getAction(1):(Js(t),t.rexUI.isInTouching(Fs.getElement("content").getElement("btn_less"))?(e=Fs.getElement("content").getElement("btn_less"),Xs("btn_less",o,s)):t.rexUI.isInTouching(Fs.getElement("content").getElement("btn_add"))&&(e=Fs.getElement("content").getElement("btn_add"),Xs("btn_add",o,s))),null!=e&&vi(t,e).on("complete",(function(e,s){if(Js(t),"btn_yes"==s[0].texture.key){Oi(t,"coinSE");var n=parseInt(Fs.getElement("description").getElement("text").text);t.events.emit("calculate",{coinInc:n,O2pointInc:0}),ge(6,n,!0),Se(3,n,!0);var r=Fs.getElement("title").getElement("background").frame.name,a=-parseInt(Fs.getElement("content").getElement("num").getElement("text").text);"label_crop"==i?ue(r,a,!0):"label_tool"==i&&he(r,a,!0),Ci(t),_i(t),vn(),bn()}}),t)})),Fs},Ns=function(t,e,i,s){return t.rexUI.add.label({width:150,height:125,orientation:1,background:t.add.sprite(0,0,e,i),text:t.add.bitmapText(0,0,"farmText_Black",s,22),align:"bottom",space:{left:0,right:0,top:0,bottom:-40}})},Gs=function(t,e,i){var s=t.add.sprite(0,0,"btn_less",0),n=t.add.sprite(0,0,"btn_add",0);return t.rexUI.add.sizer({width:220,height:35,orientation:0,space:{left:5,right:0,top:0,bottom:0}}).add(s,0,"center",{left:0},!1,"btn_less").add(Ks(t,e,i),0,"center",{left:0},!1,"num").add(n,0,"center",{left:0},!1,"btn_add")},Xs=function(t,e,i){var s,n=parseInt(Fs.getElement("content").getElement("num").getElement("text").text);switch(t){case"btn_less":if(n<=1)return;s=n-1;break;case"btn_add":if(n>=e)return;s=n+1}var r=i*s;Fs.getElement("content").getElement("num").getElement("text").setText(s),Fs.getElement("description").getElement("text").setText(r)},Js=function(t){null!=t.newPad&&(t.newPad.scaleDownDestroy(100),t.newPad=void 0)},Ks=function(t,e){return t.rexUI.add.label({width:140,height:35,orientation:0,text:t.add.bitmapText(0,0,"farmText_Black",e,22),space:{left:70}})},Zs=function(t,e){return t.rexUI.add.label({width:220,height:35,orientation:0,icon:t.add.sprite(0,0,"obj_coin",0).setScale(.3),text:t.add.bitmapText(0,0,"farmText_Black",e,22),space:{left:130,right:0,top:0,bottom:0,icon:35}})};class qs{create(t,e,i,s){t.load.image([{key:"bg_expandBoard",url:"/games/farm/assets/bg_expandBoard.png"}]),t.load.once("complete",(function(){t.smallBoard=sn(t,e,i,s)}),t),t.load.start()}}var $s,Qs,tn,en,sn=function(t,e,i,s){Hs=e;var n=10,r=ae(),a=qt(),o=Qt(),h=s[0],l="farmText_Black";return r<10&&(n=50),(0==i&&h>a||1==i&&h>o)&&(l="farmText_White"),As=t.rexUI.add.dialog({x:game.config.width/2,y:game.config.height/2,width:400,height:365,background:t.add.image(0,0,"bg_expandBoard"),toolbar:[nn(t,r),nn(t,r+1)],content:rn(t,i,h,l),actions:[t.add.sprite(0,0,"btn_no",0),t.add.sprite(0,0,"btn_yes",0)],space:{left:0,right:0,top:110,bottom:0,title:40,content:35,contentLeft:60,toolbarItem:n,action:70},expand:{title:!1,content:!1,action:!1}}).layout(),t.rexUI.add.click(As,{clickInterval:100}).on("click",(function(){var e;t.rexUI.isInTouching(As.getAction(0))?e=As.getAction(0):t.rexUI.isInTouching(As.getAction(1))&&(e=As.getAction(1)),null!=e&&vi(t,e,!1).on("complete",(function(e,s){if("btn_yes"==s[0].texture.key)if(0==i){if("farmText_White"==As.getElement("content").getElement("text").font)return void bi(t,"貓鑽不足");an(t)}else if(1==i){if("farmText_White"==As.getElement("content").getElement("text").font)return void bi(t,"歐兔幣不足");an(t)}}),t)})),As},nn=function(t,e){return t.rexUI.add.label({height:70,text:t.add.bitmapText(0,0,"farmText_Black",e,40),space:{left:100,right:0,top:0,bottom:0}})},rn=function(t,e,i,s){return t.rexUI.add.label({width:180,height:35,orientation:0,icon:t.add.sprite(0,0,"obj_coin",e).setScale(.25),text:t.add.bitmapText(0,0,s,i,22).setTint(16711680),space:{left:10,right:0,top:0,bottom:0,icon:35}})};function an(t){var e=As.getElement("content").getElement("icon").frame.name,i=ae()+1;if(Hs.getAction(0).getElement("action").setText(i),f=i,0==e){lt.shift(),ht.shift();var s=-parseInt(As.getElement("content").getElement("text").text);t.events.emit("calculate",{coinInc:s,O2pointInc:0})}else{dt.shift();var n=-parseInt(As.getElement("content").getElement("text").text);t.events.emit("calculate",{coinInc:0,O2pointInc:n})}Ci(t),_i(t)}class on{create(t){vn(),$s=t.rexUI.add.dialog({x:game.config.width/2,y:game.config.height/2-10,width:500,height:565,background:t.add.sprite(0,0,"bg_warehouseTable"),title:ln(t),description:t.rexUI.add.tabs({x:game.config.width/2,y:game.config.height/2,scrollMode:0,panel:t.rexUI.add.gridTable({width:480,height:370,background:t.add.sprite(0,0,"bg_warehouseRect"),scrollMode:0,table:{width:460,height:350,cellWidth:155,cellHeight:190,columns:3},createCellContainerCallback:function(t,e){var i=t.scene,s=t.item;t.index;return null===e&&(e=cn(i)),e.setMinSize(150,175),e.getElement("name").getElement("text").setText(s.name),e.getElement("name").getElement("action").setText(s.price),e.getElement("pic").setTexture(s.key,s.frame),e.getElement("num").setText(s.num),e},space:{left:10,right:10,top:10,bottom:10}}),topButtons:[pn(t,"label_crop",15)],space:{left:10,right:10}}).layout(),actions:[gn(t,en,ae()),mn(t)],space:{description:20,actionsRight:15},expand:{title:!1,content:!1,description:!1},align:{title:"center",description:"center",actions:"right"}}).layout();var e=un(15,"label_crop");return Qs=$s.getElement("description").getTopButton(0),$s.getElement("description").getTopButton(0).getElement("background").setFrame(0),$s.getElement("description").getElement("panel").setItems(e).scrollToTop(),$s.getAction(0).getElement("icon").setOrigin(.5,0),$s.getElement("description").getElement("panel").on("cell.click",(function(e,i){null==this.smallCover&&(t.smallCover=t.add.sprite($s.x+1,$s.y-5,"smallCover"),(new Ys).create(t,e,tn))}),t),xi(t,$s),$s}}var hn,ln=function(t){var e=t.add.sprite(0,0,"title_warehouse");return t.rexUI.add.sizer({orientation:0,name:"warehouse"}).add(dn(t,"btn_QA"),0,"center",{left:5,right:-40},!1,"btn_QA").add(e,0,"center",{left:30,right:-15},!1,"title").add(dn(t,"btn_close"),0,"top",{top:-10},!1,"btn_close")},dn=function(t,e){var i=t.add.sprite(0,0,e,0).setInteractive().on("pointerdown",(function(){null==t.smallCover&&(i.disableInteractive(),vi(t,i))}));return i},cn=function(t){var e=t.rexUI.add.label({width:120,height:100,orientation:1,background:t.add.sprite(0,0,"bg_cropRect"),text:t.add.bitmapText(0,0,"farmText_Black","",12).setAlpha(0),action:t.add.bitmapText(0,0,"farmText_Black","88",12).setAlpha(0),align:"center"}),i=t.add.sprite(0,0,"obj_crop",0),s=t.add.bitmapText(0,0,"farmText_White","",18);return t.rexUI.add.sizer({orientation:1}).addBackground(e,0,"name").add(i,0,"center",{top:35},!1,"pic").add(s,0,"center",{top:17,left:65},!1,"num")},un=function(t,e){let i,s,n,r;switch(tn=e,e){case"label_crop":i="obj_crop",s=$e(),n=ce(),r=St;break;case"label_tool":i="obj_tool",s=Ze(),n=oe(),r=Ct}for(var a,o=[],h=0;h<t;h++)if(0!=n[h])if(n[h]>80){var l=n[h];a=n[h]/80;for(var d=0;d<a;d++)l=l%80!=0&&l>80?n[h]%80:80,o.push({key:i,name:s[h],num:l,price:r[h],frame:h})}else o.push({key:i,name:s[h],num:n[h],price:r[h],frame:h});return o},pn=function(t,e,i){var s=t.rexUI.add.label({width:80,height:35,orientation:0,background:t.add.sprite(0,0,e,1),align:"center"});return s.setInteractive().on("pointerdown",(function(){null==t.smallCover&&(s.getElement("background").setFrame(0),tn=e,bn(),Qs!=s&&Qs.getElement("background").setFrame(1),Qs=s)})),s},gn=function(t,e,i){return t.rexUI.add.label({width:70,icon:t.add.bitmapText(0,0,"farmText_White",e,22),text:t.add.bitmapText(0,0,"farmText_White","/",20),action:t.add.bitmapText(0,0,"farmText_White",i,22),space:{left:9,top:-4,icon:-6,text:4}})},mn=function(t){var e=t.add.sprite(0,0,"btn_add",0).setInteractive().on("pointerdown",(function(){null==t.smallCover&&vi(t,e).on("complete",(function(){var e=Jt(),i=lt,s=dt;e>=ht[0]&&i.length>0?(t.smallCover=t.add.sprite($s.x+1,$s.y-5,"smallCover"),(new qs).create(t,$s,0,i)):fn(t,i,s)}))}));return e},fn=function(t,e,i){i.length>0?(t.smallCover=t.add.sprite($s.x+1,$s.y-5,"smallCover"),(new qs).create(t,$s,1,i)):e.length>0?bi(t,"等級不足"):bi(t,"已達上限")};function vn(){en=0;for(var t=ce(),e=0;e<t.length;e++)0!=t[e]&&(t[e]>80?en+=Math.ceil(t[e]/80):en++)}function bn(){var t;"label_crop"==tn?t=$e().length:"label_tool"==tn&&(t=Ze().length);var e=un(t,tn);$s.getElement("description").getElement("panel").setItems(e).scrollToTop(),$s.getAction(0).getElement("icon").setText(en)}class xn{create(t,e){t.load.image([{key:"bg_goodsBoard",url:"/games/farm/assets/bg_goodsBoard.png"}]),t.load.once("complete",(function(){t.smallBoard=wn(t,e)}),t),t.load.start()}}var yn,wn=function(t,e){var i=qt(),s=e.getElement("pic").texture.key,n=e.getElement("pic").frame.name,r=e.getElement("name").text,a=e.getElement("costSizer").getElement("cost").text;return hn=t.rexUI.add.dialog({x:game.config.width/2,y:game.config.height/2,width:400,height:365,background:t.add.image(0,0,"bg_goodsBoard"),title:kn(t,s,n,r),content:Cn(t,a),description:On(t,a),actions:[t.add.sprite(0,0,"btn_no",0),t.add.sprite(0,0,"btn_yes",0)],space:{left:0,right:0,top:20,bottom:0,title:50,content:15,description:10,action:70},expand:{title:!1,content:!1,actions:!1},name:"buying"}).layout().setDepth(1),a>i&&(hn.getElement("description").getElement("text").setFont("farmText_White"),hn.getElement("description").getElement("text").setTint(16711680)),hn.getElement("content").getElement("num").getElement("text").setOrigin(.5,0),hn.getElement("description").getElement("text").setOrigin(.2,0),t.rexUI.add.click(hn,{clickInterval:100}).on("click",(function(){var e;t.rexUI.isInTouching(hn.getElement("content").getElement("num"))?null==t.newPad&&(t.newPad=(new Us).create(t,hn,999,a)):t.rexUI.isInTouching(hn.getAction(0))?e=hn.getAction(0):t.rexUI.isInTouching(hn.getAction(1))?e=hn.getAction(1):(Sn(t),t.rexUI.isInTouching(hn.getElement("content").getElement("btn_less"))?(e=hn.getElement("content").getElement("btn_less"),_n("btn_less",a,i)):t.rexUI.isInTouching(hn.getElement("content").getElement("btn_add"))&&(e=hn.getElement("content").getElement("btn_add"),_n("btn_add",a,i))),null!=e&&vi(t,e).on("complete",(function(e,i){if(Sn(t),"btn_yes"==i[0].texture.key)if("farmText_White"==hn.getElement("description").getElement("text").font)bi(t,"貓鑽不足");else{var s=hn.getElement("title").getElement("background"),n=-parseInt(hn.getElement("description").getElement("text").text),r=parseInt(hn.getElement("content").getElement("num").getElement("text").text);switch(Oi(t,"coinSE"),s.texture.key){case"obj_tool":ge(3,r,!0);break;case"obj_seed":ge(4,r,!0)}Ti(t,s,r),t.events.emit("calculate",{coinInc:n,O2pointInc:0}),Ci(t),_i(t)}}),t)})),hn},kn=function(t,e,i,s){return t.rexUI.add.label({width:150,height:125,orientation:1,background:t.add.sprite(0,0,e,i),text:t.add.bitmapText(0,0,"farmText_Black",s,22),align:"bottom",space:{left:0,right:0,top:0,bottom:-40}})},Cn=function(t,e){var i=t.add.sprite(0,0,"btn_less",0),s=t.add.sprite(0,0,"btn_add",0);return t.rexUI.add.sizer({width:220,height:35,orientation:0,space:{left:5,right:0,top:0,bottom:0}}).add(i,0,"center",{left:0},!1,"btn_less").add(Tn(t,e),0,"center",{left:0},!1,"num").add(s,0,"center",{left:0},!1,"btn_add")},_n=function(t,e,i){var s,n=parseInt(hn.getElement("content").getElement("num").getElement("text").text);switch(t){case"btn_less":if(n<=1)return;s=n-1;break;case"btn_add":s=n+1}var r=e*s;hn.getElement("content").getElement("num").getElement("text").setText(s),hn.getElement("description").getElement("text").setText(r),r>i?(hn.getElement("description").getElement("text").setFont("farmText_White"),hn.getElement("description").getElement("text").setTint(16711680)):hn.getElement("description").getElement("text").setFont("farmText_Black")},Sn=function(t){null!=t.newPad&&(t.newPad.setVisible(!1),t.newPad=void 0)},Tn=function(t){return t.rexUI.add.label({width:140,height:35,orientation:0,text:t.add.bitmapText(0,0,"farmText_Black","1",22),space:{left:70}})},On=function(t,e){return t.rexUI.add.label({width:220,height:35,orientation:0,icon:t.add.sprite(0,0,"obj_coin",0).setScale(.3),text:t.add.bitmapText(0,0,"farmText_Black",e,22),space:{left:130,right:0,top:0,bottom:0,icon:35}})};class En{create(t,e,i,s,n,r){t.load.image([{key:"bg_noticeBoard",url:"/games/farm/assets/bg_noticeBoard.png"}]),t.load.once("complete",(function(){1==i?t.smallBoard=this.getBoard(t,e,s):t.board=this.getBoard(t,e,s,n,r)}),this),t.load.start()}getBoard(t,e,i,s,n){Oi(t,"warningSE");var r,a,o,h,l,d=qt(),c=Qt();switch(e){case"newLand":r=s,a=i,o=!0,h="擴建土地",l="是否解鎖新土地？";break;case"speedUp":r=1,a=i,o=!0,h="加速作物",l="是否縮短生長時間？";break;case"goMemberBag":r=0,o=!1,h="兌換成功",l="是否前往會員背包查看？";break;case"goMemberStore":r=0,o=!1,h="前往儲值",l="是否前往官網儲值頁面？"}return yn=t.rexUI.add.dialog({x:game.config.width/2,y:game.config.height/2,width:400,height:365,background:t.add.image(0,0,"bg_noticeBoard"),title:t.add.bitmapText(0,0,"farmText_Black",h,28),content:t.add.bitmapText(0,0,"farmText_Black",l,24),description:Bn(t,r,a,o),actions:[t.add.sprite(0,0,"btn_no",0),t.add.sprite(0,0,"btn_yes",0)],space:{left:0,right:0,top:110,bottom:0,title:25,content:25,description:30,action:70},expand:{title:!1,content:!1,description:!1}}).layout().setDepth(1).on("button.click",(function(i,s,o,h,l){vi(t,i,!1).on("complete",(function(){if("goMemberStore"==e&&(wi(t),ki(t),t.events.emit("releaseDrag")),"btn_yes"==i.texture.key)switch(e){case"newLand":0==r?d>=parseInt(a)?jn(t):bi(t,"貓鑽不足"):c>=parseInt(a)?jn(t):bi(t,"歐兔幣不足");break;case"speedUp":c>=parseInt(a)?function(t,e){wi(t),ki(t);var i=yn.getElement("description").getElement("cost").text;ge(7,i,!0),te(-i,!0),t.updateMemberCoin(),t.events.emit("shortenGrowing",{landID:e}),t.events.emit("releaseDrag")}(t,n):bi(t,"歐兔幣不足");break;case"goMemberBag":t.events.emit("btn_close"),window.location.replace("/member/pocket");break;case"goMemberStore":window.location.replace("/buycoins")}else switch(e){case"speedUp":t.events.emit("cancelShortenGrowing")}}))}),this)}}var Pn,Mn,In,Bn=function(t,e,i,s){var n=qt(),r=Qt(),a="farmText_Black";0==e?i>n&&(a="farmText_White"):i>r&&(a="farmText_White");var o=t.add.sprite(0,0,"obj_coin",e).setScale(.3).setVisible(s),h=t.add.bitmapText(0,0,a,i,22).setVisible(s).setTint(16711680);return t.rexUI.add.sizer({orientation:0,space:{left:-10,right:0,top:0,bottom:0,item:20}}).add(o,0,"center",{left:0},!1,"coin").add(h,0,"center",{left:0},!1,"cost")};function jn(t){var e=yn.getElement("description").getElement("coin").frame.name,i=yn.getElement("description").getElement("cost").text;t.events.emit("openLand",{frame:e}),wi(t),ki(t),0==e?$t(-i,!0):te(-i,!0),t.updateMemberCoin(),t.events.emit("releaseDrag")}class zn{create(t,e,i){t.load.image([{key:"bg_noticeBoard",url:"/games/farm/assets/bg_noticeBoard.png"}]),t.load.spritesheet([{key:"obj_crop",url:"/games/farm/assets/obj_crop.png",frameConfig:{frameWidth:120,frameHeight:100}}]),t.load.once("complete",(function(){t.smallBoard=Un(t,e,i)}),t),t.load.start()}}var Dn,Ln,Rn,Un=function(t,e,i){Mn=i;var s=bt[e];return In=xt[e],Pn=t.rexUI.add.dialog({x:t.cameras.main.worldView.centerX,y:t.cameras.main.worldView.centerY,width:400,height:365,background:t.add.image(0,0,"bg_noticeBoard"),title:t.add.bitmapText(0,0,"farmText_Black","兌換獎品",28),content:Fn(t,In),description:t.add.bitmapText(0,0,"farmText_Black","是否換取？",24),actions:[t.add.sprite(0,0,"btn_no",0),t.add.sprite(0,0,"btn_yes",0)],space:{left:0,right:0,top:110,bottom:0,title:15,content:15,description:27,action:70},expand:{title:!1,content:!1,description:!1}}).layout().setDepth(1),t.rexUI.add.click(Pn,{clickInterval:100}).on("click",(function(){var e;t.rexUI.isInTouching(Pn.getAction(0))?e=Pn.getAction(0):t.rexUI.isInTouching(Pn.getAction(1))&&(e=Pn.getAction(1)),null!=e&&vi(t,e,!1).on("complete",(function(e,i){if("btn_yes"==i[0].texture.key){for(var n=Pn.getElement("content"),r=0;r<In.length;r++){if("farmText_White"==n.getElement("num"+r).font)return void bi(t,"作物不足");ue(n.getElement("goods"+r).frame.name,-parseInt(n.getElement("num"+r).text),!0)}SetSuccessExchangeGift(Wn,t),SetFailureExchangeGift(Yn,t),exchangeGift(s)}}),t)})),Pn},Fn=function(t,e){for(var i=ce(),s=t.add.bitmapText(0,0,"farmText_Black","需",22),n=t.rexUI.add.sizer({orientation:0,space:{left:-10}}).add(s),r=0;r<e.length;r++){var a=Ei(e[r].id),o=e[r].num,h=t.add.sprite(0,0,"obj_crop",a).setScale(.5),l=t.add.bitmapText(0,0,"farmText_Black",o,22);i[a]<o&&(l.setFont("farmText_White"),l.setTint(16711680)),n.add(h,0,"center",{left:0},!1,"goods"+r).add(l,0,"center",{left:-10},!1,"num"+r)}return n};function Wn(){if(Ci(this),0==ExchangeGiftResult.can_exchange&&Mn.getElement("lockMask").setFrame(1),3==ExchangeGiftResult.type){for(var t=ExchangeGiftResult.real_release_prizes,e=0;e<t.length;e++)switch(t[e].type){case"obj_coin":0,this.events.emit("calculate",{coinInc:t[e].num,O2pointInc:0});break;case"obj_seed":de(Ei(t[e].id),t[e].num,!0);break;case"obj_tool":he(Pi(t[e].id),t[e].num,!0)}_i(this)}else(new En).create(this,"goMemberBag",!0)}function Yn(){bi(this,"禮物數量不足");for(var t=Pn.getElement("content"),e=0;e<In.length;e++){ue(t.getElement("goods"+e).frame.name,parseInt(t.getElement("num"+e).text),!0)}Mn.getElement("lockMask").setFrame(1)}class An{create(t){Dn=t.rexUI.add.dialog({x:game.config.width/2,y:game.config.height/2-10,width:500,height:565,background:t.add.sprite(0,0,"bg_table"),title:Hn(t),description:t.rexUI.add.tabs({x:game.config.width/2,y:game.config.height/2,scrollMode:0,panel:t.rexUI.add.gridTable({background:t.add.sprite(0,0,"bg_rect"),scrollMode:0,table:{width:460,height:370,cellWidth:155,cellHeight:190,columns:3},createCellContainerCallback:function(t,e){var i=t.scene,s=t.item;t.index;if(null===e&&(e=Nn(i)),e.setMinSize(150,175),e.getElement("name").setText(s.name),"obj_gift"==s.type){e.getElement("pic").setTexture("giftImg"+s.frame),e.getElement("costSizer").getElement("coin").destroy();var n=parseInt(s.price/24).toString().padStart(2,"0"),r=parseInt(s.price%24).toString().padStart(2,"0");e.getElement("costSizer").getElement("cost").setText(n+"日"+r+"時")}else e.getElement("pic").setTexture(s.type,s.frame),e.getElement("costSizer").getElement("cost").setText(s.price);return s.isOpened?e.getElement("lockMask").setFrame(2):"obj_gift"==s.type?e.getElement("lockMask").setFrame(1):e.getElement("lockMask").setFrame(0),e},space:{left:10,right:10,top:10,bottom:10}}),topButtons:[Jn(t,"label_seed",15),Jn(t,"label_tool",5)],space:{left:10,right:10}}).layout(),expand:{title:!1,content:!1,description:!1},align:{title:"center",description:"center"}}).layout();var e=Xn(15,"label_seed");return Ln=Dn.getElement("description").getTopButton(0),Dn.getElement("description").getTopButton(0).getElement("background").setFrame(0),Dn.getElement("description").getElement("panel").setItems(e).scrollToTop(),Dn.getElement("description").getElement("panel").on("cell.down",(function(t,e){Zn()}),t).on("cell.click",(function(e,i){null==this.smallCover&&2==e.getElement("lockMask").frame.name&&(t.rexUI.isInTouching(e.getElement("pic"))?"label_seed"==Ln.getElement("background").texture.key&&Kn(t,e.getElement("pic")):t.rexUI.isInTouching(e.getElement("costSizer"))&&vi(t,e.getElement("costSizer")).on("complete",(function(i,s){if(t.smallCover=t.add.sprite(Dn.x+1,Dn.y-5,"smallCover"),"giftImg"==e.getElement("pic").texture.key.slice(0,7)){var n=e.getElement("pic").texture.key.slice(7);(new zn).create(t,n,e)}else(new xn).create(t,e)})))}),t),xi(t,Dn),Dn}}var Hn=function(t){var e=t.add.sprite(0,0,"title_shop");return t.rexUI.add.sizer({orientation:0,space:{left:0,right:0,top:0,bottom:0,item:0}}).add(e,0,"center",{left:30,right:-15},!1,"title").add(Vn(t,"btn_close"),0,"top",{top:-10},!1,"btn_close")},Vn=function(t,e){var i=t.add.sprite(0,0,e,0).setInteractive().on("pointerdown",(function(){null==t.smallCover&&vi(t,i).on("complete",(function(){Zn()}))}));return i},Nn=function(t){var e=t.add.sprite(0,0,"bg_shopRect"),i=t.add.text(0,0,"",{font:"14px ",fill:"#FFF",padding:{top:2}}),s=t.add.sprite(0,0,"",0),n=t.add.sprite(0,0,"bg_soldOut",0).setDepth(1);return t.rexUI.add.sizer({orientation:1}).addBackground(e).add(i,0,"center",{left:0,top:5},!1,"name").add(s,0,"center",{top:9},!1,"pic").add(Gn(t),0,"center",{left:0,top:7},!1,"costSizer").add(n,0,"center",{top:-167},!1,"lockMask")},Gn=function(t){var e=t.add.sprite(0,0,"bg_costRect"),i=t.add.sprite(0,0,"obj_coin",0).setScale(.21),s=t.add.bitmapText(0,0,"farmText_White","",16);return t.rexUI.add.sizer({width:110,height:30,orientation:0,space:{left:15,right:0,top:0,bottom:0,item:10}}).addBackground(e).add(i,0,"center",{left:-2,top:-2},!1,"coin").add(s,0,"center",{top:-2},!1,"cost")},Xn=function(t,e){var i=Jt();let s,n,r,a;switch(e){case"label_seed":s="obj_seed",n=$e(),r=_t,a=It;break;case"label_tool":s="obj_tool",n=Ze(),r=kt;break;case"label_timeLimit":s="obj_gift",n=vt,r=wt,a=yt}for(var o,h=[],l=0;l<t;l++)o=!("label_seed"==e&&i<a[l])&&!("label_timeLimit"==e&&a[l]<=0),h.push({type:s,name:n[l],price:r[l],frame:l,isOpened:o});var d=[],c=[];for(l=0;l<t;l++)1==h[l].isOpened?d.push(h[l]):c.push(h[l]);return d.concat(c)},Jn=function(t,e,i){var s=t.rexUI.add.label({width:80,height:35,orientation:0,background:t.add.sprite(0,0,e,1),align:"center"});return s.setInteractive().on("pointerdown",(function(){if(null==t.smallCover){if(Zn(),s.getElement("background").setFrame(0),"label_timeLimit"==e);else{var n=Xn(i,e);Dn.getElement("description").getElement("panel").setItems(n).scrollToTop()}Ln!=s&&Ln.getElement("background").setFrame(1),Ln=s}})),s},Kn=function(t,e){var i=e.frame.name,s=(Qe()[i]+ti()[i])/60,n=ei()[i]/60,r=parseInt(s/60).toString().padStart(2,"0"),a=parseInt(s%60).toString().padStart(2,"0"),o=parseInt(n/60).toString().padStart(2,"0"),h=parseInt(n%60).toString().padStart(2,"0"),l=t.rexUI.add.roundRectangle(0,0,2,2,10,16776952).setStrokeStyle(1,0),d=t.add.bitmapText(0,0,"farmText_Black","種植時間：\n"+r+"時"+a+"分",16),c=t.add.bitmapText(0,0,"farmText_Black","枯萎時間：\n"+o+"時"+h+"分",16);Rn=t.rexUI.add.sizer({x:e.x,y:e.y,orientation:1,space:{left:15,right:15,top:10,bottom:10,item:5},name:"test"}).setVisible(!0).setOrigin(0,0).addBackground(l).add(d,0,"left",{left:0},!1).add(c,0,"left",{left:0},!1).layout().setDepth(1)},Zn=function(){null!=Rn&&Rn.setVisible(!1)};class qn{create(t,e,i){var s=oe(),n=t.rexUI.add.scrollablePanel({x:e,y:i,width:560,height:110,scrollMode:1,background:t.add.image(0,0,"bg_toolMenu"),panel:{child:$n(t,s,["dig","water","fertilizer","fertilizer","fertilizer"])},space:{left:5,right:5}}).layout();t.input.topOnly=!1,t.tweens.add({targets:n,y:"-=110",ease:"Back.easeOut",duration:600,onStart:function(){t.events.emit("showMenu")}});var r=[];return r.push(...n.getElement("panel.items")),r.forEach((function(e){t.rexUI.add.click(e.getElement("obj_tool"),{threshold:10}).on("click",(function(){e.getElement("num").getElement("text").text;var i=e.getElement("obj_tool").frame.name;t.events.emit("btn_close"),t.events.emit("chooseWork",{work:e.name,key:"obj_tool",frame:i})}))})),n}}var $n=function(t,e,i){for(var s=t.rexUI.add.sizer({space:{bottom:10}}),n=0;n<e.length;n++){var r;r=e[n]>99?99:e[n],s.add(Qn(t,n,r,i[n]),0,"center",{left:0},!1,"toolPanel")}return s},Qn=function(t,e,i,s){var n=t.add.sprite(0,0,"obj_tool",e).setScale(.75),r=t.rexUI.add.label({width:23,background:t.rexUI.add.roundRectangle(0,0,0,0,10,12500670),text:t.add.bitmapText(0,0,"farmText_Black",i,14),align:"center",space:{left:3.5,right:3.5,top:4.5,bottom:4.5}});return t.rexUI.add.sizer({width:90,height:75,orientation:1,space:{left:0,right:0,top:0,bottom:0,item:-25},name:s}).add(n,0,"center",{left:0},!1,"obj_tool").add(r,0,"center",{left:85},!1,"num")};class tr{create(t,e,i){var s=le(),n=t.rexUI.add.scrollablePanel({x:e,y:i,width:560,height:110,scrollMode:1,background:t.add.image(0,0,"bg_cropMenu"),panel:{child:ir(t,s)},space:{left:5,right:5}}).layout();t.input.topOnly=!1,t.tweens.add({targets:n,y:"-=110",ease:"Back.easeOut",duration:600,onStart:function(){t.events.emit("showMenu")}});var r=[];return r.push(...n.getElement("panel.items")),r.forEach((function(e){t.rexUI.add.click(e.getElement("obj_seed"),{threshold:10}).on("click",(function(){var i=e.getElement("obj_seed").frame.name;t.events.emit("btn_close"),t.events.emit("chooseWork",{work:e.name,key:"obj_seed",frame:i})}))})),n}}var er,ir=function(t,e){for(var i=t.rexUI.add.sizer({space:{bottom:10}}),s=0;s<e.length;s++){var n;if(0!=e[s])n=e[s]>99?99:e[s],i.add(sr(t,s,n),0,"center",{left:0},!1,"cropPanel")}return i},sr=function(t,e,i){var s=t.add.sprite(0,0,"obj_seed",e).setScale(.75),n=t.rexUI.add.label({width:23,background:t.rexUI.add.roundRectangle(0,0,0,0,10,12500670),text:t.add.bitmapText(0,0,"farmText_Black",i,14),align:"center",space:{left:3.5,right:3.5,top:4.5,bottom:4.5}});return t.rexUI.add.sizer({width:90,height:75,orientation:1,space:{left:0,right:0,top:0,bottom:0,item:-25},name:"seed"}).add(s,0,"center",{left:0},!1,"obj_seed").add(n,0,"center",{left:85},!1,"num")};class nr{create(t,e,i){t.load.image([{key:"bg_smallBoard",url:"/games/farm/assets/bg_smallBoard.png"},{key:"obj_warehouse",url:"/games/farm/assets/obj_warehouse.png"},{key:"obj_new",url:"/games/farm/assets/obj_new.png"}]),t.load.spritesheet([{key:"title_levelUp",url:"/games/farm/assets/title_levelUp.png",frameConfig:{frameWidth:425,frameHeight:280}},{key:"obj_seed",url:"/games/farm/assets/obj_seed.png",frameConfig:{frameWidth:120,frameHeight:100}},{key:"obj_tool",url:"/games/farm/assets/obj_tool.png",frameConfig:{frameWidth:120,frameHeight:100}}]),t.load.once("complete",(function(){t.board=this.getBoard(t,e,i)}),this),t.load.start()}getBoard(t,e,i){return Oi(t,"giftBoardSE"),t.anims.create({key:"title_levelUp",frames:t.anims.generateFrameNumbers("title_levelUp",{start:0,end:3}),frameRate:6,repeat:-1}),er=t.rexUI.add.dialog({x:game.config.width/2,y:game.config.height/2,width:600,height:365,scrollMode:1,background:t.add.image(0,0,"bg_smallBoard"),title:t.add.sprite(0,0,"title_levelUp").anims.play("title_levelUp"),choices:[ar(t,e,"award"),ar(t,i,"unlock")],space:{left:10,right:10,top:-70,bottom:0,title:-65,choice:10},expand:{title:!1,choices:!1}}).layout().setDepth(1).popUp(300),t.rexUI.add.click(er,{threshold:10}).on("click",(function(){for(var e=0;e<er.getChoice(0).getElement("items").length;e++){var i=er.getChoice(0).getElement("award"+e);Ti(t,i.getElement("gift"),i.getElement("num").text)}wi(t),ki(t),t.events.emit("releaseDrag"),t.events.emit("levelUp_updateWood")})),er}}var rr,ar=function(t,e,i){var s=t.rexUI.add.sizer({width:90,height:90,orientation:0,space:{left:25,right:25,top:0,bottom:0,item:40}});if("award"==i)for(var n=0;n<e.length;n++)s.add(or(t,e[n]),0,"left",{left:0},!1,i+n);else if("unlock"==i)for(var r=0;r<e.length;r++)s.add(hr(t,e[r]),0,"left",{left:0},!1);return s},or=function(t,e){var i;switch(e.type){case"obj_coin":i=0;break;case"obj_seed":case"obj_tool":i=e.id}var s=t.add.sprite(0,0,e.type,i).setScale(.8),n=t.add.bitmapText(0,0,"farmText_Black","+"+e.num,20);return t.rexUI.add.sizer({orientation:0,space:{left:0,right:0,top:0,bottom:0,item:0}}).add(s,0,"center",{left:0},!1,"gift").add(n,0,"center",{left:0,top:50},!1,"num")},hr=function(t,e){var i,s;switch(e.type){case"land":i="land",s=0;break;case"warehouse":i="obj_warehouse",s=0;break;case"plant":i="obj_crop",s=e.id}var n=t.add.sprite(0,0,i,s),r=96/n.width;n.setScale(r);var a=t.add.sprite(0,0,"obj_new");return t.rexUI.add.sizer({orientation:0}).add(n,0,"center",{left:0},!1,"gift").add(a,0,"center",{left:-5,top:50},!1,"obj_new")};class lr{create(t){t.load.image([{key:"bg_coinExchangeBoard",url:"/games/farm/assets/bg_coinExchangeBoard.png"}]),t.load.once("complete",(function(){t.board=this.getBoard(t)}),this),t.load.start()}getBoard(t){var e=a,i=Qt();return rr=t.rexUI.add.dialog({x:game.config.width/2,y:game.config.height/2,width:400,height:365,background:t.add.image(0,0,"bg_coinExchangeBoard"),content:ur(t,e),description:fr(t,e),actions:[t.add.sprite(0,0,"btn_no",0),t.add.sprite(0,0,"btn_yes",0)],space:{left:0,right:0,top:185,bottom:0,title:20,content:20,description:10,contentLeft:100,descriptionLeft:110,action:70},expand:{title:!1,content:!1,action:!1},name:"changing"}).layout().setDepth(1),0==i&&(rr.getElement("content").getElement("num").getElement("text").setFont("farmText_White"),rr.getElement("content").getElement("num").getElement("text").setTint(16711680)),rr.getElement("content").getElement("num").getElement("text").setOrigin(.5,0),rr.getElement("description").getElement("text").setOrigin(.3,0),t.rexUI.add.click(rr,{clickInterval:100}).on("click",(function(){var s;t.rexUI.isInTouching(rr.getElement("content").getElement("num"))?null==t.newPad&&(t.newPad=(new Us).create(t,rr,9999,e)):t.rexUI.isInTouching(rr.getAction(0))?s=rr.getAction(0):t.rexUI.isInTouching(rr.getAction(1))?s=rr.getAction(1):(gr(t),t.rexUI.isInTouching(rr.getElement("content").getElement("btn_less"))?(s=rr.getElement("content").getElement("btn_less"),pr("btn_less",9999,e,i)):t.rexUI.isInTouching(rr.getElement("content").getElement("btn_add"))&&(s=rr.getElement("content").getElement("btn_add"),pr("btn_add",9999,e,i))),null!=s&&vi(t,s,!1).on("complete",(function(e,i){if(gr(t),"btn_yes"==i[0].texture.key){parseInt(rr.getElement("content").getElement("num").getElement("text").text);"farmText_White"==rr.getElement("content").getElement("num").getElement("text").font?bi(t,"歐兔幣不足"):(Oi(t,"coinSE"),function(t){var e=parseInt(rr.getElement("description").getElement("text").text),i=parseInt(rr.getElement("content").getElement("num").getElement("text").text);wi(t),ki(t),ge(7,i,!0),$t(e,!0),te(-i,!0),t.updateMemberCoin(),t.releaseUIbtn(),t.events.emit("releaseDrag")}(t))}}),t)})),rr}}var dr,cr,ur=function(t,e){var i=t.add.sprite(0,0,"btn_less",0),s=t.add.sprite(0,0,"btn_add",0);return t.rexUI.add.sizer({width:220,height:35,orientation:0,space:{left:5,right:0,top:0,bottom:0}}).add(i,0,"center",{left:0},!1,"btn_less").add(mr(t,e),0,"center",{left:0},!1,"num").add(s,0,"center",{left:0},!1,"btn_add")},pr=function(t,e,i,s){var n,r=parseInt(rr.getElement("content").getElement("num").getElement("text").text);switch(t){case"btn_less":if(r<=1)return;n=r-1;break;case"btn_add":if(r>=e)return;n=r+1}var a=i*n;rr.getElement("content").getElement("num").getElement("text").setText(n),rr.getElement("description").getElement("text").setText(a),n>s?(rr.getElement("content").getElement("num").getElement("text").setFont("farmText_White"),rr.getElement("content").getElement("num").getElement("text").setTint(16711680)):rr.getElement("content").getElement("num").getElement("text").setFont("farmText_Black")},gr=function(t){null!=t.newPad&&(t.newPad.scaleDownDestroy(100),t.newPad=void 0)},mr=function(t){return t.rexUI.add.label({width:140,height:35,orientation:0,text:t.add.bitmapText(0,0,"farmText_Black","1",22),space:{left:70}})},fr=function(t,e){return t.rexUI.add.label({width:220,height:35,orientation:0,text:t.add.bitmapText(0,0,"farmText_Black",e,22),space:{left:130,right:0,top:0,bottom:0}})};class vr{create(t){t.load.image([{key:"beginGift",url:"/games/farm/assets/beginGift.png"}]),t.load.spritesheet([{key:"btn_receive",url:"/games/farm/assets/btn_receive.png",frameConfig:{frameWidth:65,frameHeight:40}}]),t.load.once("complete",(function(){t.board=this.getBoard(t)}),this),t.load.start()}getBoard(t){return dr=t.rexUI.add.dialog({x:game.config.width/2,y:game.config.height/2-10,width:500,height:565,background:t.add.image(0,0,"beginGift"),actions:[t.add.sprite(0,0,"btn_receive",1).setScale(1.2)],space:{left:10,right:10,top:480,bottom:0},expand:{actions:!1}}).layout().setDepth(1),t.rexUI.add.click(dr,{clickInterval:100}).on("click",(function(){t.rexUI.isInTouching(dr.getAction(0))&&(vi(t,dr.getAction(0)),function(t,e){i=!1,h=i;var i;for(var s=0;s<t.length;s++)switch(t[s].type){case"obj_coin":$t(t[s].num,!0);break;case"obj_seed":de(Ei(t[s].id),t[s].num,!0);break;case"obj_tool":he(Pi(t[s].id),t[s].num,!0)}e.updateMemberCoin();for(s=0;s<e.UiButtons.length;s++)e.UiButtons[s].setInteractive();wi(e),ki(e),e.events.emit("releaseDrag")}(Pe(),t))})),dr}}class br{create(t,e,i){t.load.image([{key:"bg_teach",url:"/games/farm/assets/teach/bg_teach.png"},{key:"teach_land",url:"/games/farm/assets/teach/teach_land.png"},{key:"teach_ui",url:"/games/farm/assets/teach/teach_ui.png"},{key:"teach_book",url:"/games/farm/assets/teach/teach_book.png"},{key:"teach_warehouse",url:"/games/farm/assets/teach/teach_warehouse.png"},{key:"teach_shop",url:"/games/farm/assets/teach/teach_shop.png"},{key:"teach_button",url:"/games/farm/assets/teach/teach_button.png"}]),t.load.once("complete",(function(){1==i?t.smallBoard=this.getBoard(t,e,i):t.board=this.getBoard(t,e,i)}),this),t.load.start()}getBoard(t,e,i){var s=e,n=["teach_land","teach_ui","teach_book","teach_warehouse","teach_shop"];return(cr=t.rexUI.add.dialog({x:game.config.width/2,y:game.config.height/2-10,width:500,height:565,background:t.add.image(0,0,"bg_teach"),title:xr(t),content:t.add.image(0,0,n[e]),description:yr(t,n),actions:[t.add.sprite(0,0,"teach_button",0),t.add.sprite(0,0,"teach_button",0).setFlipX(!0)],space:{left:10,right:10,top:0,bottom:260,title:30,content:10,description:-300,descriptionLeft:150,actionsLeft:-350,actionsRight:-345,action:350},expand:{title:!1,content:!1,actions:!1},align:{title:"right"}}).layout().setDepth(1)).getElement("description").getElement("circle"+e).setFillStyle(4203023),t.rexUI.add.click(cr,{clickInterval:100}).on("click",(function(){var e,r=n.indexOf(cr.getElement("content").texture.key);t.rexUI.isInTouching(cr.getElement("title").getElement("btn_close"))?e=cr.getElement("title").getElement("btn_close"):t.rexUI.isInTouching(cr.getAction(0))?(e=cr.getAction(0),--r<0&&(r=n.length-1)):t.rexUI.isInTouching(cr.getAction(1))&&(e=cr.getAction(1),++r==n.length&&(r=0)),null!=e&&vi(t,e,!1).on("complete",(function(a,o){"btn_close"==e.texture.key?0==i?(wi(t),t.time.addEvent({delay:150,callback:function(){(new vr).create(t)},callbackScope:this})):(Ci(t),_i(t)):(cr.getElement("content").setTexture(n[r]),cr.getElement("description").getElement("circle"+r).setFillStyle(4203023),cr.getElement("description").getElement("circle"+s).setFillStyle(14866106),s=r)}),t)})),cr}}var xr=function(t){var e=t.add.sprite(0,0,"btn_close",0);return t.rexUI.add.sizer({orientation:0,space:{left:0,right:-10,top:-10,bottom:0,item:0}}).add(e,0,"center",{left:0},!1,"btn_close")},yr=function(t,e){for(var i=t.rexUI.add.sizer({orientation:0,space:{left:0,right:0,top:0,bottom:0,item:20}}),s=0;s<e.length;s++)i.add(t.rexUI.add.roundRectangle(0,0,5,5,10,14866106),0,"center",!1,{left:0},"circle"+s);return i};let wr=!1,kr=[],Cr=[],_r=[];class Sr extends Phaser.Scene{constructor(){super("UI")}init(){kr=["uibtn_task","uibtn_signIn","uibtn_achievement","uibtn_book","uibtn_warehouse","uibtn_shop","uibtn_crop","uibtn_tool"],_r=[Ri,ss,us,Ps,on,An,tr,qn]}create(){if(this.input.setTopOnly(!0),this.input.setGlobalTopOnly(!0),this.createInfo(),this.createButton(),1==h){yi(this),(new br).create(this,0,!1);for(var t=0;t<this.UiButtons.length;t++)this.UiButtons[t].disableInteractive();this.events.emit("lockDrag")}this.UiContainer=this.add.container(0,0),this.UiButtons.forEach((function(t){this.UiContainer.add(t)}),this),this.input.on("pointerdown",(function(t){null!=this.board&&"rexScrollablePanel"==this.board.type&&(this.rexUI.isInTouching(this.board)||(this.board=void 0,this.releaseUIbtn(),this.events.emit("hideAllBoard"),this.events.emit("releaseDrag")))}),this),this.sceneLoadObjects=this.scene.get("loadObjects"),this.sceneLoadObjects.events.on("showBoard",(function(t){yi(this),this.board=t.board,this.lockUIbtn(),this.events.emit("lockDrag")}),this),this.sceneLoadObjects.events.on("btn_close",(function(t){Oi(this,"btnCloseSE"),this.board=void 0,this.releaseUIbtn(),this.events.emit("hideAllBoard"),this.events.emit("releaseDrag")}),this),this.sceneLoadObjects.events.on("showMenu",this.addMask,this),this.sceneLoadObjects.events.on("calculate",(function(t){$t(t.coinInc,!0),te(t.O2pointInc,!0),ge(7,-t.O2pointInc,!0),this.updateMemberCoin()}),this),this.sceneLoadObjects.events.on("showTeach",(function(t){(new br).create(this.sceneLoadObjects,t.page,!0)}),this),this.sceneplay=this.scene.get("play"),this.sceneplay.events.on("dragBG",(function(t){wr=!0}),this),this.sceneplay.events.on("endDragBG",(function(t){wr=!1}),this),this.sceneplay.events.on("clickWood",(function(t){yi(this),this.board=t.type,(new En).create(this,t.type,!1,t.cost,t.coinFrame),this.events.emit("lockDrag")}),this),this.sceneplay.events.on("clickSpeedUp",(function(t){yi(this),this.board=t.type,(new En).create(this,t.type,!1,t.cost,0,t.id),this.events.emit("lockDrag")}),this),this.sceneplay.events.on("harvest",(function(t){Zt(t.expInc,!0);var e={level:rt[0],exp:at[0],prize_arr:ot[0]};1==t.isLevelUp?(this.board=t.type,function(t,e){i="shift","shift"==i&&rt.shift(),function(t){"shift"==t&&at.shift()}("shift"),function(t){"shift"==t&&ot.shift()}("shift");var i;var s=Kt(),n=Je(),r=Ke(),a=st,o=nt,h=s-r;p=n,d=p,Zt(h,!1),u=e.level,et=u,c=e.exp,it=c,l=e.prize_arr,st=l,yi(t),(new nr).create(t,a,o),t.events.emit("lockDrag"),t.updateMemberExp();var l;var c;var u;var p}(this,e)):this.updateMemberExp()}),this),this.time.addEvent({delay:500,callback:function(){this.checkUIStar()},callbackScope:this,loop:!0})}checkUIStar(){0==function(){for(var t=0;t<w.length;t++)if(w[t]>=jt[t]&&0==k[t])return!0;return!1}()?this.taskUI.star.setVisible(!1):this.taskUI.star.setVisible(!0),0!=g==0?this.signInUI.star.setVisible(!1):this.signInUI.star.setVisible(!0),0==function(){for(var t=[Ut,At,Gt],e=[W,H,G],i=[Y,V,X],s=[A,N,J],n=0;n<t.length;n++)for(var r=0;r<e[n].length;r++)if(!(i[n][r]>=3)&&e[n][r]>=t[n][r]&&0==s[n][r])return!0;return!1}()?this.achievementUI.star.setVisible(!1):this.achievementUI.star.setVisible(!0),0==function(){for(var t=[_,S,T],e=[M,I,B],i=0;i<t.length;i++)for(var s=0;s<t[i].length;s++)if(t[i][s]>0&&1==e[i][s])return!0;return!1}()?this.bookUI.star.setVisible(!1):this.bookUI.star.setVisible(!0)}addMask(){let t=this.make.graphics();t.fillStyle(16777215),t.fillRect(0,0,600,775),this.board.mask=new Phaser.Display.Masks.BitmapMask(this,t)}createInfo(){var t=r;null==t?this.add.sprite(99,60,"info_photo"):(this.textures.once("addtexture",(function(){this.add.image(99,60,"baseImg")}),this),this.textures.addBase64("baseImg",t)),this.bg_info=this.add.sprite(0,0,"bg_info"),this.bg_info.setOrigin(0).setDepth(1),this.info_name=this.add.text(240,20,l,{fontSize:"13pt",padding:{top:6}}).setDepth(1),this.info_LV=this.add.bitmapText(205,20,"farmText_White",Jt(),20).setDepth(1),this.info_expOuter=this.add.sprite(405,25,"info_expOuter").setOrigin(0).setDepth(1),this.info_expInner=this.add.graphics(),this.info_expInner.setDepth(1),this.info_exp=this.add.bitmapText(475,32,"farmText_White","",10).setOrigin(.5).setDepth(1),this.info_expStar=this.add.sprite(391,29,"info_expStar").setOrigin(0,.5).setDepth(1).setDepth(1),this.updateMemberExp(),this.info_coin=this.add.bitmapText(250,93,"farmText_White","",20).setOrigin(.5).setDepth(1),this.info_O2point=this.add.bitmapText(450,93,"farmText_White",this.realO2point,20).setOrigin(.5).setDepth(1),this.updateMemberCoin(),this.createInfoButton(310,93,"coinAddbtn").setDepth(1),this.createInfoButton(510,93,"O2pointAddbtn").setDepth(1)}createInfoButton(t,e,i){var s=this.add.sprite(t,e,"btn_add",0);return Cr.push(s),s.setInteractive().on("pointerdown",(function(){wr||null==this.board&&(this.lockUIbtn(),vi(this,s).on("complete",(function(t,e){switch(i){case"coinAddbtn":yi(this),(new lr).create(this),this.events.emit("lockDrag");break;case"O2pointAddbtn":yi(this),(new En).create(this,"goMemberStore",!1),this.events.emit("lockDrag")}}),this))}),this),s}updateMemberExp(){var t=Jt(),e=Kt(),i=Je(),s=Ke();this.info_LV.setText(t),t==i&&(e=s);var n=e/s*128;this.info_expInner.clear(),this.info_expInner.fillStyle(16634946),this.info_expInner.fillRect(411,28,n,9),this.info_exp.setText(e+" / "+s)}updateMemberCoin(){var t=qt(),e=Qt();t/1e5>1?this.info_coin.setText(Math.floor(t/1e3*10)/10+"K"):this.info_coin.setText(t),this.info_O2point.setText(e)}createButton(){this.UiButtons=[],this.bg_action=this.add.sprite(0,game.config.height,"bg_action"),this.bg_action.setOrigin(0,1),this.taskUI=this.buttonController(game.config.width-60,200,0),this.signInUI=this.buttonController(game.config.width-60,270,1),this.achievementUI=this.buttonController(game.config.width-60,340,2),this.bookUI=this.buttonController(game.config.width-60,410,3),this.warehouseUI=this.buttonController(game.config.width-155,game.config.height-70,4),this.cropUI=this.buttonController(game.config.width/2,game.config.height-70,6),this.toolUI=this.buttonController(155,game.config.height-70,7),this.shopUI=this.buttonController(60,game.config.height-300,5),this.UiButtons.push(this.taskUI,this.signInUI,this.achievementUI,this.bookUI,this.warehouseUI,this.shopUI,this.cropUI,this.toolUI)}buttonController(t,e,i){var s=this.add.sprite(t,e,kr[i],0);Cr.push(s);var n=this.add.graphics();return i<4&&(s.star=function(t,e,i,s,n,r,a,o){var h=Math.PI/2*3,l=e,d=i,c=Math.PI/s;t.lineStyle(2,o,1),t.fillStyle(a,1),t.beginPath(),t.moveTo(e,i-n);for(var u=0;u<s;u++)l=e+Math.cos(h)*n,d=i+Math.sin(h)*n,t.lineTo(l,d),h+=c,l=e+Math.cos(h)*r,d=i+Math.sin(h)*r,t.lineTo(l,d),h+=c;return t.lineTo(e,i-n),t.closePath(),t.fillPath(),t.strokePath(),t}(n,t+20,e-20,5,8,4,13500416,16777215),s.star.setDepth(1),s.star.setVisible(!1)),s.setInteractive().on("pointerdown",(function(){wr||null==this.board&&(this.lockUIbtn(),vi(this,s,!1).on("complete",(function(t,e){this.checkBtnKey(i)}),this))}),this),s}lockUIbtn(){for(var t=0;t<Cr.length;t++)Cr[t].disableInteractive()}releaseUIbtn(){for(var t=0;t<Cr.length;t++)Cr[t].setInteractive()}checkBtnKey(t){this.events.emit("clickUI");for(var e=le(),i=!1,s=0;s<e.length;s++)0!=e[s]&&(i=!0);6==t&&0==i?(this.releaseUIbtn(),bi(this,"種子不足請先購買")):(yi(this),t<=5?this.scene.launch("loadObjects",{UiID:t}):6!=t&&7!=t||this.scene.launch("loadObjects",{UiID:t,x:this.cropUI.x,y:this.cropUI.y}))}}class Tr extends Phaser.Scene{constructor(){super("loadObjects")}init(t){this.x=t.x,this.y=t.y,this.UiID=t.UiID,this.type=t.type}preload(){this.load.image("smallCover","./assets/smallCover.png"),this.load.image("bg_table","./assets/bg_table.png"),this.load.image("bg_rect","./assets/bg_rect.png"),3!=this.UiID&&(this.load.spritesheet("obj_tool","./assets/obj_tool.png",{frameWidth:120,frameHeight:100}),this.load.spritesheet("obj_seed","./assets/obj_seed.png",{frameWidth:120,frameHeight:100})),3!=this.UiID&&5!=this.UiID||this.load.spritesheet("bg_locked","./assets/bg_locked.png",{frameWidth:150,frameHeight:175}),4!=this.UiID&&5!=this.UiID||this.load.spritesheet("label_tool","./assets/label_tool.png",{frameWidth:80,frameHeight:35}),0==this.UiID?(this.load.image("bg_taskRect","./assets/bg_taskRect.png"),this.load.image("title_task","./assets/title_task.png"),this.load.spritesheet("obj_box","./assets/obj_box.png",{frameWidth:50,frameHeight:50}),this.load.spritesheet("label_daily","./assets/label_daily.png",{frameWidth:80,frameHeight:35})):1==this.UiID?(this.load.image("bg_signInBoard","./assets/bg_signInBoard.png"),this.load.spritesheet("obj_signInBack","./assets/obj_signInBack.png",{frameWidth:105,frameHeight:140})):2==this.UiID?(this.load.image("bg_achievementRect","./assets/bg_achievementRect.png"),this.load.image("title_achievement","./assets/title_achievement.png"),this.load.spritesheet("label_manage","./assets/label_manage.png",{frameWidth:80,frameHeight:35}),this.load.spritesheet("label_book","./assets/label_book.png",{frameWidth:80,frameHeight:35}),this.load.spritesheet("label_grow","./assets/label_grow.png",{frameWidth:80,frameHeight:35}),this.load.spritesheet("obj_star","./assets/obj_star.png",{frameWidth:50,frameHeight:15})):3==this.UiID?(this.load.image("title_book","./assets/title_book.png"),this.load.image("obj_bookLock","./assets/obj_bookLock.png"),this.load.spritesheet("obj_N","./assets/obj_N.png",{frameWidth:125,frameHeight:130}),this.load.spritesheet("obj_SR","./assets/obj_SR.png",{frameWidth:125,frameHeight:130}),this.load.spritesheet("obj_SSR","./assets/obj_SSR.png",{frameWidth:125,frameHeight:130}),this.load.spritesheet("obj_heart","./assets/obj_heart.png",{frameWidth:30,frameHeight:25}),this.load.spritesheet("label_N","./assets/label_N.png",{frameWidth:80,frameHeight:35}),this.load.spritesheet("label_SR","./assets/label_SR.png",{frameWidth:80,frameHeight:35}),this.load.spritesheet("label_SSR","./assets/label_SSR.png",{frameWidth:80,frameHeight:35}),this.load.spritesheet("bg_bookRect","./assets/bg_bookRect.png",{frameWidth:150,frameHeight:175})):4==this.UiID?(this.load.image("bg_warehouseTable","./assets/bg_warehouseTable.png"),this.load.image("bg_warehouseRect","./assets/bg_warehouseRect.png"),this.load.image("bg_cropRect","./assets/bg_cropRect.png"),this.load.image("title_warehouse","./assets/title_warehouse.png"),this.load.spritesheet("label_crop","./assets/label_crop.png",{frameWidth:80,frameHeight:35})):5==this.UiID?(this.load.image("bg_shopRect","./assets/bg_shopRect.png"),this.load.image("bg_costRect","./assets/bg_costRect.png"),this.load.image("title_shop","./assets/title_shop.png"),this.load.spritesheet("obj_gift","./assets/obj_gift.png",{frameWidth:120,frameHeight:100}),this.load.spritesheet("bg_soldOut","./assets/bg_soldOut.png",{frameWidth:150,frameHeight:175}),this.load.spritesheet("label_seed","./assets/label_seed.png",{frameWidth:80,frameHeight:35}),this.load.spritesheet("label_timeLimit","./assets/label_timeLimit.png",{frameWidth:80,frameHeight:35})):6==this.UiID?this.load.image("bg_cropMenu","./assets/bg_cropMenu.png"):7==this.UiID&&this.load.image("bg_toolMenu","./assets/bg_toolMenu.png")}create(){this.input.setTopOnly(!0),this.input.setGlobalTopOnly(!0),this.sceneUI=this.scene.get("UI"),this.sceneUI.events.on("hideAllBoard",(function(t){wi(this),ki(this.sceneUI),Ci(this),_i(this)}),this),6==this.UiID||7==this.UiID?this.board=(new _r[this.UiID]).create(this,this.x,this.y):this.board=(new _r[this.UiID]).create(this),null!=this.board&&this.events.emit("showBoard",{board:this.board,boardKey:this.UiID})}}class Or extends Phaser.GameObjects.Sprite{constructor(t){super(t.scene,t.x,t.y,t.key,t.frame,t.id),t.scene.add.existing(this),this.x=t.x,this.y=t.y,this.id=t.id,this.status=Z[this.id],this.statusID=q[this.id],this.landMode=void 0,this.cropType=void 0,this.cropTypeFrame=$[this.id],this.cropStatus=ee()[this.id],this.elapsed=0,this.polygon=new Phaser.Geom.Polygon([this.x-80,this.y,this.x,this.y-45,this.x+80,this.y,this.x,this.y+45]),this.graphics=this.scene.add.graphics(),this.graphics.setVisible(!1),this.graphics.lineStyle(1,16711680,1),this.graphics.strokePoints(this.polygon.points,!0),this.setInteractive(this.polygon,Phaser.Geom.Polygon.Contains),1==this.statusID||2==this.statusID?this.setLandCropStatus(this.x,this.y,this.cropTypeFrame):3==this.statusID&&this.setFrame(2)}showLandMode(t,e,i){if(null!=this.landMode&&this.hideLandMode(),this.input.enabled)switch(i){case"dig":this.landMode=this.scene.add.sprite(t-40,e-20,"land_dig");break;case"water":this.landMode=this.scene.add.sprite(t-40,e-20,"land_water");break;case"fertilizer":this.landMode=this.scene.add.sprite(t-40,e-20,"land_fertilizer");break;case"seed":this.landMode=this.scene.add.sprite(t-40,e-20,"land_seed");break;case"quick":this.landMode=this.scene.add.container(t,e-50).setDepth(1),this.needTime=se()[this.id];var s=o,n=Math.ceil(this.needTime/s),r=$e()[this.cropType],a=parseInt(this.needTime/60/60),h=this.needTime-60*a*60,l=parseInt(h/60),d=h%60;this.name=this.scene.add.bitmapText(-15,-9,"farmText_Black",r,14).setOrigin(.5),this.time=this.scene.add.bitmapText(-15,11,"farmText_White","",14).setOrigin(.5),this.time.setText(a+"時"+l+"分"+d+"秒"),this.quickBG=this.scene.add.sprite(0,0,"land_quickBG"),this.quickBtn=this.scene.add.sprite(55,0,"land_quickBtn").setInteractive().on("pointerdown",(function(){this.canDragBackground,this.scene.clickQuickBtn=!0,vi(this.scene,this.quickBtn).on("complete",(function(t){this.scene.clickQuickBtn=!1,this.scene.events.emit("clickSpeedUp",{id:this.id,type:"speedUp",cost:n})}),this)}),this),this.landMode.add([this.quickBG,this.quickBtn,this.name,this.time])}}hideLandMode(){null!=this.landMode&&(this.landMode.destroy(),this.landMode=void 0)}setLandStatus(t){var e;switch(t){case"land_dig":e=void 0,this.cropType=void 0;break;case"land_water":e="fertilized"==this.status?"fertilized":"watered";break;case"land_fertilizer":e="fertilized";break;case"land_seed":e="planted"}this.status=e}setLandCropStatus(t,e,i){switch(this.cropType=i,this.cropTypeSprite=this.scene.add.sprite(t,e,"obj_crop",i).setVisible(!1),null==this.cropStatus&&(this.cropStatus=0),this.cropStatus){case 0:this.cropStatusSprite=this.scene.add.sprite(t,e,"land_seeds");break;case 1:this.cropStatusSprite=this.scene.add.sprite(t,e,"land_seedsLV2",i);break;case 2:this.cropStatusSprite=this.scene.add.sprite(t,e,"land_seedsLV3",i)}this.buffTime=0,this.needTime=se()[this.id],this.growSecLV2=Qe()[i],this.growSecLV3=ti()[i],this.deadSec=ei()[i],this.harvestNum=Pt[i],this.exp=Mt[i]}clearLand(){var t,e;this.cropStatusSprite.destroy(),this.cropStatusSprite=void 0,this.status=void 0,this.status=(t=this.id,e=void 0,void(Z[t]=e)),this.statusID=0,this.statusID=function(t,e){q[t]=e}(this.id,0),this.cropTypeFrame=null,this.cropTypeFrame=function(t,e){$[t]=e}(this.id,null),this.cropStatus=null,this.cropStatus=ie(this.id,null)}setHarvestNum(t){this.scene.anims.create({key:"action_rainbow",frames:this.scene.anims.generateFrameNumbers("land_rainbow",{start:0,end:4}),frameRate:8,repeat:1,hideOnComplete:!0}),this.scene.add.sprite(this.x,this.y-25,"land_rainbow",0).play("action_rainbow"),this.harvestNum=t}}class Er extends Phaser.GameObjects.Sprite{constructor(t){super(t.scene,t.x,t.y,t.key,t.frame),t.scene.add.existing(this),this.setDepth(1),this.setOrigin(.5,.8),this.stay=!1,this.rate=t.rate,this.key=t.key,this.frameIndex=t.frame,this.emotion=this.scene.add.sprite(0,0,"emotion",0).setDepth(1),this.round=0,this.totalTime=0,this.direction=0==Phaser.Math.Between(0,1)?"left":"right",this.setInteractive().on("pointerup",(function(){switch(Oi(this.scene,"clickPartnerSE"),this.input.enabled=!1,this.key){case"player_N":t=this.frameIndex,e=!0,O[t]=e,Pr("N",this.frameIndex);break;case"player_SR":!function(t,e){E[t]=e}(this.frameIndex,!0),Pr("SR",this.frameIndex);break;case"player_SSR":!function(t,e){P[t]=e}(this.frameIndex,!0),Pr("SSR",this.frameIndex)}var t,e;ge(5,1,!0),Se(7,1,!0),this.emotion.setFrame(1),this.scene.tweens.add({targets:this.emotion,scale:{from:.8,to:1.2},ease:"Circ",yoyo:!1,repeat:2,duration:400,onComplete:function(){this.emotion.visible=!1},callbackScope:this})}),this),"host"==this.key&&(this.removeInteractive(),this.emotion.visible=!1),this.createAnimation()}createAnimation(){this.scene.anims.create({key:"shining",frames:this.scene.anims.generateFrameNumbers("shining",{start:0,end:3}),frameRate:6,repeat:1,hideOnComplete:!0}),this.scene.anims.create({key:"shining2",frames:this.scene.anims.generateFrameNumbers("shining",{start:4,end:7}),frameRate:6,repeat:1,hideOnComplete:!0}),this.scene.anims.create({key:"shining3",frames:this.scene.anims.generateFrameNumbers("shining",{start:8,end:11}),frameRate:6,repeat:1,hideOnComplete:!0}),this.scene.anims.create({key:"goDownLeft"+this.key+this.frameIndex,frames:this.scene.anims.generateFrameNumbers(this.key,{start:12*this.frameIndex+0,end:12*this.frameIndex+2}),frameRate:6,repeat:-1}),this.scene.anims.create({key:"goDownRight"+this.key+this.frameIndex,frames:this.scene.anims.generateFrameNumbers(this.key,{start:12*this.frameIndex+3,end:12*this.frameIndex+5}),frameRate:6,repeat:-1}),this.scene.anims.create({key:"goUpLeft"+this.key+this.frameIndex,frames:this.scene.anims.generateFrameNumbers(this.key,{start:12*this.frameIndex+6,end:12*this.frameIndex+8}),frameRate:6,repeat:-1}),this.scene.anims.create({key:"goUpRight"+this.key+this.frameIndex,frames:this.scene.anims.generateFrameNumbers(this.key,{start:12*this.frameIndex+9,end:12*this.frameIndex+11}),frameRate:6,repeat:-1})}startWalk(){this.path=this.createPath(),this.points=this.path.getPoints(.1),this.nextPoint(this,this.points,this.direction,this.rate,0)}createPath(){var t=new Phaser.Curves.Path(150,880);return"right"==this.direction?t.lineTo(450,690).lineTo(570,740).lineTo(590,610).lineTo(710,520).lineTo(440,360).lineTo(620,230).lineTo(400,100).lineTo(420,310).lineTo(220,260).lineTo(-170,475).lineTo(200,710).lineTo(150,880):t.lineTo(200,710).lineTo(-170,475).lineTo(220,260).lineTo(420,310).lineTo(400,100).lineTo(620,230).lineTo(440,360).lineTo(710,520).lineTo(590,610).lineTo(570,740).lineTo(450,690).lineTo(150,880),t}nextPoint(t,e,i,s,n){n==e.length&&(n=0,this.totalTime=0),this.turnFace(i,n,t),n++;var r=e[n%e.length],a=t.x-r.x,o=t.y-r.y,h=Math.sqrt(a*a+o*o)*s;this.totalTime+=Math.round(h),this.scene.tweens.add({targets:t,x:r.x,y:r.y,ease:"Linear",duration:h,onUpdate:function(){this.emotion.setPosition(t.x,t.y-90)},onComplete:function(){if(12==n&&"host"!=this.key){if(this.round++,2==this.round||1==this.emotion.frame.name)return void this.destroySprite()}else t.isViewpoint(i,n);if(0!=this.active)if(1==this.stay){t.stop();var r=Phaser.Math.Between(0,2);this.shining=this.scene.add.sprite(t.x,t.y-20,"shining",0).setDepth(1),this.shining.anims.play(["shining","shining2","shining3"][r]),this.shining.on("animationcomplete",(function(){this.stay=!1,this.turnFace(i,n,t),this.nextPoint(t,e,i,s,n)}),this)}else this.nextPoint(t,e,i,s,n)},callbackScope:this})}turnFace(t,e,i){if("right"==t)switch(e){case 0:case 2:case 3:case 5:i.play("goUpRight"+this.key+this.frameIndex);break;case 4:case 6:case 8:i.play("goUpLeft"+this.key+this.frameIndex);break;case 7:case 9:case 11:i.play("goDownLeft"+this.key+this.frameIndex);break;case 1:case 10:i.play("goDownRight"+this.key+this.frameIndex)}else switch(e){case 0:case 2:i.play("goUpRight"+this.key+this.frameIndex);break;case 1:case 4:case 10:i.play("goUpLeft"+this.key+this.frameIndex);break;case 6:case 8:case 11:i.play("goDownLeft"+this.key+this.frameIndex);break;case 3:case 5:case 7:case 9:i.play("goDownRight"+this.key+this.frameIndex)}}isViewpoint(t,e){var i=0==Phaser.Math.Between(0,1);"right"==t?2!=e&&5!=e&&7!=e&&9!=e||(this.stay=i):3!=e&&5!=e&&7!=e&&10!=e||(this.stay=i)}destroySprite(){this.active=!1,this.emotion.visible=!0,this.emotion.setFrame(2),this.emotion.setPosition(this.x,this.y-90),this.scene.time.addEvent({delay:500,callback:function(){this.destroy(),this.emotion.visible=!1},callbackScope:this})}}function Pr(t,e){switch(t){case"N":Ie(e,1,!0),je(e,!0);break;case"SR":Le(e,1,!0),Ue(e,!0);break;case"SSR":Ye(e,1,!0),He(e,!0)}}class Mr extends Phaser.Scene{constructor(){super("play")}preload(){this.load.spritesheet("land","./assets/land.png",{frameWidth:160,frameHeight:90}),this.load.spritesheet("wood","./assets/wood.png",{frameWidth:60,frameHeight:55}),this.load.spritesheet("host","./assets/host.png",{frameWidth:100,frameHeight:105}),this.load.spritesheet("player_N","./assets/player_N.png",{frameWidth:100,frameHeight:105}),this.load.spritesheet("player_SR","./assets/player_SR.png",{frameWidth:100,frameHeight:105}),this.load.spritesheet("player_SSR","./assets/player_SSR.png",{frameWidth:100,frameHeight:105}),this.load.spritesheet("shining","./assets/shining.png",{frameWidth:100,frameHeight:55}),this.load.spritesheet("emotion","./assets/emotion.png",{frameWidth:30,frameHeight:30}),this.load.image("land_seeds","./assets/land_seeds.png"),this.load.spritesheet("land_seedsLV2","./assets/land_seedsLV2.png",{frameWidth:90,frameHeight:90}),this.load.spritesheet("land_seedsLV3","./assets/land_seedsLV3.png",{frameWidth:90,frameHeight:90})}init(){this.scene.add("loadObjects",Tr,!1),this.eachland=[],this.canClickLand=!0,this.clickQuickBtn=!1,this.canDragBackground=!0,this.opened=re()}create(){this.time.addEvent({delay:1e3,callback:function(){for(var t=new Date,e=(t.getHours(),t.getMinutes(),0);e<this.opened;e++)if(null!=this.eachland[e].status&&null!=this.eachland[e].cropStatusSprite){if(0==this.eachland[e].cropStatus||1==this.eachland[e].cropStatus){var i=se()[e];i-=1,this.eachland[e].needTime=i,ne(e,i)}if(null!=this.eachland[e].landMode&&"Container"==this.eachland[e].landMode.type){var s=parseInt(this.eachland[e].needTime/60/60),n=this.eachland[e].needTime-60*s*60,r=parseInt(n/60),a=n%60;this.eachland[e].time.setText(s+"時"+r+"分"+a+"秒"),0==this.eachland[e].needTime&&this.eachland[e].hideLandMode()}"land_seeds"==this.eachland[e].cropStatusSprite.texture.key&&0==this.eachland[e].needTime?(this.eachland[e].needTime=ti()[this.eachland[e].cropType],ne(e,ti()[this.eachland[e].cropType]),this.eachland[e].cropStatusSprite.setTexture("land_seedsLV2").setFrame(this.eachland[e].cropType)):"land_seedsLV2"==this.eachland[e].cropStatusSprite.texture.key&&0==this.eachland[e].needTime?(this.eachland[e].needTime=ei()[this.eachland[e].cropType],ne(e,ei()[this.eachland[e].cropType]),this.eachland[e].cropStatusSprite.setTexture("land_seedsLV3").setFrame(this.eachland[e].cropType),null!=this.eachland[e].landMode&&this.eachland[e].hideLandMode()):"land_seedsLV3"==this.eachland[e].cropStatusSprite.texture.key&&0==this.eachland[e].needTime&&(this.eachland[e].clearLand(),this.eachland[e].setTexture("land").setFrame(2))}},callbackScope:this,loop:!0}),this.createWorkAnims(),this.game.events.on("hidden",(function(){for(var t=0;t<this.opened;t++)null!=this.eachland[t].landMode&&"Container"==this.eachland[t].landMode.type&&this.eachland[t].hideLandMode()}),this),this.input.setTopOnly(!0);var t=this.add.sprite(-280,-300,"background").setOrigin(0),e=this.cameras.main.setBounds(-280,-300,t.displayWidth,t.displayHeight);this.cameras.main.setViewport(0,0,600,900),this.input.on("pointermove",(function(t){t.isDown&&this.canDragBackground&&(e.scrollX-=(t.x-t.prevPosition.x)/e.zoom,e.scrollY-=(t.y-t.prevPosition.y)/e.zoom,this.events.emit("dragBG"))}),this),this.input.on("pointerup",(function(t){this.events.emit("endDragBG")}),this),this.input.on("pointerup",(function(t,e){if(0!=this.canClickLand&&1!=this.clickQuickBtn)for(var i=0,s=0;s<this.opened;s++){const e=this.cameras.main.getWorldPoint(t.x,t.y),f=e.x,v=e.y;if(this.eachland[s].polygon.contains(f,v))if(this.pointerWork)if(null==this.eachland[s].landMode)for(var n=0;n<this.opened;n++)n!=s?this.eachland[n].hideLandMode():(this.hidePointerWork(),this.canDragBackground=!0,null!=this.eachland[n].status&&this.onLandwithCrop(this.eachland[n],n));else{this.eachland[s].setLandStatus(this.eachland[s].landMode.texture.key);var r=le()[this.pointerWork.frame.name];if("land_seed"==this.eachland[s].landMode.texture.key&&r>0){if(Br(this.eachland[s],this.pointerWork.frame.name),ge(1,1,!0),ve(this.pointerWork.frame.name,1,!0),de(this.pointerWork.frame.name,-1,!0),1==r){this.canDragBackground=!0,this.hidePointerWork();for(var a=0;a<this.opened;a++)this.eachland[a].hideLandMode();return}}else{Oi(this,"actionSE");var o,h,l=oe()[this.pointerWork.frame.name];l>0&&he(this.pointerWork.frame.name,-1,!0);switch(this.eachland[s].landMode.texture.key){case"land_dig":o=0,h="action_dig",Se(6,1,!0);break;case"land_water":o=3,h="action_water",ge(2,1,!0),Se(5,1,!0),Ir(this,{location:s,add_harvest_num:0==Phaser.Math.Between(0,1),harvest_num:1.5*this.eachland[s].harvestNum});break;case"land_fertilizer":var d;switch(o=6,h="action_fertilizer",Se(4,1,!0),this.pointerWork.frame.name){case 2:d=qe()[0];break;case 3:d=qe()[1];break;case 4:d=qe()[2]}var c=0,u=0;0==ee()[s]?d-(this.eachland[s].needTime+ti()[s])>=0?(c=2,u=ei()[s]):d-this.eachland[s].needTime>=0?(c=1,u=ti()[s]-(d-this.eachland[s].needTime)):(c=0,u=this.eachland[s].needTime-d):1==ee()[s]&&(d-this.eachland[s].needTime>=0?(c=2,u=ei()[s]):(c=1,u=this.eachland[s].needTime-d));Ir(this,{location:s,now_stage:c,next_sec:u,walking_partner:0!=Phaser.Math.Between(0,1)||void 0,p_type:["player_N","player_SR","player_SSR"][Phaser.Math.Between(0,2)],p_id:Phaser.Math.Between(0,9)})}var p=this.add.sprite(this.eachland[s].x+30,this.eachland[s].y-55,"land_actions",o);p.play(h);var g=s;p.on("animationupdate",(function(){if(1==l&&!this.canDragBackground){this.canDragBackground=!0,this.hidePointerWork();for(var t=0;t<this.opened;t++)this.eachland[t].hideLandMode()}}),this),p.on("animationcomplete",(function(t,e,i){"action_dig"==i.anims.currentAnim.key&&this.eachland[g].setFrame(0)}),this)}this.eachland[s].hideLandMode()}else null==this.eachland[s].status||"needDig"==this.eachland[s].status||(this.hidePointerWork(),"land_seedsLV3"==this.eachland[s].cropStatusSprite.texture.key?this.onLandwithCrop(this.eachland[s],s):this.eachland[s].showLandMode(this.eachland[s].x,this.eachland[s].y,"quick"));else if(i++,this.pointerWork){if(this.pointerWork&&i==this.opened){this.canDragBackground=!0,this.hidePointerWork();for(var m=0;m<this.opened;m++)this.eachland[m].hideLandMode()}}else 1==this.canDragBackground&&this.eachland[s].hideLandMode()}}),this),this.sceneLoadObjects=this.scene.get("loadObjects"),this.sceneLoadObjects.events.on("chooseWork",(function(t){this.canDragBackground=!1,this.pointerWork=this.add.sprite(0,0,t.key,t.frame).setVisible(!1);var e=0,i=0,s=oe()[t.frame];if("seed"!=t.work&&s<=0)bi(this,"道具數量不足");else{for(var n=0;n<4;n++)for(var r=0;r<5;r++){var a=80*r-80*n,o=45*r+45*n;e<this.opened&&("seed"==t.work&&null==this.eachland[e].status&&0==this.eachland[e].frame.name?this.eachland[e].showLandMode(270+a,350+o,t.work):"seed"!=t.work&&null!=this.eachland[e].status&&"needDig"!=this.eachland[e].status?"land_seedsLV3"==this.eachland[e].cropStatusSprite.texture.key||"dig"==t.work||"fertilizer"==t.work&&"fertilized"==this.eachland[e].status?i++:this.eachland[e].showLandMode(270+a,350+o,t.work):"dig"==t.work&&2==this.eachland[e].frame.name?this.eachland[e].showLandMode(270+a,350+o,t.work):i++),e++}i==this.opened&&(this.hidePointerWork(),bi(this,"無符合條件的土地"),this.canDragBackground=!0)}}),this),this.scene.launch("UI"),this.sceneUI=this.scene.get("UI"),this.sceneUI.events.on("clickUI",(function(t){this.hidePointerWork();for(var e=0;e<this.opened;e++)this.eachland[e].hideLandMode()}),this),this.sceneUI.events.on("lockDrag",(function(t){this.canDragBackground=!1}),this),this.sceneUI.events.on("releaseDrag",(function(t){this.canDragBackground=!0}),this),this.sceneUI.events.on("lockLand",(function(t){this.canClickLand=!1}),this),this.sceneUI.events.on("releaseLand",(function(t){this.canClickLand=!0}),this),this.sceneUI.events.on("cancelShortenGrowing",(function(t){for(var e=0;e<this.opened;e++)null!=this.eachland[e].landMode&&this.eachland[e].hideLandMode()}),this),this.sceneUI.events.on("shortenGrowing",(function(t){"land_seeds"==this.eachland[t.landID].cropStatusSprite.texture.key?(this.eachland[t.landID].needTime=ti()[t.landID],ne(t.landID,ti()[t.landID]),this.eachland[t.landID].cropStatusSprite.setTexture("land_seedsLV2").setFrame(this.eachland[t.landID].cropType)):"land_seedsLV2"==this.eachland[t.landID].cropStatusSprite.texture.key&&(this.eachland[t.landID].needTime=ei()[t.landID],ne(t.landID,ei()[t.landID]),this.eachland[t.landID].cropStatusSprite.setTexture("land_seedsLV3").setFrame(this.eachland[t.landID].cropType)),this.eachland[t.landID].hideLandMode()}),this),this.sceneUI.events.on("levelUp_updateWood",(function(t){this.updateWoodFrame()}),this),this.sceneUI.events.on("openLand",(function(t){var e;this.eachland[this.opened].setFrame(0),this.opened+=1,this.opened<20?(e=this.opened,v=e,this.wood.setPosition(this.eachland[this.opened].x,this.eachland[this.opened].y-20),this.updateWoodFrame()):(this.wood.setVisible(!1),this.wood=void 0)}),this);for(var i=0,s=0,n=0;n<4;n++)for(var r=0;r<5;r++){var a=80*r-80*n,o=45*r+45*n;i>=this.opened&&(s=1),this.eachland[i]=new Or({scene:this,id:i,x:230+a,y:350+o,key:"land",frame:s}),i++}this.wood=this.add.sprite(0,0,"wood",1).setDepth(1),this.opened<20?(this.wood.setPosition(this.eachland[this.opened].x,this.eachland[this.opened].y-20),this.updateWoodFrame(),this.wood.setInteractive().on("pointerdown",(function(){0!=this.canClickLand&&(Oi(this,"clickSE"),vi(this,this.wood).on("complete",(function(t,e){var i,s,n=ut,r=pt;0==n[this.opened]?(i=r[this.opened],s=1):(i=n[this.opened],s=0),0==e[0].frame.name?bi(this,"等級不足"):1==e[0].frame.name&&this.events.emit("clickWood",{type:"newLand",cost:i,coinFrame:s})}),this))}),this)):(this.wood.setVisible(!1),this.wood=void 0),new Er({scene:this,x:150,y:880,rate:15,key:"host",frame:0}).startWalk()}createWorkAnims(){this.anims.create({key:"action_dig",frames:this.anims.generateFrameNumbers("land_actions",{start:0,end:2}),frameRate:6,repeat:1,hideOnComplete:!0}),this.anims.create({key:"action_water",frames:this.anims.generateFrameNumbers("land_actions",{start:3,end:5}),frameRate:6,repeat:1,hideOnComplete:!0}),this.anims.create({key:"action_fertilizer",frames:this.anims.generateFrameNumbers("land_actions",{start:6,end:8}),frameRate:6,repeat:1,hideOnComplete:!0})}hidePointerWork(){null!=this.pointerWork&&(this.pointerWork.destroy(),this.pointerWork=void 0)}onLandwithCrop(t,e){"land_seedsLV3"==t.cropStatusSprite.texture.key?function(t,e){for(var i=0,s=ae(),n=ce(),r=0;r<n.length;r++)0!=n[r]&&(n[r]>80?i+=Math.ceil(n[r]/80):i++);t.texture.key;var a=t.frame.name,o=parseInt(e),h=n[a],l=Math.ceil(h/80),d=h+o,c=s-i;return i==s&&h>0?d<=80*l:i<s&&(h>0&&d<=80*(c+l)||h<=0&&d<=80*c)}(t.cropTypeSprite,t.harvestNum)?(Oi(this,"harvestSE"),function(t,e){ge(0,1,!0);var i=!1;Kt()+t.eachland[e].exp>=Ke()&&(i=!0);t.events.emit("harvest",{type:"harvest",expInc:t.eachland[e].exp,isLevelUp:i}),t.events.emit("endDragBG")}(this,e),Si(this,t.cropTypeSprite,t.harvestNum),t.clearLand()):bi(this,"倉庫空間不足"):t.showLandMode(t.x,t.y,"quick")}updateWoodFrame(){Jt()<ct[re()]?this.wood.setFrame(0):this.wood.setFrame(1)}}function Ir(t,e){if(null!=e.next_sec)switch(t.eachland[e.location].needTime=e.next_sec,ne(e.location,e.next_sec),e.now_stage){case 1:ie(e.location,1),t.eachland[e.location].cropStatusSprite.setTexture("land_seedsLV2").setFrame(t.eachland[e.location].cropType);break;case 2:ie(e.location,2),t.eachland[e.location].cropStatusSprite.setTexture("land_seedsLV3").setFrame(t.eachland[e.location].cropType)}null!=e.add_harvest_num&&t.eachland[e.location].setHarvestNum(e.harvest_num);var i=e.p_type,s=e.p_id;null!=e.walking_partner&&(null!=e.walking_partner&&(t.partner=new Er({scene:t,x:150,y:880,rate:17,key:i,frame:s}),t.partner.startWalk()))}function Br(t,e){t.scene.canClickLand=!0,t.scene.events.emit("endDragBG"),ie(t.id,0),ne(t.id,Qe()[e]),t.setLandCropStatus(t.x,t.y-10,e)}class jr{constructor(t){this.scene=t,this.displayList=t.sys.displayList,this.updateList=t.sys.updateList,t.events.once("destroy",this.destroy,this)}destroy(){this.scene=null,this.displayList=null,this.updateList=null}static register(t,e){jr.prototype[t]=e}}var zr=jr;const Dr=Phaser.Utils.Objects.GetValue;var Lr=function(t,e,i){return void 0===t?{x:e,y:i}:"number"==typeof t?{x:t,y:t}:t},Rr=class{constructor(t,e,i,s,n){this.cornerRadius={},this._width=0,this._height=0,this.setTo(t,e,i,s,n)}setTo(t,e,i,s,n){return this.setPosition(t,e),this.setRadius(n),this.setSize(i,s),this}setPosition(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this}setRadius(t){var e,i;void 0===t&&(t=0),"number"==typeof t?(e=t,i=t):(e=Dr(t,"x",0),i=Dr(t,"y",0));var s=this.cornerRadius;return s.tl=Lr(Dr(t,"tl",void 0),e,i),s.tr=Lr(Dr(t,"tr",void 0),e,i),s.bl=Lr(Dr(t,"bl",void 0),e,i),s.br=Lr(Dr(t,"br",void 0),e,i),this}setSize(t,e){return this.width=t,this.height=e,this}get minWidth(){var t=this.cornerRadius;return Math.max(t.tl.x+t.tr.x,t.bl.x+t.br.x)}get minHeight(){var t=this.cornerRadius;return Math.max(t.tl.y+t.bl.y,t.tr.y+t.br.y)}get width(){return this._width}set width(t){null==t&&(t=0),this._width=Math.max(t,this.minWidth)}get height(){return this._height}set height(t){null==t&&(t=0),this._height=Math.max(t,this.minHeight)}get radius(){var t=this.cornerRadius;return Math.max(t.tl.x,t.tl.y,t.tr.x,t.tr.y,t.bl.x,t.bl.y,t.br.x,t.br.y)}},Ur=function(t,e,i){var s=i.length;if(s>=2){var n=i[s-2],r=i[s-1];if(t===n&&e===r)return i}return i.push(t,e),i},Fr=i(1),Wr=i.n(Fr),Yr=function(t,e,i,s,n,r,a,o,h){var l,d,c;a&&(r+=360),n=Wr()(n);for(var u=((r=Wr()(r))-n)/o,p=0;p<=o;p++)c=n+u*p,l=t+i*Math.cos(c),d=e+s*Math.sin(c),Ur(l,d,h);return h},Ar=i(2),Hr=i.n(Ar),Vr=i(3),Nr=i.n(Vr),Gr={renderWebGL:Hr.a,renderCanvas:Nr.a};const Xr=Phaser.Utils.Objects.GetValue,Jr=Phaser.Geom.Polygon.Earcut;class Kr extends Phaser.GameObjects.Shape{constructor(t,e,i,s,n,r,a,o){void 0===e&&(e=0),void 0===i&&(i=0);var h=new Rr;super(t,"RoundRectangle",h);var l=Xr(r,"radius",r);h.setTo(0,0,s,n,l);var d=Xr(r,"iteration",void 0);this.setIteration(d),this.setPosition(e,i),void 0!==a&&this.setFillStyle(a,o),this.updateDisplayOrigin(),this.updateData()}updateData(){var t=this.geom,e=this.pathData;e.length=0;var i,s=t.cornerRadius,n=this.iteration+1;if(i=s.br,Zr(i)){var r=t.width-i.x,a=t.height-i.y;Yr(r,a,i.x,i.y,0,90,!1,n,e)}else Ur(t.width,t.height,e);if(i=s.bl,Zr(i)){r=i.x,a=t.height-i.y;Yr(r,a,i.x,i.y,90,180,!1,n,e)}else Ur(0,t.height,e);if(i=s.tl,Zr(i)){r=i.x,a=i.y;Yr(r,a,i.x,i.y,180,270,!1,n,e)}else Ur(0,0,e);if(i=s.tr,Zr(i)){r=t.width-i.x,a=i.y;Yr(r,a,i.x,i.y,270,360,!1,n,e)}else Ur(t.width,0,e);return e.push(e[0],e[1]),this.pathIndexes=Jr(e),this}get width(){return this.geom.width}set width(t){this.resize(t,this.height)}get height(){return this.geom.height}set height(t){this.resize(this.width,t)}resize(t,e){if(void 0===e&&(e=t),this.geom.width===t&&this.geom.height===e)return this;this.geom.height=e,this.geom.width=t,this.updateDisplayOrigin(),this.updateData();var i=this.input;return i&&!i.customHitArea&&(i.hitArea.width=t,i.hitArea.height=e),this}get iteration(){return this._iteration}set iteration(t){void 0!==this._iteration?this._iteration!==t&&(this._iteration=t,this.updateData()):this._iteration=t}setIteration(t){return void 0===t&&(t=6),this.iteration=t,this}get radius(){return this.geom.radius}set radius(t){this.geom.setRadius(t),this.updateDisplayOrigin(),this.updateData()}setRadius(t){return void 0===t&&(t=0),this.radius=t,this}get cornerRadius(){return this.geom.cornerRadius}set cornerRadius(t){this.radius=t}setCornerRadius(t){return this.setRadius(t)}}var Zr=function(t){return 0!==t.x&&0!==t.y};Object.assign(Kr.prototype,Gr);var qr=Kr,$r=function(t){return null==t||""===t||0===t.length},Qr=function(t,e,i){if("object"==typeof t){if($r(e)){if(null==i)return;"object"==typeof i&&(t=i)}else{"string"==typeof e&&(e=e.split("."));var s=e.pop();(function(t,e,i){var s=t;if($r(e));else{var n;"string"==typeof e&&(e=e.split("."));for(var r=0,a=e.length;r<a;r++){var o;if(null==s[n=e[r]]||"object"!=typeof s[n])o=r===a-1?void 0===i?{}:i:{},s[n]=o;s=s[n]}}return s}(t,e))[s]=i}return t}};zr.register("roundRectangle",(function(t,e,i,s,n,r,a){var o=new qr(this.scene,t,e,i,s,n,r,a);return this.scene.add.existing(o),o})),Qr(window,"RexPlugins.UI.RoundRectangle",qr);var ta=i(4),ea=i.n(ta),ia=i(5),sa=i.n(ia),na={renderWebGL:ea.a,renderCanvas:sa.a};const ra=Phaser.Display.Canvas.CanvasPool;var aa=function(t){var e=ra.create(this),i=e.getContext("2d");t.syncFont(e,i);var s=i.measureText(t.testString);if(s.hasOwnProperty("actualBoundingBoxAscent")&&s.hasOwnProperty("actualBoundingBoxDescent")){var n=s.actualBoundingBoxAscent,r=s.actualBoundingBoxDescent,a={ascent:n,descent:r,fontSize:n+r};return ra.remove(e),a}var o=Math.ceil(s.width*t.baselineX),h=o,l=2*h;h=h*t.baselineY|0,e.width=o,e.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=t._font,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(t.testString,0,h);a={ascent:0,descent:0,fontSize:0};if(!i.getImageData(0,0,o,l))return a.ascent=h,a.descent=h+6,a.fontSize=a.ascent+a.descent,ra.remove(e),a;var d,c,u=i.getImageData(0,0,o,l).data,p=u.length,g=4*o,m=0,f=!1;for(d=0;d<h;d++){for(c=0;c<g;c+=4)if(255!==u[m+c]){f=!0;break}if(f)break;m+=g}for(a.ascent=h-d,m=p-g,f=!1,d=l;d>h;d--){for(c=0;c<g;c+=4)if(255!==u[m+c]){f=!0;break}if(f)break;m-=g}return a.descent=d-h,a.fontSize=a.ascent+a.descent,ra.remove(e),a},oa={NO_NEWLINE:0,RAW_NEWLINE:1,WRAPPED_NEWLINE:2,NO_WRAP:0,WORD_WRAP:1,CHAR_WRAP:2,SPLITREGEXP:/(?:\r\n|\r|\n)/};const ha=Phaser.Utils.Objects.GetAdvancedValue,la=Phaser.Utils.Objects.GetValue;var da={backgroundColor:["backgroundColor",null],fontFamily:["fontFamily","Courier"],fontSize:["fontSize","16px"],fontStyle:["fontStyle",""],color:["color","#fff"],stroke:["stroke","#fff"],strokeThickness:["strokeThickness",0],shadowOffsetX:["shadow.offsetX",0],shadowOffsetY:["shadow.offsetY",0],shadowColor:["shadow.color","#000"],shadowBlur:["shadow.blur",0],shadowStroke:["shadow.stroke",!1],shadowFill:["shadow.fill",!1],underlineColor:["underline.color","#000"],underlineThickness:["underline.thickness",0],underlineOffset:["underline.offset",0],halign:["halign","left"],valign:["valign","top"],maxLines:["maxLines",0],fixedWidth:["fixedWidth",0],fixedHeight:["fixedHeight",0],resolution:["resolution",0],lineSpacing:["lineSpacing",0],rtl:["rtl",!1],testString:["testString","|MÃ‰qgy"],baselineX:["baselineX",1.2],baselineY:["baselineY",1.4],wrapMode:["wrap.mode",1],wrapWidth:["wrap.width",0]};const ca={none:oa.NO_WRAP,word:oa.WORD_WRAP,char:oa.CHAR_WRAP,character:oa.CHAR_WRAP};var ua=class{constructor(t,e){this.parent=t,this.backgroundColor,this.fontFamily,this.fontSize,this.fontStyle,this.color,this.stroke,this.strokeThickness,this.shadowOffsetX,this.shadowOffsetY,this.shadowColor,this.shadowBlur,this.shadowStroke,this.shadowFill,this.underlineColor,this.underlineThickness,this.underlineOffset,this.halign,this.valign,this.maxLines,this.fixedWidth,this.fixedHeight,this.resolution,this.lineSpacing,this.rtl,this.testString,this.baselineX,this.baselineY,this._font,this.setStyle(e,!1);var i=la(e,"metrics",!1);this.metrics=i?{ascent:la(i,"ascent",0),descent:la(i,"descent",0),fontSize:la(i,"fontSize",0)}:aa(this)}setStyle(t,e){if(void 0===e&&(e=!0),t&&t.hasOwnProperty("wrap")){var i=t.wrap;if(i.hasOwnProperty("mode")){var s=i.mode;"string"==typeof s&&(i.mode=ca[s])}else i.hasOwnProperty("width")&&(i.mode=1)}for(var n in t&&t.hasOwnProperty("fontSize")&&"number"==typeof t.fontSize&&(t.fontSize=t.fontSize.toString()+"px"),da)this[n]="wrapCallback"===n||"wrapCallbackScope"===n?la(t,da[n][0],da[n][1]):ha(t,da[n][0],da[n][1]);var r=la(t,"font",null);this._font=null===r?this.fontStyle+" "+this.fontSize+" "+this.fontFamily:r;var a=la(t,"fill",null);return null!==a&&(this.color=a),e?this.update(!0):this.parent}syncFont(t,e){e.font=this._font}syncStyle(t,e){e.textBaseline="alphabetic",e.fillStyle=this.color,e.strokeStyle=this.stroke,e.lineWidth=this.strokeThickness,e.lineCap="round",e.lineJoin="round"}syncShadow(t,e){e?(t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY,t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur):(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowColor=0,t.shadowBlur=0)}update(t){return t&&(this._font=this.fontStyle+" "+this.fontSize+" "+this.fontFamily,this.metrics=aa(this)),this.parent.updateText(t)}buildFont(){var t=this.fontStyle+" "+this.fontSize+" "+this.fontFamily;return t!==this._font&&(this._font=t),this}setFont(t){return"string"==typeof t?(this.fontFamily=t,this.fontSize="",this.fontStyle=""):(this.fontFamily=la(t,"fontFamily","Courier"),this.fontSize=la(t,"fontSize","16px"),this.fontStyle=la(t,"fontStyle","")),this.update(!0)}setFontFamily(t){return this.fontFamily=t,this.update(!0)}setFontStyle(t){return this.fontStyle=t,this.update(!0)}setFontSize(t){return"number"==typeof t&&(t=t.toString()+"px"),this.fontSize=t,this.update(!0)}setTestString(t){return this.testString=t,this.update(!0)}setFixedSize(t,e){return this.fixedWidth=t,this.fixedHeight=e,t&&(this.parent.width=t),e&&(this.parent.height=e),this.update(!1)}setResolution(t){return this.resolution=t,this.update(!1)}setLineSpacing(t){return this.lineSpacing=t,this.update(!1)}setBackgroundColor(t){return this.backgroundColor=t,this.update(!1)}setFill(t){return this.color=t,this.update(!1)}setColor(t){return this.color=t,this.update(!1)}setStroke(t,e){return void 0===t?this.strokeThickness=0:(void 0===e&&(e=this.strokeThickness),this.stroke=t,this.strokeThickness=e),this.update(!0)}setShadow(t,e,i,s,n,r){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i="#000"),void 0===s&&(s=0),void 0===n&&(n=!1),void 0===r&&(r=!0),this.shadowOffsetX=t,this.shadowOffsetY=e,this.shadowColor=i,this.shadowBlur=s,this.shadowStroke=n,this.shadowFill=r,this.update(!1)}setShadowOffset(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.shadowOffsetX=t,this.shadowOffsetY=e,this.update(!1)}setShadowColor(t){return void 0===t&&(t="#000"),this.shadowColor=t,this.update(!1)}setShadowBlur(t){return void 0===t&&(t=0),this.shadowBlur=t,this.update(!1)}setShadowStroke(t){return this.shadowStroke=t,this.update(!1)}setShadowFill(t){return this.shadowFill=t,this.update(!1)}setUnderline(t,e,i){return void 0===t&&(t="#000"),void 0===e&&(e=0),void 0===i&&(i=0),this.underlineColor=t,this.underlineThickness=e,this.underlineOffset=i,this.update(!1)}setUnderlineColor(t){return void 0===t&&(t="#000"),this.underlineColor=t,this.update(!1)}setUnderlineThickness(t){return void 0===t&&(t=0),this.underlineThickness=t,this.update(!1)}setUnderlineOffset(t){return void 0===t&&(t=0),this.underlineOffset=t,this.update(!1)}setWrapMode(t){return"string"==typeof t&&(t=ca[t.toLowerCase()]||0),this.wrapMode=t,this.update(!0)}setWrapWidth(t){return this.wrapWidth=t,this.update(!1)}setAlign(t,e){return void 0===t&&(t="left"),void 0===e&&(e="top"),this.halign=t,this.valign=e,this.update(!1)}setHAlign(t){return void 0===t&&(t="left"),this.halign=t,this.update(!1)}setVAlign(t){return void 0===t&&(t="top"),this.valign=t,this.update(!1)}setMaxLines(t){return void 0===t&&(t=0),this.maxLines=t,this.update(!1)}getTextMetrics(){var t=this.metrics;return{ascent:t.ascent,descent:t.descent,fontSize:t.fontSize}}get lineHeight(){return this.metrics.fontSize+this.strokeThickness+this.lineSpacing}toJSON(){var t={};for(var e in da)t[e]=this[e];return t.metrics=this.getTextMetrics(),t}destroy(){this.parent=void 0}},pa={draw(t,e,i,s){var n=this.penManager;this.hitAreaManager.clear();var r=this.context;r.save(),this.drawBackground(this.defatultStyle.backgroundColor);var a=this.defatultStyle;t+=this.startXOffset,e+=this.startYOffset;var o,h,l,d,c,u,p=a.halign,g=a.valign,m=a.lineHeight,f=n.lines,v=f.length,b=a.maxLines;b>0&&v>b?(h=b,l="center"===g?Math.floor((v-h)/2):"bottom"===g?v-h:0):(h=v,l=0),d=l+h,u="center"===g?Math.max((s-h*m)/2,0):"bottom"===g?Math.max(s-h*m-2,0):0,u+=e;for(var x=l;x<d;x++)if(0!==(o=n.getLineWidth(x))){c="center"===p?(i-o)/2:"right"===p?i-o:0,c+=t;for(var y=f[x],w=0,k=y.length;w<k;w++)this.drawPen(y[w],c,u)}r.restore()},drawPen(t,e,i){e+=t.x,i+=t.y;var s=this.canvas,n=this.context;n.save();var r=this.parser.propToContextStyle(this.defatultStyle,t.prop);r.buildFont(),r.syncFont(s,n),r.syncStyle(s,n),r.underlineThickness>0&&t.width>0&&this.drawUnderline(e,i,t.width,r),t.isTextPen&&this.drawText(e,i,t.text,r),t.isImagePen&&this.drawImage(e,i,t.prop.img,r),n.restore(),t.hasAreaMarker&&t.width>0&&this.hitAreaManager.add(t.prop.area,e,i-this.startYOffset,t.width,this.defatultStyle.lineHeight)},clear(){var t=this.canvas;this.context.clearRect(0,0,t.width,t.height)},drawBackground(t){null!==t&&(this.context.fillStyle=t,this.context.fillRect(0,0,this.canvas.width,this.canvas.height))},drawUnderline(t,e,i,s){e+=s.underlineOffset-s.underlineThickness/2,this.autoRound&&(t=Math.round(t),e=Math.round(e));var n=this.context,r=n.lineCap;n.lineCap="butt",n.beginPath(),n.strokeStyle=s.underlineColor,n.lineWidth=s.underlineThickness,n.moveTo(t,e),n.lineTo(t+i,e),n.stroke(),n.lineCap=r},drawText(t,e,i,s){this.autoRound&&(t=Math.round(t),e=Math.round(e));var n=this.context;s.strokeThickness&&(s.syncShadow(n,s.shadowStroke),n.strokeText(i,t,e)),s.color&&"none"!==s.color&&(s.syncShadow(n,s.shadowFill),n.fillText(i,t,e))},drawImage(t,e,i,s){var n=this.parent.imageManager,r=n.get(i),a=n.getFrame(i);t+=r.left,e+=-this.startYOffset+r.y,this.autoRound&&(t=Math.round(t),e=Math.round(e)),this.context.drawImage(a.source.image,a.cutX,a.cutY,a.cutWidth,a.cutHeight,t,e,r.width,r.height)}};var ga=class{constructor(){this.items=[]}destroy(){this.clear(),this.items=void 0}pop(){return this.items.length>0?this.items.pop():null}push(t){return this.items.push(t),this}pushMultiple(t){return this.items.push.apply(this.items,t),t.length=0,this}clear(){return this.items.length=0,this}};const ma=Phaser.Utils.Objects.GetValue,fa=oa.NO_NEWLINE,va=oa.RAW_NEWLINE;var ba=class{constructor(t){this.prop={},this.resetFromJSON(t)}resetFromJSON(t){this.text=ma(t,"text",""),this.x=ma(t,"x",0),this.y=ma(t,"y",0),this.width=ma(t,"width",0);var e=ma(t,"prop",null);null===e&&(e={}),this.prop=e,this.newLineMode=ma(t,"newLineMode",0),this.startIndex=ma(t,"startIndex",0)}get plainText(){var t=this.text;return this.newLineMode===va&&(t+="\n"),t}get wrapText(){var t=this.text;return this.newLineMode!==fa&&(t+="\n"),t}get rawTextLength(){var t=this.text.length;return this.newLineMode===va&&(t+=1),t}get endIndex(){return this.startIndex+this.rawTextLength}get lastX(){return this.x+this.width}get isTextPen(){return""!==this.text}get isImagePen(){return!!this.prop.img}get hasAreaMarker(){return!!this.prop.area}},xa=function(t){if(Array.isArray(t))t.length=0;else for(var e in t)delete t[e]},ya=function(t,e){var i=Array.isArray(t);if(void 0===e?e=i?[]:{}:xa(e),i){e.length=t.length;for(var s=0,n=t.length;s<n;s++)e[s]=t[s]}else for(var r in t)e[r]=t[r];return e},wa=function(){};const ka=Phaser.Utils.Objects.GetFastValue,Ca=oa.NO_NEWLINE,_a=oa.WRAPPED_NEWLINE;var Sa=new ga,Ta=new ga;class Oa{constructor(t){this.pens=[],this.lines=[],this.maxLinesWidth=void 0,this.PensPool=ka(t,"pensPool",Sa),this.LinesPool=ka(t,"linesPool",Ta),this.tagToText=ka(t,"tagToText",wa),this.tagToTextScope=ka(t,"tagToTextScope",void 0)}destroy(){this.freePens(),this.tagToText=void 0,this.tagToTextScope=void 0}freePens(){for(var t=0,e=this.lines.length;t<e;t++)this.lines[t].length=0;this.PensPool.pushMultiple(this.pens),this.LinesPool.pushMultiple(this.lines),this.maxLinesWidth=void 0}addTextPen(t,e,i,s,n,r){var a=this.PensPool.pop();return null==a&&(a=new ba),Ea.text=t,Ea.x=e,Ea.y=i,Ea.width=s,Ea.prop=n,Ea.newLineMode=r,a.resetFromJSON(Ea),this.addPen(a),this}addImagePen(t,e,i,s){return this.addTextPen("",t,e,i,s,Ca),this}addNewLinePen(){var t=this.lastPen,e=t?t.lastX:0,i=t?t.y:0,s=t?ya(t.prop):null;return this.addTextPen("",e,i,0,s,_a),this}addPen(t){var e=this.lastPen;t.startIndex=null==e?0:e.endIndex,this.pens.push(t);var i=this.lastLine;null==i&&(i=this.LinesPool.pop()||[],this.lines.push(i)),i.push(t),t.newLineMode!==Ca&&(i=this.LinesPool.pop()||[],this.lines.push(i)),this.maxLinesWidth=void 0}clone(t){null==t&&(t=new Oa),t.freePens();for(var e=0,i=this.lines.length;e<i;e++)for(var s=this.lines[e],n=0,r=s.length;n<r;n++){var a=s[n];t.addPen(a.text,a.x,a.y,a.width,ya(a.prop),a.newLineMode)}return t}get lastPen(){return this.pens[this.pens.length-1]}get lastLine(){return this.lines[this.lines.length-1]}getLineStartIndex(t){if(t>=this.lines.length)return this.getLineEndIndex(t);var e=this.lines[t];return e&&e[0]?e[0].startIndex:0}getLineEndIndex(t){t>=this.lines.length&&(t=this.lines.length-1);var e,i,s=!1;for(e=t;e>=0&&!(s=null!=(i=this.lines[e])&&i.length>0);e--);return s?i[i.length-1].endIndex:0}getLineWidth(t){var e=this.lines[t];if(!e)return 0;var i=e[e.length-1];return null==i?0:i.lastX}getMaxLineWidth(){if(void 0!==this.maxLinesWidth)return this.maxLinesWidth;for(var t,e=0,i=0,s=this.lines.length;i<s;i++)(t=this.getLineWidth(i))>e&&(e=t);return this.maxLinesWidth=e,e}getLineWidths(){for(var t=[],e=0,i=this.lines.length;e<i;e++)t.push(this.getLineWidth(e));return t}get linesCount(){return this.lines.length}get plainText(){for(var t="",e=this.pens,i=0,s=e.length;i<s;i++)t+=e[i].plainText;return t}get rawTextLength(){for(var t=0,e=this.pens,i=0,s=this.pens.length;i<s;i++)t+=e[i].rawTextLength;return t}getSliceTagText(t,e,i){if(void 0===t&&(t=0),void 0===e){var s=this.lastPen;if(null==s)return"";e=s.endIndex}void 0===i&&(i=!1);for(var n,r,a,o,h,l,d="",c=0,u=this.pens.length;c<u&&((o=(n=this.pens[c]).endIndex)<=t||(n=this.pens[c],r=i?n.wrapText:n.plainText,h=n.prop,(a=n.startIndex)>=t&&o<=e||(r=r.substring(t-a,e-a)),this.tagToTextScope?d+=this.tagToText.call(this.tagToTextScope,r,h,l):d+=this.tagToText(r,h,l),l=h,!(o>=e)));c++);return d}}var Ea={},Pa=Oa;const Ma=Phaser.Geom.Rectangle;var Ia=new ga;var Ba=class{constructor(){this.hitAreas=[]}destroy(){this.clear()}clear(){return Ia.pushMultiple(this.hitAreas),this}add(t,e,i,s,n){var r=Ia.pop();return null===r?r=new Ma(e,i,s,n):r.setTo(e,i,s,n),r.key=t,this.hitAreas.push(r),this}getFirstHitArea(t,e){for(var i,s=this.hitAreas,n=0,r=s.length;n<r;n++)if((i=s[n]).contains(t,e))return i;return null}drawBounds(t,e,i){void 0===e&&(e=16777215),i&&t.save().scaleCanvas(i.scaleX,i.scaleY).rotateCanvas(i.rotation).translateCanvas(i.x,i.y);for(var s,n=this.hitAreas,r=0,a=n.length;r<a;r++)s=n[r],t.lineStyle(1,e).strokeRect(s.x,s.y,s.width,s.height);return i&&t.restore(),this}},ja=function(t,e,i,s){var n=this.hitAreaManager.getFirstHitArea(i,s);if(null!==n){var r=n.key;this.parent.emit(`${t}-${r}`,e,i,s),this.parent.emit(t,r,e,i,s)}},za=function(){this.parent.on("pointerdown",(function(t,e,i,s){ja.call(this,"areadown",t,e,i)}),this).on("pointerup",(function(t,e,i,s){ja.call(this,"areaup",t,e,i)}),this)};const Da=oa.NO_NEWLINE,La=oa.RAW_NEWLINE,Ra=oa.WRAPPED_NEWLINE,Ua=oa.NO_WRAP,Fa=oa.WORD_WRAP,Wa=oa.SPLITREGEXP;var Ya=[],Aa=new ga;Aa.newline=function(t,e,i){var s=this.pop();return null===s&&(s={}),s.text=t,s.width=e,s.newLineMode=i,s};var Ha=function(t,e,i,s,n){s<=0&&(i=Ua);var r=Ya;if(Aa.pushMultiple(r),!t||!t.length)return r;for(var a,o,h,l=t.split(Wa),d=0,c=l.length;d<c;d++)if(a=l[d],h=d===c-1?Da:La,i!==Ua){var u,p;if(o=0===d?s-n:s,a.length<=100)if((y=e(a))<=o){r.push(Aa.newline(a,y,h));continue}for(var g,m="",f="",v=0,b=0,x=(u=i===Fa?a.split(" "):a).length;b<x;b++)p=u[b],i===Fa?(m+=p,b<x-1&&(m+=" ")):m+=p,(g=e(m))>o&&(0===b?r.push(Aa.newline("",0,Ra)):(r.push(Aa.newline(f,v,Ra)),m=p,i===Fa&&b<x-1&&(m+=" "),g=e(m)),o=s),f=m,v=g;r.push(Aa.newline(f,v,h))}else{var y=e(a);r.push(Aa.newline(a,y,h))}return r};const Va=Phaser.Utils.Objects.GetValue,Na=oa.NO_WRAP,Ga=oa.NO_NEWLINE;class Xa{constructor(t){this.parent=t.parent,this.context=Va(t,"context",null),this.canvas=this.context.canvas,this.parser=Va(t,"parser",null),this.defatultStyle=Va(t,"style",null),this.autoRound=!0,this.pensPool=Va(t,"pensPool",null),this.penManager=this.newPenManager(),this._tmpPenManager=null,this.hitAreaManager=new Ba;var e=this.context;this.getTextWidth=function(t){return e.measureText(t).width}}destroy(){this.context=void 0,this.canvas=void 0,this.parser=void 0,this.defatultStyle=void 0,this.penManager&&(this.penManager.destroy(),this.penManager=void 0),this._tmpPenManager&&(this._tmpPenManager.destroy(),this._tmpPenManager=void 0),this.hitAreaManager&&(this.hitAreaManager.destroy(),this.hitAreaManager=void 0)}updatePenManager(t,e,i,s,n){if(void 0===n&&(n=this.penManager),n.freePens(),""===t)return n;for(var r,a,o,h,l,d=this.canvas,c=this.context,u=0,p=0,g=this.parser.splitText(t),m=0,f=g.length;m<f;m++)if(r=(h=this.parser.tagTextToProp(g[m],a)).plainText,(a=h.prop).img){var v=this.imageManager.getOuterWidth(a.img);i>0&&e!==Na&&i<u+v&&(n.addNewLinePen(),p+=s,u=0),n.addImagePen(u,p,v,ya(a)),u+=v}else if(""!==r){var b;this.context.save(),(o=this.parser.propToContextStyle(this.defatultStyle,a)).buildFont(),o.syncFont(d,c),o.syncStyle(d,c);for(var x=0,y=(l=Ha(r,this.getTextWidth,e,i,u)).length;x<y;x++)b=l[x],n.addTextPen(b.text,u,p,b.width,ya(a),b.newLineMode),b.newLineMode!==Ga?(u=0,p+=s):u+=b.width;this.context.restore()}return n}get startXOffset(){return this.defatultStyle.strokeThickness/2}get startYOffset(){var t=this.defatultStyle;return t.strokeThickness/2+t.metrics.ascent}get lines(){return this.penManager.lines}get desplayLinesCount(){var t=this.penManager.linesCount,e=this.defatultStyle.maxLines;return e>0&&t>e&&(t=e),t}get linesWidth(){return this.penManager.getMaxLineWidth()}get linesHeight(){var t=this.desplayLinesCount,e=this.defatultStyle.lineHeight*t;return t>0&&(e-=this.defatultStyle.lineSpacing),e}get imageManager(){return this.parent.imageManager}newPenManager(){return new Pa({pensPool:this.pensPool,tagToText:this.parser.propToTagText,tagToTextScope:this.parser})}get tmpPenManager(){return null===this._tmpPenManager&&(this._tmpPenManager=this.newPenManager()),this._tmpPenManager}getPlainText(t,e,i){var s;if(null==t)s=this.penManager.plainText;else{var n=this.parser.splitText(t,1);s="";for(var r=0,a=n.length;r<a;r++)s+=n[r]}return null==e&&null==i||(null==e&&(e=0),null==i&&(i=s.length),s=s.substring(e,i)),s}getPenManager(t,e){if(void 0===t)return this.copyPenManager(e,this.penManager);void 0===e&&(e=this.newPenManager());var i=this.defatultStyle;return this.updatePenManager(t,i.wrapMode,i.wrapWidth,i.lineHeight,e),e}getText(t,e,i,s){if(null==t)return this.penManager.getSliceTagText(e,i,s);var n=this.tmpPenManager,r=this.defatultStyle;return this.updatePenManager(t,r.wrapMode,r.wrapWidth,r.lineHeight,n),n.getSliceTagText(e,i,s)}copyPenManager(t,e){return void 0===e&&(e=this.penManager),e.copy(t)}getTextWidth(t){return void 0===t&&(t=this.penManager),t.getMaxLineWidth()}getLastPen(t){return void 0===t&&(t=this.penManager),t.lastPen}}var Ja={setInteractive:za};Object.assign(Xa.prototype,pa,Ja);var Ka=Xa;const Za=Phaser.Utils.Objects.GetValue;var qa,$a=class{constructor(t){this.textureManager=t,this.images={}}add(t,e){if("string"==typeof t)this._add(t,e);else if(Array.isArray(t))for(var i=0,s=(n=t).length;i<s;i++)this._add(n[i]);else{var n=t;for(var t in n)this._add(t,n[t])}return this}_add(t,e){void 0===e&&(e={key:t});var i=e.key,s=e.frame,n=e.width,r=e.height;if(void 0===n||void 0===r){var a=this.textureManager.getFrame(i,s),o=a?a.cutWidth:0,h=a?a.cutHeight:0;void 0===n&&void 0===r?(n=o,r=h):void 0===n?n=o*(r/h):void 0===r&&(r=h*(n/o))}this.images[t]={key:i,frame:s,width:n,height:r,y:Za(e,"y",0),left:Za(e,"left",0),right:Za(e,"right",0)}}remove(t){return this.images.hasOwnProperty(t)&&delete this.images[t],this}get(t){return this.images.hasOwnProperty(t)||this.textureManager.exists(t)&&this.add(t),this.images[t]}getOuterWidth(t){var e=this.get(t);return e?e.width+e.left+e.right:0}getFrame(t){var e=this.get(t);return e?this.textureManager.getFrame(e.key,e.frame):void 0}hasTexture(t){return!!this.getFrame(t)}};const Qa=Phaser.Utils.Objects.IsPlainObject,to=Phaser.DOM.AddToDOM,eo=Phaser.Display.Canvas.CanvasPool,io=Phaser.GameObjects.GameObject,so=Phaser.Utils.Objects.GetValue,no=Phaser.DOM.RemoveFromDOM,ro=oa.SPLITREGEXP;var ao={};class oo extends io{constructor(t,e,i,s,n,r,a){if(Qa(e)){var o=e;e=so(o,"x",0),i=so(o,"y",0),s=so(o,"text",""),n=so(o,"style","")}if(void 0===e&&(e=0),void 0===i&&(i=0),super(t,r),this.renderer=t.sys.game.renderer,this.setPosition(e,i),this.setOrigin(0,0),this.initPipeline(),this.canvas=eo.create(this),this.context=this.canvas.getContext("2d"),n){if(n.hasOwnProperty("align")){var h=n.align;delete n.align,n.halign=h}n.hasOwnProperty("stroke")&&!n.hasOwnProperty("strokeThickness")&&(n.strokeThickness=1)}this.style=new ua(this,n),this.autoRound=!0,this._text=void 0,this.padding={left:0,right:0,top:0,bottom:0},this.width=1,this.height=1,this.dirty=!1,0===this.style.resolution&&(this.style.resolution=1),this._crop=this.resetCropObject(),this.texture=t.sys.textures.addCanvas(null,this.canvas,!0),this.frame=this.texture.get(),this.frame.source.resolution=this.style.resolution,this.renderer.gl&&(this.renderer.deleteTexture(this.frame.source.glTexture),this.frame.source.glTexture=null),ao.hasOwnProperty(r)||(ao[r]=new ga),this.canvasText=new Ka({parent:this,context:this.context,parser:a,style:this.style,pensPool:ao[r]}),n&&n.padding&&this.setPadding(n.padding),this.setText(s),t.sys.game.events.on("contextrestored",(function(){this.dirty=!0}),this)}set text(t){this.setText(t)}get text(){return this._text}initRTL(){this.style.rtl&&(this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",to(this.canvas,this.scene.sys.canvas),this.originX=1)}setText(t){return t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t!==this._text&&(this._text=t.toString(),this.updateText()),this}setStyle(t){return this.style.setStyle(t)}setFont(t){return this.style.setFont(t)}setFontFamily(t){return this.style.setFontFamily(t)}setFontSize(t){return this.style.setFontSize(t)}setFontStyle(t){return this.style.setFontStyle(t)}setFixedSize(t,e){return this.style.setFixedSize(t,e)}setBackgroundColor(t){return this.style.setBackgroundColor(t)}setFill(t){return this.style.setFill(t)}setColor(t){return this.style.setColor(t)}setStroke(t,e){return this.style.setStroke(t,e)}setShadow(t,e,i,s,n,r){return this.style.setShadow(t,e,i,s,n,r)}setShadowOffset(t,e){return this.style.setShadowOffset(t,e)}setShadowColor(t){return this.style.setShadowColor(t)}setShadowBlur(t){return this.style.setShadowBlur(t)}setShadowStroke(t){return this.style.setShadowStroke(t)}setShadowFill(t){return this.style.setShadowFill(t)}setWrapMode(t){return this.style.setWrapMode(t)}setWrapWidth(t){return this.style.setWrapWidth(t)}setAlign(t){return this.style.setHAlign(t)}setLineSpacing(t){return this.style.setLineSpacing(t)}setPadding(t,e,i,s){if("object"==typeof t){var n=t,r=so(n,"x",null);null!==r?(t=r,i=r):(t=so(n,"left",0),i=so(n,"right",t));var a=so(n,"y",null);null!==a?(e=a,s=a):(e=so(n,"top",0),s=so(n,"bottom",e))}else void 0===t&&(t=0),void 0===e&&(e=t),void 0===i&&(i=t),void 0===s&&(s=e);return this.padding.left=t,this.padding.top=e,this.padding.right=i,this.padding.bottom=s,this.updateText(!1)}setResolution(t){return this.style.setResolution(t)}setMaxLines(t){return this.style.setMaxLines(t)}updateText(t){void 0===t&&(t=!0);var e=this.canvasText,i=this.style;t&&e.updatePenManager(this._text,i.wrapMode,i.wrapWidth,i.lineHeight);var s,n,r=this.padding;0===i.fixedWidth?(this.width=e.linesWidth+r.left+r.right,s=e.linesWidth):(this.width=i.fixedWidth,(s=this.width-r.left-r.right)<e.linesWidth&&(s=e.linesWidth)),0===i.fixedHeight?(this.height=e.linesHeight+r.top+r.bottom,n=e.linesHeight):(this.height=i.fixedHeight,(n=this.height-r.top-r.bottom)<e.linesHeight&&(n=e.linesHeight));var a=this.width,o=this.height;this.updateDisplayOrigin();var h=i.resolution;a*=h,o*=h,a=Math.max(Math.ceil(a),1),o=Math.max(Math.ceil(o),1);var l=this.canvas,d=this.context;l.width!==a||l.height!==o?(l.width=a,l.height=o,this.frame.setSize(a,o)):d.clearRect(0,0,a,o),d.save(),d.scale(h,h),e.draw(r.left,r.top,s,n),d.restore(),this.renderer.gl&&(this.frame.source.glTexture=this.renderer.canvasToTexture(l,this.frame.source.glTexture,!0),this.frame.glTexture=this.frame.source.glTexture),this.dirty=!0;var c=this.input;return c&&!c.customHitArea&&(c.hitArea.width=this.width,c.hitArea.height=this.height),this}getTextMetrics(){return this.style.getTextMetrics()}toJSON(){var t=ho.ToJSON(this),e={autoRound:this.autoRound,text:this._text,style:this.style.toJSON(),resolution:this.resolution,padding:{left:this.padding.left,right:this.padding.right,top:this.padding.top,bottom:this.padding.bottom}};return t.data=e,t}preDestroy(){this.style.rtl&&no(this.canvas),eo.remove(this.canvas),this.canvasText.destroy()}setInteractive(t,e,i){return io.prototype.setInteractive.call(this,t,e,i),this.canvasText.setInteractive(),this}getWrappedText(t,e,i){return(t=this.canvasText.getText(t,e,i,!0)).split(ro)}getPlainText(t,e,i){return this.canvasText.getPlainText(t,e,i)}getText(t,e,i){return this.canvasText.getText(t,e,i,!1)}getSubString(t,e,i){return this.getText(t,e,i)}copyPenManager(t){return this.canvasText.copyPenManager(t)}getPenManager(t,e){return this.canvasText.getPenManager(t,e)}setSize(t,e){return this.setFixedSize(t,e)}resize(t,e){return this.setFixedSize(t,e)}set lineSpacing(t){this.setLineSpacing(t)}get lineSpacing(){return this.style.lineSpacing}get imageManager(){return t=this.scene.textures,void 0===qa&&(qa=new $a(t)),qa;var t}addImage(t,e){return this.imageManager.add(t,e),this}drawAreaBounds(t,e){return this.canvasText.hitAreaManager.drawBounds(t,e,this),this}}const ho=Phaser.GameObjects.Components;Phaser.Class.mixin(oo,[ho.Alpha,ho.BlendMode,ho.ComputedSize,ho.Crop,ho.Depth,ho.Flip,ho.GetBounds,ho.Mask,ho.Origin,ho.Pipeline,ho.ScrollFactor,ho.Tint,ho.Transform,ho.Visible,na]);var lo=oo,co={plainText:null,prevProp:null},uo=new ua,po={},go={splitText:function(t,e){for(var i=[],s=0;;){var n=vo.exec(t);if(!n){var r=t.length;return s<r&&i.push(t.substring(s,r)),i}var a=n[0],o=vo.lastIndex-a.length;s<o&&i.push(t.substring(s,o)),void 0===e&&i.push(a),s=vo.lastIndex}},tagTextToProp:function(t,e){var i,s;null==e&&(e={}),e.img&&mo(e,Uo,"img"),bo.test(t)?(mo(e,Fo,"b",!0),i=""):xo.test(t)?(mo(e,Uo,"b"),i=""):yo.test(t)?(mo(e,Fo,"i",!0),i=""):wo.test(t)?(mo(e,Uo,"i"),i=""):ko.test(t)?(s=t.match(ko),mo(e,Fo,"size",s[1]+"px"),i=""):Co.test(t)?(mo(e,Uo,"size"),i=""):_o.test(t)?(s=t.match(_o),mo(e,Fo,"color",s[1]),i=""):So.test(t)?(mo(e,Uo,"color"),i=""):To.test(t)?(s=t.match(To),mo(e,Fo,"u",!0),i=""):Oo.test(t)?(s=t.match(Oo),mo(e,Fo,"u",s[1]),i=""):Eo.test(t)?(mo(e,Uo,"u"),i=""):Po.test(t)?(mo(e,Fo,"shadow",!0),i=""):Mo.test(t)?(mo(e,Uo,"shadow"),i=""):Io.test(t)?(mo(e,Fo,"stroke",!0),i=""):Bo.test(t)?(s=t.match(Bo),mo(e,Fo,"stroke",s[1]),i=""):jo.test(t)?(mo(e,Uo,"stroke"),i=""):zo.test(t)?(s=t.match(zo),mo(e,Fo,"img",s[1]),i=""):Do.test(t)?(mo(e,Uo,"img"),i=""):Lo.test(t)?(s=t.match(Lo),mo(e,Fo,"area",s[1]),i=""):Ro.test(t)?(mo(e,Uo,"area"),i=""):i=t;var n=co;return n.plainText=i,n.prop=e,n},propToContextStyle:function(t,e){var i=uo;if(e.hasOwnProperty("img"))i.image=e.img;else{if(i.image=null,e.hasOwnProperty("family")?i.fontFamily=e.family:i.fontFamily=t.fontFamily,e.hasOwnProperty("size")){var s=e.size;"number"==typeof s&&(s=s.toString()+"px"),i.fontSize=s}else i.fontSize=t.fontSize;i.fontStyle=fo(e.b,e.i),e.hasOwnProperty("color")?i.color=e.color:i.color=t.color,e.hasOwnProperty("stroke")?!0===e.stroke?(i.stroke=t.stroke,i.strokeThickness=t.strokeThickness):(i.stroke=e.stroke,i.strokeThickness=t.strokeThickness):(i.stroke=t.stroke,i.strokeThickness=0)}return e.hasOwnProperty("shadow")?!0===e.shadow?(i.shadowColor=t.shadowColor,i.shadowOffsetX=t.shadowOffsetX,i.shadowOffsetY=t.shadowOffsetY,i.shadowBlur=t.shadowBlur,i.shadowStroke=!0,i.shadowFill=!0):(i.shadowColor=e.shadow,i.shadowOffsetX=t.shadowOffsetX,i.shadowOffsetY=t.shadowOffsetY,i.shadowBlur=t.shadowBlur,i.shadowStroke=!0,i.shadowFill=!0):(i.shadowColor="#000",i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=0,i.shadowStroke=!1,i.shadowFill=!1),e.hasOwnProperty("u")?!0===e.u?(i.underlineColor=t.underlineColor,i.underlineThickness=t.underlineThickness,i.underlineOffset=t.underlineOffset):(i.underlineColor=e.u,i.underlineThickness=t.underlineThickness,i.underlineOffset=t.underlineOffset):(i.underlineColor="#000",i.underlineThickness=0,i.underlineOffset=0),i},propToTagText:function(t,e,i){for(var s in null==i&&(i=po),i)e.hasOwnProperty(s)||(t="[/"+s+"]"+t);var n="";for(var s in e)i[s]!==e[s]&&("size"===s?n+="[size="+e[s].replace("px","")+"]":"color"===s||"stroke"===s||"img"===s?n+="["+s+"="+e[s]+"]":"u"===s?!0===e[s]?n+="[u]":n+="[u="+e[s]+"]":n+="["+s+"]");return t=n+t}},mo=function(t,e,i,s){return e===Fo?t[i]=s:t.hasOwnProperty(i)&&delete t[i],t},fo=function(t,e){return t&&e?"bold italic":t?"bold":e?"italic":""},vo=/\[b\]|\[\/b\]|\[i\]|\[\/i\]|\[size=(\d+)\]|\[\/size\]|\[color=([a-z]+|#[0-9abcdef]+)\]|\[\/color\]|\[u\]|\[u=([a-z]+|#[0-9abcdef]+)\]|\[\/u\]|\[shadow\]|\[\/shadow\]|\[stroke\]|\[stroke=([a-z]+|#[0-9abcdef]+)\]|\[\/stroke\]|\[img=([^\]]+)\]|\[\/img\]|\[area=([^\]]+)\]|\[\/area\]/gi,bo=/\[b\]/i,xo=/\[\/b\]/i,yo=/\[i\]/i,wo=/\[\/i\]/i,ko=/\[size=(\d+)\]/i,Co=/\[\/size\]/i,_o=/\[color=([a-z]+|#[0-9abcdef]+)\]/i,So=/\[\/color\]/i,To=/\[u\]/i,Oo=/\[u=([a-z]+|#[0-9abcdef]+)\]/i,Eo=/\[\/u\]/i,Po=/\[shadow\]/i,Mo=/\[\/shadow\]/i,Io=/\[stroke\]/i,Bo=/\[stroke=([a-z]+|#[0-9abcdef]+)\]/i,jo=/\[\/stroke\]/i,zo=/\[img=([^\]]+)\]/i,Do=/\[\/img\]/i,Lo=/\[area=([^\]]+)\]/i,Ro=/\[\/area\]/i;const Uo=!1,Fo=!0;var Wo=go;var Yo=class extends lo{constructor(t,e,i,s,n){super(t,e,i,s,n,"rexBBCodeText",Wo)}};zr.register("BBCodeText",(function(t,e,i,s){var n=new Yo(this.scene,t,e,i,s);return this.scene.add.existing(n),n})),Qr(window,"RexPlugins.UI.BBCodeText",Yo);var Ao={plainText:null,prevProp:null},Ho=new ua;var Vo=function(t){for(var e,i,s,n={},r=0,a=(t=t.split(";")).length;r<a;r++)if(i=(e=t[r].split(":"))[0],s=e[1],!No(i)&&!No(s)){switch(i){case"stroke":var o=s.split(" ");s={},(l=o.length)>=1&&(s.color=o[0]),l>=2&&(s.thinkness=parseInt(o[1].replace("px","")));break;case"shadow":var h=s.split(" ");s={},(l=h.length)>=1&&(s.color=h[0]),l>=2&&(s.offsetX=parseInt(h[1].replace("px",""))),l>=3&&(s.offsetY=parseInt(h[2].replace("px",""))),l>=4&&(s.blur=parseInt(h[3].replace("px","")));break;case"u":case"underline":var l,d=s.split(" ");s={},(l=d.length)>=1&&(s.color=d[0]),l>=2&&(s.thinkness=parseInt(d[1].replace("px",""))),l>=3&&(s.offset=parseInt(d[2].replace("px","")))}n[i]=s}return n},No=function(t){return 0===(t=t.replace(qo,"")).length},Go=/<\s*class=["|']([^"|']+)["|']\s*\>([\s\S]*?)<\s*\/class\s*\>|<\s*style=["|']([^"|']+)["|']\s*\>([\s\S]*?)<\s*\/style\s*\>/g,Xo=/<\s*class=/i,Jo=/<\s*class=["|']([^"|']+)["|']\s*\>([\s\S]*?)<\s*\/class\s*\>/,Ko=/<\s*style=/i,Zo=/<\s*style=["|']([^"|']+)["|']\s*\>([\s\S]*?)<\s*\/style\s*\>/,qo=/^\s+|\s+$/,$o=class{constructor(t){void 0===t&&(t={}),this.tags=t}addTag(t,e){this.tags[t]=e}splitText(t,e){for(var i=[],s=0;;){var n=Go.exec(t);if(!n){var r=t.length;return s<r&&i.push(t.substring(s,r)),i}var a=n[0],o=Go.lastIndex-a.length;if(s<o&&i.push(t.substring(s,o)),void 0===e)i.push(a);else if(1===e)if(Xo.test(a)){var h=a.match(Jo);i.push(h[2])}else if(Ko.test(a)){h=a.match(Zo);i.push(h[2])}s=Go.lastIndex}}tagTextToProp(t,e){var i,s;if(Xo.test(t)){if(null!=(a=t.match(Jo))){var n=a[1],r=this.tags;(s=r.hasOwnProperty(n)?r[n]:{})._class=n,i=a[2]}}else if(Ko.test(t)){var a;if(null!=(a=t.match(Zo))){var o=a[1];(s=Vo(o))._style=o,i=a[2]}}null==i&&(i=t),null==s&&(s={});var h=Ao;return h.plainText=i,h.prop=s,h}propToContextStyle(t,e){var i=Ho;if(e.hasOwnProperty("img"))i.image=e.img;else{if(i.image=null,e.hasOwnProperty("family")||e.hasOwnProperty("fontFamily")||e.hasOwnProperty("font-family")){var s=e.hasOwnProperty("family")?e.family:e.hasOwnProperty("fontFamily")?e.fontFamily:e["font-family"];i.fontFamily=s}else i.fontFamily=t.fontFamily;if(e.hasOwnProperty("size")||e.hasOwnProperty("fontSize")||e.hasOwnProperty("font-size")){var n=e.hasOwnProperty("size")?e.size:e.hasOwnProperty("fontSize")?e.fontSize:e["font-size"];"number"==typeof n&&(n=n.toString()+"px"),i.fontSize=n}else i.fontSize=t.fontSize;if(e.hasOwnProperty("style")||e.hasOwnProperty("fontStyle")||e.hasOwnProperty("font-style")){var r=e.hasOwnProperty("style")?e.style:e.hasOwnProperty("fontStyle")?e.fontStyle:e["font-style"];i.fontStyle=r}else i.fontStyle=t.fontStyle;if(e.hasOwnProperty("color")||e.hasOwnProperty("font-color")){var a=e.hasOwnProperty("color")?e.color:e["font-color"];i.color=a}else i.color=t.color;if(e.hasOwnProperty("stroke")){var o=e.stroke;i.stroke=o.hasOwnProperty("color")?o.color:t.stroke,i.strokeThickness=o.hasOwnProperty("thinkness")?o.thinkness:t.strokeThickness}else i.stroke=t.stroke,i.strokeThickness=t.strokeThickness}if(e.hasOwnProperty("shadow")){var h=e.shadow;i.shadowColor=h.hasOwnProperty("color")?h.color:t.shadowColor,i.shadowOffsetX=h.hasOwnProperty("offsetX")?h.offsetX:t.shadowOffsetX,i.shadowOffsetY=h.hasOwnProperty("offsetY")?h.offsetY:t.shadowOffsetY,i.shadowBlur=h.hasOwnProperty("blur")?h.blur:t.shadowBlur,i.shadowStroke=!0,i.shadowFill=!0}else i.shadowColor=t.shadowColor,i.shadowOffsetX=t.shadowOffsetX,i.shadowOffsetY=t.shadowOffsetY,i.shadowBlur=t.shadowBlur,i.shadowStroke=t.shadowStroke,i.shadowFill=t.shadowFill;if(e.hasOwnProperty("u")||e.hasOwnProperty("underline")){var l=e.hasOwnProperty("u")?e.u:e.underline;i.underlineColor=l.hasOwnProperty("color")?l.color:t.underlineColor,i.underlineThickness=l.hasOwnProperty("thinkness")?l.thinkness:t.underlineThickness,i.underlineOffset=l.hasOwnProperty("offset")?l.offset:t.underlineOffset}else i.underlineColor=t.underlineColor,i.underlineThickness=t.underlineThickness,i.underlineOffset=t.underlineOffset;return i}propToTagText(t,e,i){return e.hasOwnProperty("_class")?""===t&&this.isTextTag(e._class)?"":"<class='"+e._class+"'>"+t+"</class>":e.hasOwnProperty("_style")?"<style='"+e._style+"'>"+t+"</style>":void 0}destroy(){this.tags=void 0}isTextTag(t){var e=this.tags[t];return!!e&&null==e.img}};const Qo=Phaser.Utils.Objects.GetValue;var th=class extends lo{constructor(t,e,i,s,n){var r=Qo(n,"tags",void 0),a=new $o(r);super(t,e,i,s,n,"rexTagText",a),this.parser=a}addTag(t,e){return this.parser.addTag(t,e),this.updateText(!0)}addTags(t){for(var e in t)this.parser.addTag(e,t[e]);return this.updateText(!0)}preDestroy(){super.preDestroy(),this.parser.destroy(),this.parser=void 0}};zr.register("tagText",(function(t,e,i,s){var n=new th(this.scene,t,e,i,s);return this.scene.add.existing(n),n})),Qr(window,"RexPlugins.UI.TagText",th);const eh=Phaser.GameObjects.Zone,ih=Phaser.Utils.Array.Add,sh=Phaser.Utils.Array.Remove;class nh extends eh{constructor(t,e,i,s,n){void 0===s&&(s=1),void 0===n&&(n=1),super(t,e,i,s,n),this.children=[]}destroy(t){this.scene&&(this.clear(!t),super.destroy(t))}contains(t){return-1!==this.children.indexOf(t)}add(t){return ih(this.children,t,0,(function(t){t.on("destroy",this.remove,this)}),this),this}remove(t,e){return sh(this.children,t,(function(t){t.off("destroy",this.remove,this),e&&t.destroy()})),this}clear(t){for(var e,i=0,s=this.children.length;i<s;i++)(e=this.children[i]).off("destroy",this.remove,this),t&&e.destroy();return this.children.length=0,this}}const rh=Phaser.GameObjects.Components;Phaser.Class.mixin(nh,[rh.Alpha,rh.Flip]);var ah=nh,oh=function(t){var e;return t.hasOwnProperty("rexContainer")&&(e=t.rexContainer.parent),e},hh=function(t){for(var e=oh(t);e;)t=e,e=oh(e);return t},lh={setParent(t,e){void 0===e&&(e=this);var i=this.getLocalState(t);return e?(i.parent=e,i.self=t):(i.parent=null,i.self=null),this},getParent(t){return void 0===t&&(t=this),oh(t)},getTopmostParent(t){return void 0===t&&(t=this),hh(t)}};const dh=ah.prototype.add;var ch=function(t){return this.setParent(t),this.resetChildState(t).updateChildVisible(t).updateChildActive(t).updateChildScrollFactor(t).updateChildMask(t),dh.call(this,t),this},uh=function(t){this.setParent(t);var e=this.getLocalState(t);return e.x=t.x,e.y=t.y,e.rotation=t.rotation,e.scaleX=t.scaleX,e.scaleY=t.scaleY,e.flipX=t.flipX,e.flipY=t.flipY,e.alpha=t.alpha,e.visible=t.visible,e.active=t.active,this.updateChildPosition(t).updateChildAlpha(t).updateChildVisible(t).updateChildActive(t).updateChildScrollFactor(t).updateChildMask(t),dh.call(this,t),this},ph={add(t){return Array.isArray(t)?this.addMultiple(t):ch.call(this,t),this},addMultiple(t){for(var e=0,i=t.length;e<i;e++)ch.call(this,t[e]);return this},addLocal(t){return Array.isArray(t)?this.addMultiple(t):uh.call(this,t),this},addLocalMultiple(t){for(var e=0,i=t.length;e<i;e++)uh.call(this,t[e]);return this}};const gh=ah.prototype.remove,mh=ah.prototype.clear;var fh={remove(t,e){return this.getParent(t)!==this||(this.setParent(t,null),gh.call(this,t,e)),this},clear(t){for(var e=0,i=this.children.length;e<i;e++)this.setParent(this.children[e],null);return mh.call(this,t),this}},vh={getLocalState:t=>(t.hasOwnProperty("rexContainer")||(t.rexContainer={}),t.rexContainer),resetChildState(t){return this.resetChildPositionState(t).resetChildVisibleState(t).resetChildAlphaState(t).resetChildActiveState(t),this},resetChildrenState(t){for(var e=0,i=t.length;e<i;e++)this.resetChildState(t[e]);return this},syncProperties(){return this.syncPosition().syncVisible().syncAlpha().syncActive().syncScrollFactor().syncMask(),this}};const bh=Phaser.Math.RotateAround;var xh={worldToLocal(t){return t.x-=this.x,t.y-=this.y,bh(t,0,0,-this.rotation),t.x/=this.scaleX,t.y/=this.scaleY,t.x*=this.flipX?-1:1,t.y*=this.flipY?-1:1,t},localToWorld(t){return t.x*=this.flipX?-1:1,t.y*=this.flipY?-1:1,t.x*=this.scaleX,t.y*=this.scaleY,bh(t,0,0,this.rotation),t.x+=this.x,t.y+=this.y,t}},yh=function(t,e){return t===e?1:t/e},wh={updateChildPosition(t){t.isRexContainerLite&&(t.syncChildrenEnable=!1);var e=this.getLocalState(t);return t.x=e.x,t.y=e.y,this.localToWorld(t),t.scaleX=e.scaleX*this.scaleX,t.scaleY=e.scaleY*this.scaleY,void 0!==t.flipX&&(t.flipX=this.flipX?!e.flipX:e.flipX,t.flipY=this.flipY?!e.flipY:e.flipY),t.rotation=e.rotation+this.rotation,t.isRexContainerLite&&(t.syncChildrenEnable=!0,t.syncPosition()),this},syncPosition(){return this.syncChildrenEnable&&this.children.forEach(this.updateChildPosition,this),this},resetChildPositionState(t){var e=this.getLocalState(t);return e.x=t.x,e.y=t.y,this.worldToLocal(e),e.scaleX=yh(t.scaleX,this.scaleX),e.scaleY=yh(t.scaleY,this.scaleY),void 0!==t.flipX&&(e.flipX=t.flipX,e.flipY=t.flipY),e.rotation=t.rotation-this.rotation,this},setChildPosition(t,e,i){return t.x=e,t.y=i,this.resetChildPositionState(t),this},setChildLocalPosition(t,e,i){var s=this.getLocalState(t);return s.x=e,s.y=i,this.updateChildPosition(t),this}},kh={updateChildVisible(t){var e=this.getLocalState(t),i=!e.hasOwnProperty("maskVisible")||e.maskVisible;return t.visible=this.visible&&e.visible&&i,this},syncVisible(){return this.syncChildrenEnable&&this.children.forEach(this.updateChildVisible,this),this},resetChildVisibleState(t){var e=this.getLocalState(t);return e.hasOwnProperty("maskVisible")&&delete e.maskVisible,e.visible=t.visible,this},setChildVisible(t,e){return this.setChildLocalVisible(t,e),this},setChildLocalVisible(t,e){return void 0===e&&(e=!0),this.getLocalState(t).visible=e,this.updateChildVisible(t),this},setChildMaskVisible(t,e){return void 0===e&&(e=!0),this.getLocalState(t).maskVisible=e,this.updateChildVisible(t),this}},Ch={updateChildAlpha(t){return t.alpha=this.alpha*this.getLocalState(t).alpha,this},syncAlpha(){return this.syncChildrenEnable&&this.children.forEach(this.updateChildAlpha,this),this},resetChildAlphaState(t){return this.getLocalState(t).alpha=yh(t.alpha,this.alpha),this},setChildAlpha(t,e){return t.alpha=e,this.resetChildAlphaState(t),this._add},setChildLocalAlpha(t,e){return this.getLocalState(t).alpha=e,this.updateChildAlpha(t),this}},_h={updateChildActive(t){return t.active=this.active&&this.getLocalState(t).active,this},syncActive(){return this.syncChildrenEnable&&this.children.forEach(this.updateChildActive,this),this},resetChildActiveState(t){return this.getLocalState(t).active=t.active,this},setChildActive(t,e){return t.active=e,this.resetChildActiveState(t),this},setChildLocalActive(t,e){return void 0===e&&(e=!0),this.getLocalState(t).active=e,this.updateChildActive(t),this}},Sh={updateChildScrollFactor(t){return t.setScrollFactor(this.scrollFactorX,this.scrollFactorY),this},syncScrollFactor(){return this.syncChildrenEnable&&this.children.forEach(this.updateChildScrollFactor,this),this}},Th={updateChildMask(t){return null==this.mask||(this.mask.hasOwnProperty("geometryMask")?this.mask.geometryMask:this.mask.bitmapMask)!==t&&(t.mask=this.mask),this},syncMask(){return this.syncChildrenEnable&&this.children.forEach(this.updateChildMask,this),this},setMask(t){return this.mask=t,this},clearMask(t){return void 0===t&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this}},Oh={setDepth(t,e){if(this.depth=t,!e&&this.children)for(var i=this.getAllChildren(),s=0,n=i.length;s<n;s++)i[s].depth=t;return this},swapDepth(t){var e=this.depth,i=t.depth;return this.setDepth(i),t.setDepth(e),this},incDepth(t){if(this.depth+=t,this.children)for(var e=this.getAllChildren(),i=0,s=e.length;i<s;i++)e[i].depth+=t;return this}};const Eh=Phaser.Utils.Array;var Ph={getChildren(){return this.children},getAllChildren(t){void 0===t&&(t=[]);for(var e,i=this.children,s=0,n=i.length;s<n;s++)e=i[s],t.push(e),e.hasOwnProperty("isRexContainerLite")&&t.push(...e.getAllChildren());return t},getAllVisibleChildren(t){void 0===t&&(t=[]);for(var e,i=this.children,s=0,n=i.length;s<n;s++)(e=i[s]).visible&&(t.push(e),e.hasOwnProperty("isRexContainerLite")&&t.push(...e.getAllVisibleChildren()));return t},contains(t){var e=this.getParent(t);return!!e&&(e===this||this.contains(e))},getByName(t,e){if(e){for(var i,s,n=[this];n.length;)for(var r=0,a=(i=n.shift()).children.length;r<a;r++){if((s=i.children[r]).name===t)return s;s.isRexContainerLite&&n.push(s)}return null}return Eh.GetFirst(this.children,"name",t)},getRandom(t,e){return Eh.GetRandom(this.children,t,e)},getFirst(t,e,i,s){return Eh.GetFirstElement(this.children,t,e,i,s)},getAll(t,e,i,s){return Eh.GetAll(this.children,t,e,i,s)},count(t,e,i,s){return Eh.CountAllMatching(this.children,t,e,i,s)},swap(t,e){return Eh.Swap(this.children,t,e),this},moveTo(t,e){return Eh.MoveTo(this.children,t,e),this},setAll(t,e,i,s){return Eh.SetAll(this.children,t,e,i,s),this}},Mh=function(t){return"[object Array]"===Object.prototype.toString.call(t)},Ih={tweenChild(t){var e=t.targets;Mh(e)||(e=[e]);for(var i,s,n=[],r=0,a=e.length;r<a;r++)(s=e[r]).hasOwnProperty("rexContainer")&&(i=s.scene,n.push(s.rexContainer));if(i){t.targets=n;var o=i.tweens.add(t);return o.on("update",(function(t,e,i){for(var s,n,r=0,a=i.length;r<a;r++)switch(s=i.parent,n=i.self,e){case"x":case"y":case"angle":case"rotation":case"scaleX":case"scaleY":case"flipX":case"flipY":s.updateChildPosition(n);break;case"alpha":s.updateChildAlpha(n)}})),o}},tween(t){var e=this.scene;return t.targets||(t.targets=this),e.tweens.add(t)}},Bh={};Object.assign(Bh,lh,ph,fh,vh,xh,wh,kh,Ch,_h,Sh,Th,Oh,Ph,Ih);var jh=Bh;class zh extends ah{constructor(t,e,i,s,n,r){super(t,e,i,s,n),this.type="rexContainerLite",this.isRexContainerLite=!0,this.syncChildrenEnable=!0,this._active=!0,this._mask=null,this._scrollFactorX=1,this._scrollFactorY=1,r&&this.add(r)}destroy(t){this.scene&&(this.syncChildrenEnable=!1,super.destroy(t))}resize(t,e){return this.setSize(t,e),this}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.syncPosition())}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.syncPosition())}get rotation(){return super.rotation}set rotation(t){this.rotation!==t&&(super.rotation=t,this.syncPosition())}get scaleX(){return super.scaleX}set scaleX(t){this.scaleX!==t&&(super.scaleX=t,this.syncPosition())}get scaleY(){return super.scaleY}set scaleY(t){this.scaleY!==t&&(super.scaleY=t,this.syncPosition())}get flipX(){return super.flipX}set flipX(t){super.flipX!==t&&(super.flipX=t,this.syncPosition())}get flipY(){return super.flipY}set flipY(t){super.flipY!==t&&(super.flipY=t,this.syncPosition())}get visible(){return super.visible}set visible(t){super.visible!==t&&(super.visible=t,this.syncVisible())}get alpha(){return super.alpha}set alpha(t){super.alpha!==t&&(super.alpha=t,this.syncAlpha())}get active(){return this._active}set active(t){this._active!==t&&(this._active=t,this.syncActive())}get mask(){return this._mask}set mask(t){this._mask!==t&&(this._mask=t,this.syncMask())}get scrollFactorX(){return this._scrollFactorX}set scrollFactorX(t){this._scrollFactorX!==t&&(this._scrollFactorX=t,this.syncScrollFactor())}get scrollFactorY(){return this._scrollFactorY}set scrollFactorY(t){this._scrollFactorY!==t&&(this._scrollFactorY=t,this.syncScrollFactor())}get list(){return this.children}}Object.assign(zh.prototype,jh);var Dh=zh,Lh=Dh;zr.register("container",(function(t,e,i,s,n){var r=new Lh(this.scene,t,e,i,s,n);return this.scene.add.existing(r),r})),Qr(window,"RexPlugins.UI.Container",Lh);const Rh=Phaser.Renderer.WebGL.Utils;var Uh={renderWebGL:function(t,e,i,s){if(e.dirty&&(e.updateTexture(),e.dirty=!1),0!==e.width&&0!==e.height){i.addToRenderList(e);var n=e.frame,r=n.width,a=n.height,o=Rh.getTintAppendFloatAlpha,h=t.pipelines.set(this.pipeline,e),l=h.setTexture2D(n.glTexture,e);h.batchTexture(e,n.glTexture,r,a,e.x,e.y,r/e.resolution,a/e.resolution,e.scaleX,e.scaleY,e.rotation,e.flipX,e.flipY,e.scrollFactorX,e.scrollFactorY,e.displayOriginX,e.displayOriginY,0,0,r,a,o(e.tintTopLeft,i.alpha*e._alphaTL),o(e.tintTopRight,i.alpha*e._alphaTR),o(e.tintBottomLeft,i.alpha*e._alphaBL),o(e.tintBottomRight,i.alpha*e._alphaBR),e.tintFill,0,0,i,s,!1,l)}},renderCanvas:function(t,e,i,s){0!==e.width&&0!==e.height&&(i.addToRenderList(e),t.batchSprite(e,e.frame,i,s))}};const Fh=Phaser.Display.Color;var Wh={clear(){return this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.dirty=!0,this},fill(t){return this.context.fillStyle=t,this.context.fillRect(0,0,this.canvas.width,this.canvas.height),this.dirty=!0,this},loadFromURL(t,e){var i=this,s=new Image;return s.onload=function(){i.width!==s.width||i.height!==s.height?i.resize(s.width,s.height):i.clear(),i.context.drawImage(s,0,0),i.updateTexture(),e&&e(),s.onload=null,s.src="",s.remove()},s.src=t,this},loadFromURLPromise(t){var e=this;return new Promise((function(i,s){e.loadFromURL(t,i)}))},getDataURL(t,e){return this.canvas.toDataURL(t,e)},getPixel(t,e,i){void 0===i&&(i=new Fh);var s=this.context.getImageData(t,e,1,1);return i.setTo(s.data[0],s.data[1],s.data[2],s.data[3]),i},setPixel(t,e,i,s,n,r){if("number"!=typeof i){var a=i;i=a.red,s=a.green,n=a.blue,r=a.alpha}void 0===r&&(r=0!==i||0!==s||0!==n?255:0);var o=this.context.createImageData(1,1);return o.data[0]=i,o.data[1]=s,o.data[2]=n,o.data[3]=r,this.context.putImageData(o,t,e),this.dirty=!0,this}},Yh={updateTexture(t,e){t&&(e?t.call(e,this.canvas,this.context):t(this.canvas,this.context)),this.canvas.width===this.frame.width&&this.canvas.height===this.frame.height||this.frame.setSize(this.canvas.width,this.canvas.height),this.renderer.gl&&(this.frame.source.glTexture=this.renderer.canvasToTexture(this.canvas,this.frame.source.glTexture,!0),this.frame.glTexture=this.frame.source.glTexture),this.dirty=!1;var i=this.input;return i&&!i.customHitArea&&(i.hitArea.width=this.width,i.hitArea.height=this.height),this},generateTexture(t,e,i,s,n){var r,a=this.canvas,o=this.scene.sys,h=o.game.renderer;void 0===e&&(e=0),void 0===i&&(i=0),void 0===s?s=a.width:s*=this.resolution,void 0===n?n=a.height:n*=this.resolution;var l=(r=o.textures.exists(t)?o.textures.get(t):o.textures.createCanvas(t,s,n)).getSourceImage();l.width!==s&&(l.width=s),l.height!==n&&(l.height=n);var d=l.getContext("2d");return d.clearRect(0,0,s,n),d.drawImage(a,e,i,s,n),h.gl&&r&&h.canvasToTexture(l,r.source[0].glTexture,!0,0),this},loadTexture(t,e){var i=this.scene.textures.getFrame(t,e);return i?(this.width!==i.cutWidth||this.height!==i.cutHeight?this.resize(i.cutWidth,i.cutHeight):this.clear(),this.context.drawImage(i.source.image,i.cutX,i.cutY,i.cutWidth,i.cutHeight,0,0,this.canvas.width,this.canvas.height),this.dirty=!0,this):this}};const Ah=Phaser.Display.Canvas.CanvasPool,Hh=Phaser.GameObjects.GameObject;class Vh extends Hh{constructor(t,e,i,s,n){void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=1),void 0===n&&(n=1),super(t,"rexCanvas"),this.renderer=t.sys.game.renderer,this.resolution=1,this.canvas=Ah.create(this,this.resolution*s,this.resolution*n),this.context=this.canvas.getContext("2d"),this.dirty=!1,this.setPosition(e,i),this.setSize(s,n),this.setOrigin(.5,.5),this.initPipeline(),this._crop=this.resetCropObject(),this.texture=t.sys.textures.addCanvas(null,this.canvas,!0),this.frame=this.texture.get(),this.frame.source.resolution=this.resolution,this.renderer&&this.renderer.gl&&(this.renderer.deleteTexture(this.frame.source.glTexture),this.frame.source.glTexture=null),this.dirty=!0,t.sys.game.events.on("contextrestored",(function(){this.dirty=!0}),this)}getCanvas(t){return t||(this.dirty=!0),this.canvas}getContext(t){return t||(this.dirty=!0),this.context}needRedraw(){return this.dirty=!0,this}preDestroy(){Ah.remove(this.canvas)}resize(t,e){return this.width===t&&this.height===e||(this.setSize(t,e).updateDisplayOrigin(),t*=this.resolution,e*=this.resolution,t=Math.max(Math.ceil(t),1),e=Math.max(Math.ceil(e),1),this.canvas.width=t,this.canvas.height=e,this.frame.setSize(t,e),this.dirty=!0),this}}const Nh=Phaser.GameObjects.Components;Phaser.Class.mixin(Vh,[Nh.Alpha,Nh.BlendMode,Nh.ComputedSize,Nh.Crop,Nh.Depth,Nh.Flip,Nh.GetBounds,Nh.Mask,Nh.Origin,Nh.Pipeline,Nh.ScrollFactor,Nh.Tint,Nh.Transform,Nh.Visible,Uh,Wh,Yh]);var Gh=Vh,Xh=Gh;zr.register("canvas",(function(t,e,i,s){var n=new Xh(this.scene,t,e,i,s);return this.scene.add.existing(n),n})),Qr(window,"RexPlugins.UI.Canvas",Xh);var Jh=function(t,e,i){var s=Math.floor(e/2),n=Math.floor(i/2);t.arc(s,n,Math.min(s,n),0,2*Math.PI)},Kh=function(t,e,i){var s=Math.floor(e/2),n=Math.floor(i/2);t.ellipse(s,n,s,n,0,0,2*Math.PI)};const Zh=Phaser.Math.DegToRad,qh=Zh(0),$h=Zh(90),Qh=Zh(180),tl=Zh(270);var el=function(t){return 0!==t.x&&0!==t.y},il=function(t,e,i,s){void 0===s&&(s=Math.min(Math.floor(e/2),Math.floor(i/2)));var n,r,a,o=new Rr(0,0,e,i,s),h=o.cornerRadius;n=h.br,r=o.width-n.x,a=o.height-n.y,el(n)?t.ellipse(r,a,n.x,n.y,0,qh,$h):(t.moveTo(o.width,a),t.lineTo(o.width,o.height),t.lineTo(r,o.height)),r=(n=h.bl).x,a=o.height-n.y,t.lineTo(n.x,o.height),el(n)?t.ellipse(r,a,n.x,n.y,0,$h,Qh):(t.lineTo(0,o.height),t.lineTo(0,a)),r=(n=h.tl).x,a=n.y,t.lineTo(0,a),el(n)?t.ellipse(r,a,n.x,n.y,0,Qh,tl):(t.lineTo(0,0),t.lineTo(r,0)),n=h.tr,r=o.width-n.x,a=n.y,t.lineTo(r,0),el(n)?t.ellipse(r,a,n.x,n.y,0,tl,qh):(t.lineTo(o.width,0),t.lineTo(o.width,a)),t.closePath()};const sl=Phaser.Utils.Objects.GetValue;const nl={circle:0,ellipse:1,roundRectangle:2};var rl=class extends Gh{constructor(t,e,i,s,n,r){super(t,e,i),this.type="rexCircleMaskImage",this.setTexture(s,n,r)}setTexture(t,e,i){var s,n;if("object"==typeof e&&(i=e,e=void 0),"string"==typeof i?(s=i,n=void 0):(s=sl(i,"maskType",0),n=sl(i,"backgroundColor",void 0)),void 0===s?s=0:"string"==typeof s&&(s=nl[s]),this._textureKey=t,this._frameName=e,null===s)return this.loadTexture(t,e),this.dirty=!0,this;var r=null!=n;r||this.loadTexture(t,e);var a=this.canvas,o=this.context,h=a.width,l=a.height;switch(o.save(),o.globalCompositeOperation=r?"source-over":"destination-in",o.beginPath(),s){case 0:Jh(o,h,l);break;case 1:Kh(o,h,l);break;case 2:var d=sl(i,"radius",void 0);il(o,h,l,d)}return r&&(o.fillStyle=n),o.fill(),o.restore(),r&&(o.save(),o.globalCompositeOperation="destination-atop",this.loadTexture(t,e),o.restore()),this.dirty=!0,this}};zr.register("circleMaskImage",(function(t,e,i,s,n){var r=new rl(this.scene,t,e,i,s,n);return this.scene.add.existing(r),r})),Qr(window,"RexPlugins.UI.CircleMaskImage",rl);var al=function(t,e){void 0===e&&(e={}),void 0===e.options&&(e.options={});var i=e.options;i.responsive=!1,i.maintainAspectRatio=!1,i.hasOwnProperty("devicePixelRatio")||(i.devicePixelRatio=1);var s=!1;void 0===i.animation?i.animation={}:!1===i.animation&&(s=!0,i.animation={});var n=i.animation;s&&(n.duration=0);var r=n.onProgress;n.onProgress=function(e){r&&r(e),t.needRedraw()};var a=n.onComplete;return n.onComplete=function(e){a&&a(e),t.needRedraw()},e},ol=function(t){if(!window.Chart){return this}return this.chart&&this.chart.destroy(),this.chart=new Chart(this.context,al(this,t)),this},hl=function(t){if(void 0!==this.chart){if("string"!=typeof t)return this.chart.data.datasets[t];for(var e,i=this.chart.data.datasets,s=0,n=i.length;s<n;s++)if((e=i[s]).label===t)return e}},ll=function(t,e){var i=this.getChartDataset(t);if(void 0!==i){if("string"==typeof e)if(-1===(e=this.chart.data.labels.indexOf(e)))return;return i.data[e]}},dl=function(t,e,i){if(void 0===this.chart)return this;var s=this.getChartDataset(t);if("string"==typeof e&&-1===(e=this.chart.data.labels.indexOf(e)))return this;return s.data[e]=i,this},cl=function(){if(void 0===this.chart)return this;this.chart.update()};class ul extends Xh{constructor(t,e,i,s,n,r){super(t,e,i,s,n),this.type="rexChart",this.chart=void 0,void 0!==r&&this.setChart(r)}destroy(t){this.scene&&(this.chart&&(this.chart.destroy(),this.chart=void 0),super.destroy(t))}resize(t,e){if(t===this.width&&e===this.height)return this;if(super.resize(t,e),this.chart){var i=this.chart;i.height=this.canvas.height,i.width=this.canvas.width,i.aspectRatio=i.height?i.width/i.height:null,i.update()}return this}}var pl={setChart:ol,getChartDataset:hl,getChartData:ll,setChartData:dl,updateChart:cl};Object.assign(ul.prototype,pl);var gl=ul;zr.register("chart",(function(t,e,i,s,n){var r=new gl(this.scene,t,e,i,s,n);return this.scene.add.existing(r),r})),Qr(window,"RexPlugins.UI.Chart",gl);var ml=function(t,e,i,s){Mh(e)&&(s=i,i=e,e=void 0),void 0===e&&(e="__BASE"),this.textureKey=t,this.baseFrameName=e,this.columns.data=i,this.columns.count=i?i.length:0,this.columns.stretch=0,this.columns.minWidth=0,this.rows.data=s,this.rows.count=s?s.length:0,this.rows.stretch=0,this.rows.minHeight=0;var n=this.scene.textures.get(t);if(!n)return this.clear(),this;if(!i||!s)return this.clear(),this;for(var r=n.frames[e],a=r.width,o=0,h=0,l=i.length;h<l;h++)void 0===i[h]?o++:"number"==typeof i[h]?a-=i[h]:a-=i[h].width;var d=a/o,c=r.height,u=0;for(h=0,l=s.length;h<l;h++)void 0===s[h]?u++:"number"==typeof s[h]?c-=s[h]:c-=s[h].width;for(var p,g,m,f,v,b=c/u,x=0,y=0,w=0,k=s.length;w<k;w++){void 0===s[w]&&(s[w]=b),"number"==typeof s[w]&&(s[w]={height:s[w],stretch:w%2}),m=(p=s[w]).height,this.rows.stretch+=0|p.stretch,this.rows.minHeight+=p.stretch>0?0:m,x=0;h=0;for(var C=i.length;h<C;h++)void 0===i[h]&&(i[h]=d),"number"==typeof i[h]&&(i[h]={width:i[h],stretch:h%2}),f=(g=i[h]).width,0===w&&(this.columns.stretch+=0|g.stretch,this.columns.minWidth+=g.stretch>0?0:f),f>=1&&m>=1&&(v=this.getFrameNameCallback(h,w,e))&&n.add(v,0,x+r.cutX,y+r.cutY,f,m),x+=f;y+=m}return this.updateTexture(),this},fl=function(t,e,i){return void 0===i&&(i="image"),t[e]||(t[e]=t.scene.make[i]({add:!1,origin:{x:0,y:0}}),t.on("destroy",(function(){t[e]&&(t[e].destroy(),t[e]=void 0)}))),t[e]},vl=function(){if(this.clear(),void 0===this.textureKey)return this;var t=this.scene.textures.get(this.textureKey);if(!t)return this;var e,i,s=this.width-this.columns.minWidth;s>=0?(e=this.columns.stretch>0?s/this.columns.stretch:0,i=1):(e=0,i=this.width/this.columns.minWidth);var n,r,a,o,h,l,d,c=this.height-this.rows.minHeight;c>=0?(n=this.rows.stretch>0?c/this.rows.stretch:0,r=1):(n=0,r=this.height/this.rows.minHeight);for(var u,p=0,g=0,m=0,f=this.rows.count;m<f;m++){d=0===(h=this.rows.data[m]).stretch?h.height*r:n*h.stretch,p=0;for(var v=0,b=this.columns.count;v<b;v++)l=0===(o=this.columns.data[v]).stretch?o.width*i:e*o.stretch,(a=this.getFrameNameCallback(v,m,this.baseFrameName))&&l>0&&d>0&&t.has(a)&&(0===(0===h.stretch&&0===o.stretch||0===this.getStretchMode(v,m)?0:1)?(u=fl(this,"_image","image")).setTexture(this.textureKey,a).setDisplaySize(l,d):(u=fl(this,"_tileSprite","tileSprite")).setTexture(this.textureKey,a).setSize(l,d)),u&&(this.draw(u,p,g),u=void 0),p+=l;g+=d}};const bl=Phaser.Utils.Objects.IsPlainObject,xl=Phaser.Utils.Objects.GetValue;var yl=function(t){return"string"==typeof t&&(t=wl[t]),t};const wl={scale:0,repeat:1};var kl=function(t,e){return 0===t||t===this.columns.count-1||0===e||e===this.rows.count-1},Cl={setTexture:ml,updateTexture:vl,setStretchMode:function(t){return bl(t)?(this.stretchMode.edge=yl(xl(t,"edge",0)),this.stretchMode.internal=yl(xl(t,"internal",0))):(t=yl(t),this.stretchMode.edge=t,this.stretchMode.internal=t),this},getStretchMode:function(t,e){return kl.call(this,t,e)?this.stretchMode.edge:this.stretchMode.internal}};var _l=function(t,e,i){return"__BASE"===i?`${t},${e}`:`${i}_${t},${e}`};const Sl=Phaser.GameObjects.RenderTexture,Tl=Phaser.Utils.Objects.IsPlainObject,Ol=Phaser.Utils.Objects.GetValue;class El extends Sl{constructor(t,e,i,s,n,r,a,o,h,l){Tl(e)?(e=Ol(l=e,"x",0),i=Ol(l,"y",0),s=Ol(l,"width",1),n=Ol(l,"height",1),r=Ol(l,"key",void 0),a=Ol(l,"baseFrame",void 0),o=Ol(l,"columns",void 0),h=Ol(l,"rows",void 0)):Tl(s)?(s=Ol(l=s,"width",1),n=Ol(l,"height",1),r=Ol(l,"key",void 0),a=Ol(l,"baseFrame",void 0),o=Ol(l,"columns",void 0),h=Ol(l,"rows",void 0)):Tl(r)?(r=Ol(l=r,"key",void 0),a=Ol(l,"baseFrame",void 0),o=Ol(l,"columns",void 0),h=Ol(l,"rows",void 0)):Tl(a)?(a=Ol(l=a,"baseFrame",void 0),o=Ol(l,"columns",void 0),h=Ol(l,"rows",void 0)):Mh(a)?(l=h,h=o,o=a,a=Ol(l,"baseFrame",void 0)):Tl(o)&&(o=Ol(l=o,"columns",void 0),h=Ol(l,"rows",void 0)),super(t,e,i,s,n),this.columns={},this.rows={},this.stretchMode={},this._tileSprite=void 0,this._image=void 0,this.setOrigin(.5,.5),this.setGetFrameNameCallback(Ol(l,"getFrameNameCallback",void 0)),this.setStretchMode(Ol(l,"stretchMode",0)),this.setTexture(r,a,o,h)}setGetFrameNameCallback(t){return void 0===t&&(t=_l),this.getFrameNameCallback=t,this}get minWidth(){return this.columns.minWidth}get minHeight(){return this.rows.minHeight}resize(t,e){return this.width===t&&this.height===e||(super.resize(t,e),this.updateTexture()),this}}Object.assign(El.prototype,Cl);var Pl=El;zr.register("ninePatch",(function(t,e,i,s,n,r,a,o){var h=new Pl(this.scene,t,e,i,s,n,r,a,o);return this.scene.add.existing(h),h})),Qr(window,"RexPlugins.UI.NinePatch",Pl);var Ml,Il=function(t){return t.hasOwnProperty("rexSizer")||(t.rexSizer={}),t.rexSizer},Bl=function(t,e){void 0===e&&(void 0===Ml&&(Ml=new Phaser.Geom.Rectangle),e=Ml);var i=t.game.config;return e.setTo(0,0,i.width,i.height),e},jl=function(t){return void 0===t&&(t=Bl(this.scene)),this.left=Math.max(this.left,t.left),this.right=Math.min(this.right,t.right),this.top=Math.max(this.top,t.top),this.bottom=Math.min(this.bottom,t.bottom),this};const zl=Phaser.Display.Align;var Dl={center:zl.CENTER,left:zl.LEFT_CENTER,right:zl.RIGHT_CENTER,top:zl.TOP_CENTER,bottom:zl.BOTTOM_CENTER,"left-top":zl.TOP_LEFT,"left-center":zl.LEFT_CENTER,"left-bottom":zl.BOTTOM_LEFT,"center-top":zl.TOP_CENTER,"center-center":zl.CENTER,"center-bottom":zl.BOTTOM_CENTER,"right-top":zl.TOP_RIGHT,"right-center":zl.RIGHT_CENTER,"right-bottom":zl.BOTTOM_RIGHT},Ll=new Phaser.GameObjects.Zone({sys:{queueDepthSort:wa,events:{once:wa}}},0,0,1,1);Ll.setOrigin(0);var Rl=Ll,Ul={TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12},Fl=function(t){return void 0!==t.displayWidth?t.displayWidth:t.width},Wl=function(t){return void 0!==t.displayHeight?t.displayHeight:t.height},Yl=function(t){var e=Wl(t);return t.y+e-e*t.originY},Al=function(t){var e=Fl(t);return t.x-e*t.originX+.5*e},Hl=function(t,e){var i=Wl(t);return t.y=e-i+i*t.originY,t},Vl=function(t,e){var i=Fl(t),s=i*t.originX;return t.x=e+s-.5*i,t},Nl=function(t,e,i,s){return void 0===i&&(i=0),void 0===s&&(s=0),Vl(t,Al(e)+i),Hl(t,Yl(e)+s),t},Gl=function(t){var e=Fl(t);return t.x-e*t.originX},Xl=function(t,e){var i=Fl(t);return t.x=e+i*t.originX,t},Jl=function(t,e,i,s){return void 0===i&&(i=0),void 0===s&&(s=0),Xl(t,Gl(e)-i),Hl(t,Yl(e)+s),t},Kl=function(t){var e=Fl(t);return t.x+e-e*t.originX},Zl=function(t,e){var i=Fl(t);return t.x=e-i+i*t.originX,t},ql=function(t,e,i,s){return void 0===i&&(i=0),void 0===s&&(s=0),Zl(t,Kl(e)+i),Hl(t,Yl(e)+s),t},$l=function(t,e){var i=Wl(t),s=i*t.originY;return t.y=e+s-.5*i,t},Ql=function(t,e,i){return Vl(t,e),$l(t,i)},td=function(t){var e=Wl(t);return t.y-e*t.originY+.5*e},ed=function(t,e,i,s){return void 0===i&&(i=0),void 0===s&&(s=0),Ql(t,Al(e)+i,td(e)+s),t},id=function(t,e,i,s){return void 0===i&&(i=0),void 0===s&&(s=0),Xl(t,Gl(e)-i),$l(t,td(e)+s),t},sd=function(t,e,i,s){return void 0===i&&(i=0),void 0===s&&(s=0),Zl(t,Kl(e)+i),$l(t,td(e)+s),t},nd=function(t){var e=Wl(t);return t.y-e*t.originY},rd=function(t,e){var i=Wl(t);return t.y=e+i*t.originY,t},ad=function(t,e,i,s){return void 0===i&&(i=0),void 0===s&&(s=0),Vl(t,Al(e)+i),rd(t,nd(e)-s),t},od=function(t,e,i,s){return void 0===i&&(i=0),void 0===s&&(s=0),Xl(t,Gl(e)-i),rd(t,nd(e)-s),t},hd=function(t,e,i,s){return void 0===i&&(i=0),void 0===s&&(s=0),Zl(t,Kl(e)+i),rd(t,nd(e)-s),t},ld=[];ld[Ul.BOTTOM_CENTER]=Nl,ld[Ul.BOTTOM_LEFT]=Jl,ld[Ul.BOTTOM_RIGHT]=ql,ld[Ul.CENTER]=ed,ld[Ul.LEFT_CENTER]=id,ld[Ul.RIGHT_CENTER]=sd,ld[Ul.TOP_CENTER]=ad,ld[Ul.TOP_LEFT]=od,ld[Ul.TOP_RIGHT]=hd;var dd=function(t,e,i,s,n){return ld[i](t,e,s,n)};const cd=Phaser.Utils.Objects.GetValue,ud=Phaser.GameObjects.Group;var pd=function(t,e,i){return t.add.text(0,0,"")},gd=new Phaser.Geom.Rectangle,md=function(t,e){var i,s,n,r,a=t.scene;if("number"==typeof e)i=e;else{i=cd(e,"color",16777215);var o=cd(e,"name",!1);o&&(s=cd(o,"createTextCallback",pd),n=cd(o,"createTextCallbackScope",void 0),"string"==typeof(r=cd(o,"align","left-top"))&&(r=Dl[r]))}if(s&&!t.children){t.children=new ud(a),t.on("destroy",(function(){t.children.destroy(!0),t.children=void 0}));var h=t.clear.bind(t);t.clear=function(){h(),t.children.clear(!1,!0)}}for(var l,d,c=this.getAllChildren([this]),u=0,p=c.length;u<p;u++)(l=c[u]).getBounds&&(i&&t.lineStyle(1,i).strokeRectShape(l.getBounds(gd)),l.name&&s&&(d=n?s.call(n,a):s(a))&&(d.setText(l.name),t.children.add(d),Rl.setPosition(gd.x,gd.y).setSize(gd.width,gd.height),dd(d,Rl,r)));return this};const fd=Phaser.Utils.Objects.GetValue;var vd=function(t,e){return void 0===e&&(e={}),"number"==typeof t?(e.left=t,e.right=t,e.top=t,e.bottom=t):(e.left=fd(t,"left",0),e.right=fd(t,"right",0),e.top=fd(t,"top",0),e.bottom=fd(t,"bottom",0)),e};const bd=Lh.prototype.add;var xd={pin(t){return bd.call(this,t),this},addBackground(t,e,i){return void 0===this.backgroundChildren&&(this.backgroundChildren=[]),"string"==typeof e&&(i=e,e=void 0),void 0===e&&(e=0),this.pin(t),this.backgroundChildren.push(t),this.getSizerConfig(t).padding=vd(e),void 0!==i&&this.addChildrenMap(i,t),this},isBackground(t){return void 0!==this.backgroundChildren&&-1!==this.backgroundChildren.indexOf(t)}},yd=function(t,e){return void 0===this.childrenMap&&(this.childrenMap={}),this.childrenMap[t]=e,this};const wd=/(\S+)\[(\d+)\]/i;var kd=function(t,e){if("string"==typeof t&&(t=t.split(".")),0!==t.length){var i=t.shift(),s=null;if("#"===i.charAt(0))i=i.substring(1),s=this.getByName(i,e);else if(-1===i.indexOf("["))this.childrenMap&&(s=this.childrenMap[i]);else{var n=i.match(wd);if(null!=n&&this.childrenMap){var r=this.childrenMap[n[1]];r&&(s=r[n[2]])}}return 0===t.length?s:s&&s.childrenMap?s.getElement(t):null}},Cd=function(){return 0},_d=function(){return 0},Sd=function(t){void 0===t&&(t=[]);for(var e=t.length,i=this.getChildrenSizers(t),s=t.length,n=e;n<s;n++)i[n].getAllChildrenSizers(t);return t},Td=function(t){return void 0===t&&(t=[]),t},Od=function(t){if(!t){this._layoutInit();for(var e,i=this.getChildrenSizers(),s=0,n=i.length;s<n;s++)!(e=i[s]).rexSizer.hidden&&e.dirty&&e.preLayout()}},Ed=function(){return this._layout(),this},Pd=function(t,e,i){return this.rexSizer.hidden||!this.dirty?this:(this.preLayout(t),void 0===e&&(e=Math.max(this.childrenWidth,this.minWidth)),void 0===i&&(i=Math.max(this.childrenHeight,this.minHeight)),this.resize(e,i),this.layoutBackgrounds(),this.postLayout())},Md=function(t,e,i){return this._anchor&&this._anchor.updatePosition(),this},Id=function(){this._childrenWidth=void 0,this._childrenHeight=void 0};const Bd=Phaser.Geom.Rectangle;var jd=new Bd,zd=function(t,e){void 0===e?e=new Bd:!0===e&&(e=jd);var i=t.scale,s=i.canvasBounds,n=i.displayScale,r=i.autoCenter;return e.x=s.x>=0?0:-s.x*n.x,e.y=s.y>=0?0:-s.y*n.y,e.width=s.width*n.x-e.x,e.height=s.height*n.y-e.y,1!==r&&2!==r||(e.width-=e.x),1!==r&&3!==r||(e.height-=e.y),e};var Dd=class{constructor(t,e){this.gameObject=t,this.scene=t.scene,this.resetFromJSON(e),this.boot()}resetFromJSON(t){var e,i,s,n,r,a,o,h;return void 0!==t.x?(e=null,i=t.x):void 0!==t.left?(e=0,i=t.left):void 0!==t.right?(e=1,i=t.right):void 0!==t.centerX&&(e=.5,i=t.centerX),void 0!==t.y?(s=null,n=t.y):void 0!==t.top?(s=0,n=t.top):void 0!==t.bottom?(s=1,n=t.bottom):void 0!==t.centerY&&(s=.5,n=t.centerY),void 0!==i&&(i=i.replace("left","0%").replace("right","100%").replace("center","50%").split("%"),r=parseFloat(i[0])/100,a=""===i[1]?0:parseFloat(i[1])),void 0!==n&&(n=n.replace("top","0%").replace("bottom","100%").replace("center","50%").split("%"),o=parseFloat(n[0])/100,h=""===n[1]?0:parseFloat(n[1])),this.setAlign(e,s),this.setPercentage(r,o),this.setOffset(a,h),this}boot(){this.scene.scale.on("resize",this.anchor,this),this.gameObject.on("destroy",this.destroy,this),this.anchor()}shutdown(){this.scene.scale.off("resize",this.anchor,this),this.gameObject=void 0,this.scene=void 0}destroy(){this.shutdown()}setAlign(t,e){return this.alignX=t,this.alignY=e,this}setPercentage(t,e){return this.percentageX=t,this.percentageY=e,this}setOffset(t,e){return this.offsetX=t,this.offsetY=e,this}anchor(){return this.viewport=zd(this.scene,!0),this.updatePosition(),this}updatePosition(){var t=this.gameObject;return null===this.alignX?t.x=this.anchorX:void 0!==this.alignX&&(t.x=this.anchorX+t.displayWidth*(t.originX-this.alignX)),null===this.alignY?this.gameObject.y=this.anchorY:void 0!==this.alignY&&(t.y=this.anchorY+t.displayHeight*(t.originY-this.alignY)),this}get anchorX(){return this.viewport.x+this.viewport.width*this.percentageX+this.offsetX}get anchorY(){return this.viewport.y+this.viewport.height*this.percentageY+this.offsetY}},Ld=function(t){return void 0===this._anchor?this._anchor=new Dd(this,t):this._anchor.resetFromJSON(t),this},Rd={setEventEmitter(t,e){return void 0===e&&(e=Phaser.Events.EventEmitter),this._privateEE=void 0===t,this._eventEmitter=this._privateEE?new e:t,this},destroyEventEmitter(){return this._eventEmitter&&this._privateEE&&this._eventEmitter.shutdown(),this},getEventEmitter(){return this._eventEmitter},on:function(){return this._eventEmitter&&this._eventEmitter.on.apply(this._eventEmitter,arguments),this},once:function(){return this._eventEmitter&&this._eventEmitter.once.apply(this._eventEmitter,arguments),this},off:function(){return this._eventEmitter&&this._eventEmitter.off.apply(this._eventEmitter,arguments),this},emit:function(t){return this._eventEmitter&&t&&this._eventEmitter.emit.apply(this._eventEmitter,arguments),this},addListener:function(){return this._eventEmitter&&this._eventEmitter.addListener.apply(this._eventEmitter,arguments),this},removeListener:function(){return this._eventEmitter&&this._eventEmitter.removeListener.apply(this._eventEmitter,arguments),this},removeAllListeners:function(){return this._eventEmitter&&this._eventEmitter.removeAllListeners.apply(this._eventEmitter,arguments),this},listenerCount:function(){return this._eventEmitter?this._eventEmitter.listenerCount.apply(this._eventEmitter,arguments):0},listeners:function(){return this._eventEmitter?this._eventEmitter.listeners.apply(this._eventEmitter,arguments):[]}};const Ud=Phaser.Scene;var Fd=function(t){return t instanceof Ud},Wd=function(t){return Fd(t)?t:t.scene&&Fd(t.scene)?t.scene:t.parent&&t.parent.scene&&Fd(t.parent.scene)?t.parent.scene:void 0};const Yd=Phaser.GameObjects.GameObject;var Ad=function(t){return t instanceof Yd};const Hd=Phaser.Utils.Objects.GetValue;class Vd{constructor(t,e){this.parent=t,this.scene=Wd(t);var i=Hd(e,"eventEmitter",!1);!0===i&&(i=void 0),this.setEventEmitter(i),this.boot()}boot(){Ad(this.parent)?this.parent.once&&this.parent.on("destroy",this.destroy,this):Fd(this.parent)&&this.parent.events.once("shutdown",this.destroy,this)}shutdown(){return this.stop(),Fd(this.parent)&&this.parent.events.off("shutdown",this.destroy,this),this.destroyEventEmitter(),this.parent=void 0,this.scene=void 0,this}destroy(){return this.shutdown(),this}start(t){return this.isRunning||(this.tween=this.scene.tweens.add(t).on("complete",this.complete,this),!1===this.getEventEmitter()&&this.setEventEmitter(this.tween)),this}restart(){return this.stop().start(),this}stop(){return this.tween?(this.getEventEmitter()===this.tween&&this.setEventEmitter(!1),this.tween.remove(),this.tween=void 0,this):this}complete(){return this.stop(),this.getEventEmitter()&&this.emit("complete"),this}get isRunning(){return!!this.tween}}Object.assign(Vd.prototype,Rd);var Nd=Vd;const Gd=Phaser.Utils.Objects.GetValue,Xd=Phaser.Utils.Objects.GetAdvancedValue;const Jd={stop:0,destroy:1,yoyo:2};var Kd=class extends Nd{constructor(t,e){super(t),this.gameObject=t,this.scaleStart={},this.scaleEnd={},this.resetFromJSON(e)}resetFromJSON(t){return this.setMode(Gd(t,"mode",0)),this.setScaleRange(Xd(t,"start",void 0),Xd(t,"end",0)),this.setDelay(Xd(t,"delay",0)),this.setDuration(Xd(t,"duration",1e3)),this.setEase(Gd(t,"ease",void 0)),this}toJSON(){return{mode:this.mode,startX:this.startX,startY:this.startY,endX:this.endX,endY:this.endY,delay:this.delay,duration:this.duration}}setMode(t){return"string"==typeof t&&(t=Jd[t]),this.mode=t,this}setScaleRange(t,e){return"number"==typeof t?(this.startX=t,this.startY=t):(this.startX=Xd(t,"x",this.gameObject.scaleX),this.startY=Xd(t,"y",this.gameObject.scaleY)),"number"==typeof e?(this.endX=e,this.endY=e):(this.endX=Xd(e,"x",void 0),this.endY=Xd(e,"y",void 0)),this}setDelay(t){return this.delay=t,this}setDuration(t){return this.duration=t,this}setEase(t){return void 0===t&&(t="Linear"),this.ease=t,this}start(){if(this.isRunning)return this;var t={targets:this.gameObject,delay:this.delay,duration:this.duration,ease:this.ease,yoyo:2==this.mode,repeat:2==this.mode?-1:0};return void 0!==this.startX&&void 0!==this.endX&&(this.gameObject.scaleX=this.startX,t.scaleX=this.endX),void 0!==this.startY&&void 0!==this.endY&&(this.gameObject.scaleY=this.startY,t.scaleY=this.endY),super.start(t),this}complete(){return super.complete(),1===this.mode&&this.gameObject.destroy(),this}},Zd={},qd=function(t,e,i,s,n){switch(Zd.mode=0,i){case 0:case"x":Zd.start={x:0};break;case 1:case"y":Zd.start={y:0};break;default:Zd.start=0}return Zd.end=1,Zd.duration=e,Zd.ease=void 0===s?"Cubic":s,void 0===n?n=new Kd(t,Zd):n.resetFromJSON(Zd),n.restart(),n},$d=function(t,e,i,s,n,r){n instanceof Kd&&(r=n,n=void 0),void 0===n&&(n=!0);var a={};switch(a.mode=n?1:0,i){case 0:case"x":a.end={x:0};break;case 1:case"y":a.end={y:0};break;default:a.end=0}return a.duration=e,a.ease=void 0===s?"Linear":s,void 0===r?r=new Kd(t,a):r.resetFromJSON(a),r.restart(),r},Qd=function(t,e){return new Promise((function(i,s){t.once(e,(function(){i()}))}))},tc=function(t){return Qd(t,"complete")};const ec=Phaser.Utils.Objects.IsPlainObject;var ic={popUp(t,e,i){if(ec(t)){var s=t;t=s.duration,e=s.orientation,i=s.ease}this._scale=qd(this,t,e,i,this._scale),this._scale.once("complete",(function(){this.emit("popup.complete",this)}),this);var n=this.getParentSizer();if(n){var r=this;this._scale.on("update",(function(){n.resetChildPositionState(r)}))}return this},popUpPromise(t,e,i){return this.popUp(t,e,i),tc(this._scale)},scaleDownDestroy(t,e,i,s){if(ec(t)){var n=t;t=n.duration,e=n.orientation,i=n.ease,s=n.destroy}this._scale=$d(this,t,e,i,s,this._scale),this._scale.once("complete",(function(){this.emit("scaledown.complete",this)}),this);var r=this.getParentSizer();if(r){var a=this;this._scale.on("update",(function(){r.resetChildPositionState(a)}))}return this},scaleDownDestroyPromise(t,e,i,s){return this.scaleDownDestroy(t,e,i,s),tc(this._scale)},scaleDown(t,e,i){return this.scaleDownDestroy(t,e,i,!1),this},scaleDownPromise(t,e,i){return this.scaleDown(t,e,i),tc(this._scale)}};const sc=Phaser.Utils.Objects.GetValue,nc=Phaser.Utils.Objects.GetAdvancedValue;const rc={stop:0,destroy:1,yoyo:2};var ac=class extends Nd{constructor(t,e){super(t),this.gameObject=t,this.alphaStart=void 0,this.alphaEnd=void 0,this.resetFromJSON(e)}resetFromJSON(t){return this.setMode(sc(t,"mode",0)),this.setAlphaRange(nc(t,"start",this.gameObject.alpha),nc(t,"end",0)),this.setDelay(nc(t,"delay",0)),this.setDuration(nc(t,"duration",1e3)),this}toJSON(){return{mode:this.mode,start:this.alphaStart,end:this.alphaEnd,delay:this.delay,duration:this.duration}}shutdown(){return super.shutdown(),this.gameObject=void 0,this}setMode(t){return"string"==typeof t&&(t=rc[t]),this.mode=t,this}setAlphaRange(t,e){return this.alphaStart=t,this.alphaEnd=e,this}setDelay(t){return this.delay=t,this}setDuration(t){return this.duration=t,this}start(){return this.isRunning||(this.gameObject.setAlpha(this.alphaStart),super.start({targets:this.gameObject,alpha:this.alphaEnd,delay:this.delay,duration:this.duration,ease:"Linear",yoyo:2==this.mode,repeat:2==this.mode?-1:0})),this}complete(){return super.complete(),1===this.mode&&this.gameObject.destroy(),this}};const oc=Phaser.Utils.Objects.IsPlainObject;var hc={},lc=function(t,e,i,s){var n,r;return oc(i)?(n=i.start,r=i.end):r=i,void 0===n&&(n=0),void 0===r&&(r=t.alpha),hc.mode=0,hc.start=n,hc.end=r,hc.duration=e,void 0===s?s=new ac(t,hc):s.resetFromJSON(hc),s.restart(),s},dc={},cc=function(t,e,i,s){return i instanceof ac&&(s=i,i=void 0),void 0===i&&(i=!0),dc.mode=i?1:0,dc.end=0,dc.duration=e,void 0===s?s=new ac(t,dc):s.resetFromJSON(dc),s.restart(),s};const uc=Phaser.Utils.Objects.IsPlainObject;var pc={fadeIn(t,e){uc(t)&&(t=t.duration);this._fade=lc(this,t,e,this._fade),this._fade.once("complete",(function(){this.emit("fadein.complete",this)}),this);var i=this.getParentSizer();if(i){var s=this;this._fade.on("update",(function(){i.resetChildAlphaState(s)}))}return this},fadeInPromoise(t,e){return this.fadeIn(t,e),tc(this._fade)},fadeOutDestroy(t,e){if(uc(t)){var i=t;t=i.duration,e=i.destroy}this._fade=cc(this,t,e,this._fade),this._fade.once("complete",(function(){this.emit("fadeout.complete",this)}),this);var s=this.getParentSizer();if(s){var n=this;this._fade.on("update",(function(){s.resetChildAlphaState(n)}))}return this},fadeOutDestroyPromise(t,e){return this.fadeOutDestroy(t,e),tc(this._fade)},fadeOut(t){return this.fadeOutDestroy(t,!1),this},fadeOutPromise(t){return this.fadeOut(t),tc(this._fade)}};const gc=Phaser.Utils.Objects.GetValue,mc=Phaser.Utils.Objects.GetAdvancedValue;const fc={stop:0,destroy:1,yoyo:2};var vc=class extends Nd{constructor(t,e){super(t),this.gameObject=t,this.resetFromJSON(e)}resetFromJSON(t){if(this.setMode(gc(t,"mode",0)),t&&(t.hasOwnProperty("x")||t.hasOwnProperty("y"))){var e=mc(t,"x",void 0),i=mc(t,"y",void 0);this.setTargetPosition(e,i)}else this.setTargetPosition(t);return this.setDelay(mc(t,"delay",0)),this.setDuration(mc(t,"duration",1e3)),this.setEase(gc(t,"ease",void 0)),this}toJSON(){return{mode:this.mode,startX:this.startX,startY:this.startY,endX:this.endX,endY:this.endY,delay:this.delay,duration:this.duration}}setMode(t){return"string"==typeof t&&(t=fc[t]),this.mode=t,this}setTargetPosition(t,e){if("number"==typeof t||"number"==typeof e)this.startX=this.gameObject.x,this.startY=this.gameObject.y,this.endX=t,this.endY=e;else{var i=t;this.startX=mc(i,"startX",void 0),this.startY=mc(i,"startY",void 0),this.endX=mc(i,"endX",void 0),this.endY=mc(i,"endY",void 0)}return this}setDelay(t){return this.delay=t,this}setDuration(t){return this.duration=t,this}setEase(t){return void 0===t&&(t="Linear"),this.ease=t,this}start(){if(this.isRunning)return this;var t={targets:this.gameObject,delay:this.delay,duration:this.duration,ease:this.ease,yoyo:2==this.mode,repeat:2==this.mode?-1:0};return void 0!==this.startX&&void 0!==this.endX&&(this.gameObject.setX(this.startX),t.x=this.endX),void 0!==this.startY&&void 0!==this.endY&&(this.gameObject.setY(this.startY),t.y=this.endY),super.start(t),this}complete(){return super.complete(),1===this.mode&&this.gameObject.destroy(),this}},bc=function(t,e,i,s,n,r,a){r instanceof vc&&(a=r,r=void 0),void 0===r&&(r=!1);var o={};return o.mode=r?1:0,void 0!==i&&(o.startX=t.x,o.endX=yc(i,t.x)),void 0!==s&&(o.startY=t.y,o.endY=yc(s,t.y)),o.duration=e,o.ease=void 0===n?"Linear":n,void 0===a?a=new vc(t,o):a.resetFromJSON(o),a.restart(),a},xc=function(t,e,i,s,n,r,a){r instanceof vc&&(a=r,r=void 0),void 0===r&&(r=!1);var o={};return o.mode=r?1:0,void 0!==i&&(o.startX=yc(i,t.x),o.endX=t.x),void 0!==s&&(o.startY=yc(s,t.y),o.endY=t.y),o.duration=e,o.ease=void 0===n?"Linear":n,void 0===a?a=new vc(t,o):a.resetFromJSON(o),a.restart(),a},yc=function(t,e){if("number"==typeof t)return t;var i=t[0],s=parseFloat(t.substr(2));switch(i){case"+":return e+s;case"-":return e-s;case"*":return e*s;case"/":return e/s}};const wc=Phaser.Utils.Objects.IsPlainObject;var kc={moveFrom(t,e,i,s,n){if(wc(e)){var r=e;e=r.x,i=r.y,t=r.duration,s=r.ease}this._easeMove=xc(this,t,e,i,s,n,this._easeMove),this._easeMove.once("complete",(function(){this.emit("movefrom.complete",this)}),this);var a=this.getParentSizer();if(a){var o=this;this._easeMove.on("update",(function(){a.resetChildPositionState(o)}))}return this},moveFromPromise(t,e,i,s,n){return this.moveFrom(t,e,i,s,n),tc(this._easeMove)},moveFromDestroy(t,e,i,s){return this.moveFrom(t,e,i,s,!0),this},moveFromDestroyPromise(t,e,i,s){return this.moveFromDestroy(t,e,i,s),tc(this._easeMove)},moveTo(t,e,i,s,n){if(wc(e)){var r=e;e=r.x,i=r.y,t=r.duration,s=r.ease}this._easeMove=bc(this,t,e,i,s,n,this._easeMove),this._easeMove.once("complete",(function(){this.emit("moveto.complete",this)}),this);var a=this.getParentSizer();if(a){var o=this;this._easeMove.on("update",(function(){a.resetChildPositionState(o)}))}return this},moveToPromise(t,e,i,s,n){return this.moveTo(t,e,i,s,n),tc(this._easeMove)},moveToDestroy(t,e,i,s){return this.moveTo(t,e,i,s,!0),this},moveToDestroyPromise(t,e,i,s){return this.moveToDestroy(t,e,i,s,!0),tc(this._easeMove)}},Cc=void 0,_c=function(t,e,i,s,n){return!(!t||!t.getBounds)&&(!(s&&!s(t,e,i))&&(!!(Cc=t.getBounds(Cc)).contains(e,i)&&!(n&&!n(t,e,i))))},Sc=function(t,e,i,s){if(e)return _c(t,e.x,e.y,i,s);for(var n=t.scene.input.manager,r=n.pointersTotal,a=n.pointers,o=0;o<r;o++)if(e=a[o],_c(t,e.x,e.y,i,s))return!0;return!1},Tc=function(t,e){return void 0===e&&(e=this),Sc(e,t)},Oc=function(t){return t&&"function"==typeof t},Ec=function(t){return!(t.rexSizer&&t.rexSizer.hidden)},Pc=function(t){return t?function(e,i,s){return!!Ec(e)&&(t(e,i,s),!0)}:Ec},Mc=function(t){return t},Ic=function(t,e,i,s,n){return _c(t,e,i,Pc(s),Mc(n))},Bc=function(t,e,i,s,n){if(Oc(i)||(n=i,i=void 0,s=void 0),void 0===n&&(n=this.sizerChildren?this.sizerChildren:this.children),Mh(n)){for(var r,a=0,o=n.length;a<o;a++)if(r=n[a],Ic(r,t,e,i,s))return r}else for(var h in n)if(r=n[h],Ic(r,t,e,i,s))return r;return null},jc={getParentSizer(t){return this.getParent(t)},getTopmostSizer(t){return this.getTopmostParent(t)}},zc=function(t,e,i){!t||void 0===e&&void 0===i||(t.resize?(void 0===e&&(e=t.width),void 0===i&&(i=t.height),t.resize(e,i)):(void 0!==e&&(t.displayWidth=e),void 0!==i&&(t.displayHeight=i)))};const Dc=Phaser.Display.Align.CENTER;var Lc={getSizerConfig:Il,pushIntoBounds:jl,drawBounds:md,getChildrenWidth:Cd,getChildrenHeight:_d,addChildrenMap:yd,addElement:yd,getElement:kd,getAllChildrenSizers:Sd,getChildrenSizers:Td,preLayout:Od,_layoutInit:Id,layout:Ed,_layout:Pd,layoutBackgrounds:function(){if(void 0!==this.backgroundChildren)for(var t,e,i,s,n,r,a,o=this.backgroundChildren,h=this.left,l=this.top,d=this.width,c=this.height,u=0,p=o.length;u<p;u++)(e=(t=o[u]).rexSizer).hidden||(s=h+(i=e.padding).left,n=l+i.top,r=d-i.left-i.right,a=c-i.top-i.bottom,zc(t,r,a),Rl.setPosition(s,n).setSize(r,a),dd(t,Rl,Dc),this.resetChildPositionState(t))},postLayout:Md,setAnchor:Ld,isInTouching:Tc,pointToChild:Bc,setDraggable:function(t,e){var i=typeof t;return"string"===i?t=this.getElement(t):void 0!==t&&"object"==i||(e=t,t=this),void 0===e&&(e=!0),t.input&&t.input.hasOwnProperty("draggable")?t.input.draggable=e:e&&(t.setInteractive(),t.scene.input.setDraggable(t),t.on("drag",(function(e,i,s){var n=this.getTopmostSizer();n.x+=i-t.x,n.y+=s-t.y}),this)),this}};Object.assign(Lc,xd,jc,ic,pc,kc);var Rc=Lc;const Uc=Phaser.Utils.Objects.GetValue;class Fc extends Lh{constructor(t,e,i,s,n,r){super(t,e,i,2,2),this.isRexSizer=!0,this.setMinSize(s,n),this.setName(Uc(r,"name","")),this.rexSizer={},this.backgroundChildren=void 0,this.sizerChildren=void 0;var a=Uc(r,"anchor",void 0);a&&this.setAnchor(a),this.space=vd(Uc(r,"space",0)),this.setDraggable(Uc(r,"draggable",!1)),this.setDirty(!0)}destroy(t){this.scene&&(void 0!==this.backgroundChildren&&(this.backgroundChildren.length=0),super.destroy(t))}setMinSize(t,e){return this.setMinWidth(t).setMinHeight(e),this}setMinWidth(t){return null==t&&(t=0),this.minWidth=t,this}setMinHeight(t){return null==t&&(t=0),this.minHeight=t,this}setDirty(t){return void 0===t&&(t=!0),this.dirty=t,this}get childrenWidth(){return void 0===this._childrenWidth&&(this._childrenWidth=this.getChildrenWidth()),this._childrenWidth}get childrenHeight(){return void 0===this._childrenHeight&&(this._childrenHeight=this.getChildrenHeight()),this._childrenHeight}get left(){return this.x-Fl(this)*this.originX}set left(t){this.x+=t-this.left}alignLeft(t){return this.left=t,this}get right(){return this.left+Fl(this)}set right(t){this.x+=t-this.right}alignRight(t){return this.right=t,this}get centerX(){return this.left+Fl(this)/2}set centerX(t){this.x+=t-this.centerX}alignCenterX(t){return this.centerX=t,this}get top(){return this.y-Wl(this)*this.originY}set top(t){this.y+=t-this.top}alignTop(t){return this.top=t,this}get bottom(){return this.top+Wl(this)}set bottom(t){this.y+=t-this.bottom}alignBottom(t){return this.bottom=t,this}get centerY(){return this.top+Wl(this)/2}set centerY(t){this.y+=t-this.centerY}alignCenterY(t){return this.centerY=t,this}get innerLeft(){return this.left+this.space.left}get innerRight(){return this.right-this.space.right}get innerTop(){return this.top+this.space.top}get innerBottom(){return this.bottom-this.space.bottom}get innerWidth(){return this.width-this.space.left-this.space.right}get innerHeight(){return this.height-this.space.top-this.space.bottom}}Object.assign(Fc.prototype,Rc);var Wc=Fc,Yc=function(t){if(this.rexSizer.hidden)return 0;void 0===t&&(t=!0);var e,i,s,n=0,r=this.sizerChildren;if(0===this.orientation)for(var a=0,o=r.length;a<o;a++)(e=r[a]).rexSizer.hidden||(s=0===e.rexSizer.proportion||t&&!e.isRexSpace&&e.rexSizer.proportion>0?e.isRexSizer?Math.max(e.minWidth,e.childrenWidth):Fl(e):0,s+=(i=e.rexSizer.padding).left+i.right,a>0&&(s+=this.space.item),n+=s);else for(a=0,o=r.length;a<o;a++)(e=r[a]).hasOwnProperty("rexSizer")&&(e.rexSizer.hidden||(s=e.isRexSizer?Math.max(e.minWidth,e.childrenWidth):Fl(e),s+=(i=e.rexSizer.padding).left+i.right,n=Math.max(s,n)));return n+this.space.left+this.space.right},Ac=function(t){if(this.rexSizer.hidden)return 0;void 0===t&&(t=!0);var e,i,s,n=0,r=this.sizerChildren;if(0===this.orientation)for(var a=0,o=r.length;a<o;a++)(e=r[a]).rexSizer.hidden||(s=e.isRexSizer?Math.max(e.minHeight,e.childrenHeight):Wl(e),s+=(i=e.rexSizer.padding).top+i.bottom,n=Math.max(s,n));else for(a=0,o=r.length;a<o;a++)(e=r[a]).hasOwnProperty("rexSizer")&&(e.rexSizer.hidden||(s=0===e.rexSizer.proportion||t&&!e.isRexSpace&&e.rexSizer.proportion>0?e.isRexSizer?Math.max(e.minHeight,e.childrenHeight):Wl(e):0,s+=(i=e.rexSizer.padding).top+i.bottom,a>0&&(s+=this.space.item),n+=s));return n+this.space.top+this.space.bottom},Hc=function(){for(var t,e,i=0,s=this.sizerChildren,n=0,r=s.length;n<r;n++)(t=s[n]).rexSizer.hidden||(e=t.rexSizer.proportion)>0&&(i+=e);return i},Vc=function(t){void 0===t&&(t=[]);for(var e,i=this.sizerChildren,s=0,n=i.length;s<n;s++)(e=i[s]).isRexSizer&&t.push(e);return t},Nc=function(t,e){var i,s=e.rexSizer,n=s.padding;return 0===t.orientation?s.proportion>0&&t.proportionLength>0&&(i=s.proportion*t.proportionLength):s.expand&&(i=t.innerWidth-n.left-n.right),i},Gc=function(t,e){var i,s=e.rexSizer,n=s.padding;return 0===t.orientation?s.expand&&(i=t.innerHeight-n.top-n.bottom):s.proportion>0&&t.proportionLength>0&&(i=s.proportion*t.proportionLength),i},Xc=function(t,e,i){if(this.rexSizer.hidden||!this.dirty)return this;var s;if(this.preLayout(t),void 0===e&&(e=Math.max(this.childrenWidth,this.minWidth)),void 0===i&&(i=Math.max(this.childrenHeight,this.minHeight)),this.resize(e,i),this.childrenProportion>0){var n=0===this.orientation?this.width-this.childrenWidth:this.height-this.childrenHeight;s=n>0?(n=0===this.orientation?this.width-this.getChildrenWidth(!1):this.height-this.getChildrenHeight(!1))/this.childrenProportion:0}else s=0;this.proportionLength=s;for(var r,a,o,h,l,d,c,u,p,g=this.sizerChildren,m=this.innerLeft,f=this.innerTop,v=this.innerWidth,b=this.innerHeight,x=m,y=f,w=0,k=g.length;w<k;w++)(r=g[w]).rexSizer.hidden||(o=(a=r.rexSizer).padding,u=Nc(this,r),p=Gc(this,r),r.isRexSizer?r._layout(this,u,p):zc(r,u,p),void 0===u&&(u=Fl(r)),void 0===p&&(p=Wl(r)),0===this.orientation?(h=x+o.left,d=0===a.proportion||0===s?u:a.proportion*s,l=y+o.top,c=b-o.top-o.bottom):(h=x+o.left,d=v-o.left-o.right,l=y+o.top,c=0===a.proportion||0===s?p:a.proportion*s),Rl.setPosition(h,l).setSize(d,c),dd(r,Rl,a.align),this.resetChildPositionState(r),0===this.orientation?x+=d+o.left+o.right+this.space.item:y+=c+o.top+o.bottom+this.space.item);return this.layoutBackgrounds(),this.postLayout()},Jc=function(){Id.call(this),this._childrenProportion=void 0},Kc=function(t){var e=t.add.zone(0,0,1,1);return e.isRexSpace=!0,e};const Zc=Phaser.Utils.Objects.IsPlainObject,qc=Phaser.Utils.Objects.GetValue,$c=Phaser.Display.Align.CENTER,Qc={min:0,full:-1};var tu=function(t,e,i,s,n,r,a){this.pin(t);var o=typeof e;if(null===e)return this;if("number"===o);else if("string"===o)e=Qc[e];else if(Zc(e)){var h;e=qc(h=e,"proportion",0),i=qc(h,"align",$c),s=qc(h,"padding",0),n=qc(h,"expand",!1),r=qc(h,"key",void 0),a=qc(h,"index",void 0)}return"string"==typeof i&&(i=Dl[i]),void 0===e&&(e=0),void 0===i&&(i=$c),void 0===s&&(s=0),void 0===n&&(n=!1),(h=this.getSizerConfig(t)).proportion=e,h.align=i,h.padding=vd(s),h.expand=n,void 0===a||a>=this.sizerChildren.length?this.sizerChildren.push(t):this.sizerChildren.splice(a,0,t),void 0!==r&&this.addChildrenMap(r,t),this},eu={add:tu,addSpace(t){return void 0===t&&(t=1),tu.call(this,Kc(this.scene),t),this},insert(t,e,i,s,n,r,a){return tu.call(this,e,i,s,n,r,a,t),this}};const iu=Phaser.Utils.Array.Remove,su=Lh.prototype.remove,nu=Lh.prototype.clear;var ru={remove(t,e){return this.getParentSizer(t)!==this||(iu(this.sizerChildren,t),su.call(this,t,e)),this},removeAll(t){for(var e=0,i=this.sizerChildren;e<i;e++)this.remove(this.sizerChildren[e],t);return this.sizerChildren.length=0,this},clear(t){return this.sizerChildren.length=0,this.backgroundChildren&&(this.backgroundChildren.length=0),nu.call(this,t),this}},au={getChildrenWidth:Yc,getChildrenHeight:Ac,getChildrenProportion:Hc,getChildrenSizers:Vc,_layout:Xc,_layoutInit:Jc};Object.assign(au,eu,ru);var ou=au,hu={x:0,h:0,horizontal:0,"left-to-right":0,y:1,v:1,vertical:1,"top-to-bottom":1},lu=function(t){return"string"==typeof t&&(t=hu[t]),t};const du=Phaser.Utils.Objects.IsPlainObject,cu=Phaser.Utils.Objects.GetValue;class uu extends Wc{constructor(t,e,i,s,n,r,a){du(e)?(e=cu(a=e,"x",0),i=cu(a,"y",0),s=cu(a,"width",void 0),n=cu(a,"height",void 0),r=cu(a,"orientation",0)):du(s)?(s=cu(a=s,"width",void 0),n=cu(a,"height",void 0),r=cu(a,"orientation",0)):du(r)&&(r=cu(a=r,"orientation",0)),void 0===r&&(r=0),super(t,e,i,s,n,a),this.type="rexSizer",this.sizerChildren=[],this.setOrientation(r),this.setItemSpacing(cu(a,"space.item",0)),this.addChildrenMap("items",this.sizerChildren)}destroy(t){this.scene&&(this.sizerChildren.length=0,super.destroy(t))}setOrientation(t){return this.orientation=lu(t),this}setItemSpacing(t){return this.space.item=t,this}get childrenProportion(){return void 0===this._childrenProportion&&(this._childrenProportion=this.getChildrenProportion()),this._childrenProportion}}Object.assign(uu.prototype,ou);var pu=uu;zr.register("sizer",(function(t,e,i,s,n,r){var a=new pu(this.scene,t,e,i,s,n,r);return this.scene.add.existing(a),a})),Qr(window,"RexPlugins.UI.Sizer",pu);var gu=function(t,e){return t+e},mu=function(){return Array.prototype.reduce.call(arguments,gu,0)},fu=function(){if(this.rexSizer.hidden)return 0;for(var t,e,i,s,n=0,r=this.sizerChildren,a=0;a<this.columnCount;a++){if(t=0,0===this.columnProportions[a]){for(var o=0;o<this.rowCount;o++)(e=r[o*this.columnCount+a])&&(e.rexSizer.hidden||(s=e.isRexSizer?Math.max(e.minWidth,e.childrenWidth):Fl(e),s+=(i=e.rexSizer.padding).left+i.right,t=Math.max(t,s)));n+=t}this.columnWidth[a]=t}return n+mu(this.space.left,...this.space.column,this.space.right)},vu=function(){if(this.rexSizer.hidden)return 0;for(var t,e,i,s,n=0,r=this.sizerChildren,a=0;a<this.rowCount;a++){if(t=0,0===this.rowProportions[a]){for(var o=0;o<this.columnCount;o++)(e=r[a*this.columnCount+o])&&(e.rexSizer.hidden||(s=e.isRexSizer?Math.max(e.minHeight,e.childrenHeight):Wl(e),s+=(i=e.rexSizer.padding).top+i.bottom,t=Math.max(t,s)));n+=t}this.rowHeight[a]=t}return n+mu(this.space.top,...this.space.row,this.space.bottom)},bu=function(t){void 0===t&&(t=[]);for(var e,i=this.sizerChildren,s=0,n=i.length;s<n;s++)(e=i[s])&&e.isRexSizer&&t.push(e);return t},xu=function(t,e){var i,s=t.rexSizer;if(s.expand){var n=s.padding;i=e-n.left-n.right}return i},yu=function(t,e){var i,s=t.rexSizer;if(s.expand){var n=s.padding;i=e-n.top-n.bottom}return i},wu=function(t,e,i){if(this.rexSizer.hidden||!this.dirty)return this;this.preLayout(t);var s,n,r,a,o=this.totalColumnProportions,h=this.totalRowProportions;if(void 0===e)if(t&&o>0){var l=this.rexSizer.padding;e=t.width-l.left-l.right}else e=Math.max(this.childrenWidth,this.minWidth);if(void 0===i)if(t&&h>0){var l=this.rexSizer.padding;i=t.height-l.top-l.bottom}else i=Math.max(this.childrenHeight,this.minHeight);this.resize(e,i),s=o>0?(this.width-this.childrenWidth)/o:0,n=h>0?(this.height-this.childrenHeight)/h:0;for(var d,c,u,p,g,m,f,v,b,x,y=this.innerLeft,w=y,k=this.innerTop,C=this.space.column,_=this.space.row,S=0;S<this.rowCount;S++){x=0===(v=this.rowProportions[S])?this.rowHeight[S]:v*n,w=y;for(var T=0;T<this.columnCount;T++)b=0===(f=this.columnProportions[T])?this.columnWidth[T]:f*s,(r=this.getChildAt(T,S))&&!r.rexSizer.hidden?(g=xu(r,b),m=yu(r,x),r.isRexSizer?r._layout(this,g,m):zc(r,g,m),d=w+(l=(a=r.rexSizer).padding).left,u=b-l.left-l.right,c=k+l.top,p=x-l.top-l.bottom,Rl.setPosition(d,c).setSize(u,p),dd(r,Rl,a.align),this.resetChildPositionState(r),w+=b+C[T]):w+=b+C[T];k+=x+_[S]}return this.layoutBackgrounds(),this.postLayout()};const ku=Phaser.Utils.Objects.IsPlainObject,Cu=Phaser.Utils.Objects.GetValue,_u=Phaser.Display.Align.CENTER;var Su={add(t,e,i,s,n,r,a){(this.pin(t),ku(e))&&(e=Cu(o=e,"column",void 0),i=Cu(o,"row",void 0),s=Cu(o,"align",_u),n=Cu(o,"padding",0),r=Cu(o,"expand",!1),a=Cu(o,"key",void 0));var o,h=function(t,e,i,s,n){if("number"==typeof t||"number"==typeof e)if(void 0===t){for(var r=0;r<s;r++)if(!i[a=e*s+r])return a}else if(void 0===e){for(r=0;r<n;r++)if(!i[a=r*s+t])return a}else{if(!i[a=e*s+t])return a}else if(!0===e){var a;for(r=0;r<s;r++)for(var o=0;o<n;o++)if(!i[a=o*s+r])return a}else{r=0;for(var h=i.length;r<h;r++)if(!i[r])return r}return null}(e,i,this.sizerChildren,this.columnCount,this.rowCount);return null===h||("string"==typeof s&&(s=Dl[s]),void 0===s&&(s=_u),void 0===n&&(n=0),void 0===r&&(r=!0),(o=this.getSizerConfig(t)).align=s,o.padding=vd(n),o.expand=r,this.sizerChildren[h]=t,void 0!==a&&this.addChildrenMap(a,t)),this}},Tu=function(t,e,i,s){void 0===i&&(i=0),void 0===s&&(s=t.length-1);for(var n=i;n<=s;n++)t[n]=e;return t};const Ou=Phaser.Utils.Array.Remove,Eu=Lh.prototype.remove,Pu=Lh.prototype.clear;var Mu={remove(t,e){if(this.getParentSizer(t)!==this)return this;if(this.isBackground(t))Ou(this.backgroundChildren,t);else{var i=this.sizerChildren.indexOf(t);-1!==i&&(this.sizerChildren[i]=null)}return Eu.call(this,t,e),this},removeAt(t,e,i){var s=this.getChildAt(t,e);return s&&this.remove(s,i),this},removeAll(t){for(var e=0,i=this.sizerChildren;e<i;e++)this.sizerChildren[e]&&this.remove(this.sizerChildren[e],t);return this},clear(t){return Tu(this.sizerChildren,null),this.backgroundChildren&&(this.backgroundChildren.length=0),Pu.call(this,t),this}};const Iu=Phaser.Utils.Objects.GetValue;var Bu={getChildrenWidth:fu,getChildrenHeight:vu,getChildrenSizers:bu,_layout:wu,resetGrid:function(t,e,i,s,n){if(void 0===i&&(i=0),void 0===s&&(s=0),this.columnCount=t,this.rowCount=e,void 0===this.sizerChildren?this.sizerChildren=[]:this.removeAll(),this.sizerChildren.length=t*e,Tu(this.sizerChildren,null),this.columnProportions=[],this.columnProportions.length=t,"number"==typeof i)Tu(this.columnProportions,i);else for(var r=0;r<t;r++)this.columnProportions[r]=i[r]||0;if(this.rowProportions=[],this.rowProportions.length=e,"number"==typeof s)Tu(this.rowProportions,s);else for(r=0;r<e;r++)this.rowProportions[r]=s[r]||0;this.columnWidth=[],this.columnWidth.length=t,this.rowHeight=[],this.rowHeight.length=e,this.space.column=[],this.space.column.length=t-1;var a=Iu(n,"column",0);if("number"==typeof a)Tu(this.space.column,a);else{r=0;for(var o=this.space.column.length;r<o;r++)this.space.column[r]=a[r]||0}this.space.row=[],this.space.row.length=e-1;var h=Iu(n,"row",0);if("number"==typeof h)Tu(this.space.row,h);else for(r=0,o=this.space.row.length;r<o;r++)this.space.row[r]=h[r]||0;return this}};Object.assign(Bu,Su,Mu);var ju=Bu;const zu=Phaser.Utils.Objects.IsPlainObject,Du=Phaser.Utils.Objects.GetValue;class Lu extends Wc{constructor(t,e,i,s,n,r,a,o,h,l){zu(e)?(e=Du(l=e,"x",0),i=Du(l,"y",0),s=Du(l,"width",void 0),n=Du(l,"height",void 0),r=Du(l,"column",0),a=Du(l,"row",0),o=Du(l,"columnProportions",0),h=Du(l,"rowProportions",0)):zu(s)?(s=Du(l=s,"width",void 0),n=Du(l,"height",void 0),r=Du(l,"column",0),a=Du(l,"row",0),o=Du(l,"columnProportions",0),h=Du(l,"rowProportions",0)):zu(r)?(r=Du(l=r,"column",0),a=Du(l,"row",0),o=Du(l,"columnProportions",0),h=Du(l,"rowProportions",0)):zu(o)&&(o=Du(l=o,"columnProportions",0),h=Du(l,"rowProportions",0)),super(t,e,i,s,n,l),this.type="rexGridSizer",this.resetGrid(r,a,o,h,Du(l,"space",void 0)),this.addChildrenMap("items",this.sizerChildren)}destroy(t){this.scene&&(this.sizerChildren.length=0,super.destroy(t))}setColumnProportion(t,e){return t>=this.columnProportions.length||(this.columnProportions[t]=e),this}setRowProportion(t,e){return t>=this.rowProportions.length||(this.rowProportions[t]=e),this}get totalColumnProportions(){for(var t,e=0,i=0;i<this.columnCount;i++)(t=this.columnProportions[i])>0&&(e+=t);return e}get totalRowProportions(){for(var t,e=0,i=0;i<this.rowCount;i++)(t=this.rowProportions[i])>0&&(e+=t);return e}getChildAt(t,e){return this.sizerChildren[e*this.columnCount+t]}childToGridIndex(t,e){if(!t)return null;var i=this.sizerChildren.indexOf(t);return-1===i?null:(void 0===e&&(e={}),e.x=i%this.columnCount,e.y=Math.floor(i/this.columnCount),e)}}Object.assign(Lu.prototype,ju);var Ru=Lu;zr.register("gridSizer",(function(t,e,i,s,n,r,a,o,h){var l=new Ru(this.scene,t,e,i,s,n,r,a,o,h);return this.scene.add.existing(l),l})),Qr(window,"RexPlugins.UI.GridSizer",Ru);var Uu=function(){return this.rexSizer.hidden?0:(0===this.orientation?this.maxChildWidth:0)+this.space.left+this.space.right},Fu=function(){return this.rexSizer.hidden?0:(0===this.orientation?0:this.maxChildHeight)+this.space.top+this.space.bottom},Wu=function(t){void 0===t&&(t=[]);for(var e,i=this.sizerChildren,s=0,n=i.length;s<n;s++)"\n"!==(e=i[s])&&e.isRexSizer&&t.push(e);return t},Yu=function(t){var e=t.rexSizer.padding;return Fl(t)+e.left+e.right},Au=function(t){var e=t.rexSizer.padding;return Wl(t)+e.top+e.bottom},Hu=function(t){for(var e,i,s,n,r,a={lines:[],width:0,height:0},o=this.sizerChildren,h=0,l=a.lines,d=0,c=o.length;d<c;d++){if("\n"===(e=o[d]))e=void 0,i=0,r=!0;else{if(e.rexSizer.hidden)continue;e.isRexSizer&&e.layout(),r=h<(i=0===this.orientation?Yu(e):Au(e))}r&&(n&&(n.width=t-(h+this.space.item),a.width=Math.max(a.width,n.width),a.height+=n.height+this.space.line),n={children:[],height:0},l.push(n),h=t),h-=i+this.space.item,e&&(n.children.push(e),s=0===this.orientation?Au(e):Yu(e),n.height=Math.max(n.height,s))}return n&&(n.width=t-(h+this.space.item),a.width=Math.max(a.width,n.width),a.height+=n.height),a},Vu=function(t,e,i){return e/t<=.25?e/(i-1):0},Nu=function(t,e,i){if(this.rexSizer.hidden||!this.dirty)return this;var s;this.preLayout(t),void 0===e&&(e=Math.max(this.maxChildWidth+this.space.left+this.space.right,this.minWidth)),void 0===i&&(i=Math.max(this.maxChildHeight+this.space.top+this.space.bottom,this.minHeight)),s=0===this.orientation?e-this.space.left-this.space.right:i-this.space.top-this.space.bottom;var n=Hu.call(this,s);0===this.orientation?i=Math.max(i,n.height+this.space.top+this.space.bottom):e=Math.max(e,n.height+this.space.left+this.space.right),this.resize(e,i);for(var r,a,o,h,l,d,c,u,p,g,m=0,f=this.innerLeft,v=this.innerTop,b=f,x=v,y=n.lines,w=0,k=y.length;w<k;w++){switch(p=(u=y[w]).children,this.rtl&&p.reverse(),g=s-u.width,this.align){case 0:break;case 1:0===this.orientation?b+=g:x+=g;break;case 2:0===this.orientation?b+=g/2:x+=g/2;break;case 3:m=Vu(s,g,p.length);break;case 4:0===(m=Vu(s,g,p.length))&&(0===this.orientation?b+=g:x+=g);break;case 5:0===(m=Vu(s,g,p.length))&&(0===this.orientation?b+=g/2:x+=g/2)}for(var C=0,_=p.length;C<_;C++)o=(a=(r=p[C]).rexSizer).padding,0===this.orientation?(h=b+o.left,C>0&&(h+=this.space.item),l=x+o.top,d=Fl(r),c=Wl(r),b=h+d+o.right+m):(h=b+o.left,l=x+o.top,C>0&&(l+=this.space.item),d=Fl(r),x=l+(c=Wl(r))+o.bottom+m),Rl.setPosition(h,l).setSize(d,c),dd(r,Rl,a.align),this.resetChildPositionState(r);0===this.orientation?(b=f,x+=u.height+this.space.line):(b+=u.height+this.space.line,x=v)}return this.layoutBackgrounds(),this.postLayout()},Gu=function(){Id.call(this),this._maxChildWidth=void 0,this._maxChildHeight=void 0};const Xu=Phaser.Utils.Objects.IsPlainObject,Ju=Phaser.Utils.Objects.GetValue,Ku=Phaser.Display.Align.CENTER;var Zu=function(t,e,i,s){if("\n"===t)return this.addNewLine(),this;var n;(this.pin(t),Xu(e))&&(e=Ju(n=e,"padding",0),i=Ju(n,"key",void 0),s=Ju(n,"index",void 0));return void 0===e&&(e=0),(n=this.getSizerConfig(t)).align=Ku,n.padding=vd(e),void 0===s||s>=this.sizerChildren.length?this.sizerChildren.push(t):this.sizerChildren.splice(s,0,t),void 0!==i&&this.addChildrenMap(i,t),this},qu={add(t,e,i){if(Mh(t))for(var s=t,n=0,r=s.length;n<r;n++)Zu.call(this,s[n],e);else Zu.call(this,t,e,i);return this},addNewLine(){return this.sizerChildren.push("\n"),this},insert(t,e,i,s){return Zu.call(this,e,i,s,t),this}};const $u=Phaser.Utils.Array.Remove,Qu=Lh.prototype.remove,tp=Lh.prototype.clear;var ep={remove(t,e){return this.getParentSizer(t)!==this||($u(this.sizerChildren,t),Qu.call(this,t,e)),this},removeAll(t){for(var e=0,i=this.sizerChildren.length;e<i;e++)Qu.call(this,this.sizerChildren[e],t);return this.sizerChildren.length=0,this},clear(t){return this.sizerChildren.length=0,this.backgroundChildren&&(this.backgroundChildren.length=0),tp.call(this,t),this}},ip={getChildrenWidth:Uu,getChildrenHeight:Fu,getChildrenSizers:Wu,_layout:Nu,_layoutInit:Gu};Object.assign(ip,qu,ep);var sp=ip,np=function(t){void 0===t&&(t=this.sizerChildren);for(var e,i,s=0,n=0,r=t.length;n<r;n++)"\n"!==(e=t[n])&&(i=e.isRexSizer?Math.max(e.minWidth,e.childrenWidth):Fl(e),s=Math.max(i,s));return s},rp=function(t){void 0===t&&(t=this.sizerChildren);for(var e,i,s=0,n=0,r=t.length;n<r;n++)"\n"!==(e=t[n])&&(i=e.isRexSizer?Math.max(e.minHeight,e.childrenHeight):Wl(e),s=Math.max(i,s));return s};const ap=Phaser.Utils.Objects.IsPlainObject,op=Phaser.Utils.Objects.GetValue;class hp extends Wc{constructor(t,e,i,s,n,r){ap(e)?(e=op(r=e,"x",0),i=op(r,"y",0),s=op(r,"width",void 0),n=op(r,"height",void 0)):ap(s)&&(s=op(r=s,"width",void 0),n=op(r,"height",void 0)),super(t,e,i,s,n,r),this.type="rexFixWidthSizer",this.sizerChildren=[],this.setOrientation(op(r,"orientation",0)),this.setItemSpacing(op(r,"space.item",0)),this.setLineSpacing(op(r,"space.line",0)),this.setAlign(op(r,"align",0)),this.setRTL(op(r,"rtl",!1)),this.addChildrenMap("items",this.sizerChildren)}destroy(t){this.scene&&(this.sizerChildren.length=0,super.destroy(t))}setOrientation(t){return this.orientation=lu(t),this}setItemSpacing(t){return this.space.item=t,this}setLineSpacing(t){return this.space.line=t,this}setAlign(t){return"string"==typeof t&&(t=lp[t]),this.align=t,this}setRTL(t){return void 0===t&&(t=!0),this.rtl=t,this}get maxChildWidth(){return void 0===this._maxChildWidth&&(this._maxChildWidth=np.call(this)),this._maxChildWidth}get maxChildHeight(){return void 0===this._maxChildHeight&&(this._maxChildHeight=rp.call(this)),this._maxChildHeight}}const lp={left:0,top:0,right:1,bottom:1,center:2,justify:3,"justify-left":3,"justify-top":3,"justify-right":4,"justify-bottom":4,"justify-center":5};Object.assign(hp.prototype,sp);var dp=hp;zr.register("fixWidthSizer",(function(t,e,i,s,n){var r=new dp(this.scene,t,e,i,s,n);return this.scene.add.existing(r),r})),Qr(window,"RexPlugins.UI.FixWidthSizer",dp);var cp=function(){if(this.rexSizer.hidden)return 0;var t,e,i,s=0,n=this.sizerChildren;for(var r in n)i=(t=n[r]).isRexSizer?Math.max(t.minWidth,t.childrenWidth):Fl(t),i+=(e=t.rexSizer.padding).left+e.right,s=Math.max(i,s);return s+this.space.left+this.space.right},up=function(){if(this.rexSizer.hidden)return 0;var t,e,i,s=0,n=this.sizerChildren;for(var r in n)i=(t=n[r]).isRexSizer?Math.max(t.minHeight,t.childrenHeight):Wl(t),i+=(e=t.rexSizer.padding).top+e.bottom,s=Math.max(i,s);return s+this.space.top+this.space.bottom},pp=function(t){void 0===t&&(t=[]);var e,i=this.sizerChildren;for(var s in i)(e=i[s]).isRexSizer&&t.push(e);return t},gp=function(t,e){var i,s=e.rexSizer,n=s.padding;return s.expandWidth&&(i=t.innerWidth-n.left-n.right),i},mp=function(t,e){var i,s=e.rexSizer,n=s.padding;return s.expandHeight&&(i=t.innerHeight-n.top-n.bottom),i},fp=function(t,e,i){if(this.rexSizer.hidden||!this.dirty)return this;var s,n,r;this.preLayout(t),void 0===e&&(e=Math.max(this.childrenWidth,this.minWidth)),void 0===i&&(i=Math.max(this.childrenHeight,this.minHeight)),this.resize(e,i);var a,o,h,l,d,c,u=this.innerLeft,p=this.innerTop,g=this.innerWidth,m=this.innerHeight,f=this.sizerChildren;for(var v in f)r=(n=(s=f[v]).rexSizer).padding,s.isRexSizer?s._layout(this,gp(this,s),mp(this,s)):(d=void 0,c=void 0,n.expandWidth&&(d=g-r.left-r.right),n.expandHeight&&(c=m-r.top-r.bottom),zc(s,d,c)),a=u+r.left,h=g-r.left-r.right,o=p+r.top,l=m-r.top-r.bottom,Rl.setPosition(a,o).setSize(h,l),dd(s,Rl,n.align),this.resetChildPositionState(s);return this.layoutBackgrounds(),this.postLayout()};const vp=Phaser.Utils.Objects.IsPlainObject,bp=Phaser.Utils.Objects.GetValue,xp=Phaser.Display.Align.CENTER;var yp={add(t,e,i,s,n){var r;(this.pin(t),vp(e))&&(e=bp(r=e,"key",void 0),i=bp(r,"align",xp),s=bp(r,"padding",0),n=bp(r,"expand",!0));return void 0===e&&(e=Date.now()),"string"==typeof i&&(i=Dl[i]),void 0===i&&(i=xp),void 0===s&&(s=0),void 0===n&&(n=!0),(r=this.getSizerConfig(t)).align=i,r.padding=vd(s),vp(n)?(r.expandWidth=bp(n,"width",!1),r.expandHeight=bp(n,"height",!1)):(r.expandWidth=n,r.expandHeight=n),this.sizerChildren.hasOwnProperty(e)&&this.sizerChildren[e].destroy(),this.sizerChildren[e]=t,this}};const wp=Lh.prototype.remove,kp=Lh.prototype.clear;var Cp={remove(t,e){var i;if("string"==typeof t){if(i=t,!this.sizerChildren.hasOwnProperty(i))return this}else{if(this.getParentSizer(t)!==this)return this;i=this.childToKey(t)}return delete this.sizerChildren[i],wp.call(this,t,e),this},removeAll(t){var e;for(var i in this.sizerChildren)e=this.sizerChildren[i],delete this.sizerChildren[i],wp.call(this,e,t);return this},clear(t){return this.removeAll(t),this.backgroundChildren&&(this.backgroundChildren.length=0),kp.call(this,t),this}},_p={getChildrenWidth:cp,getChildrenHeight:up,getChildrenSizers:pp,_layout:fp};Object.assign(_p,yp,Cp);var Sp=_p,Tp=function(t,e){if(Array.isArray(t))return t.indexOf(e);for(var i in t)if(t[i]===e)return i;return null};const Op=Phaser.Utils.Objects.IsPlainObject,Ep=Phaser.Utils.Objects.GetValue;class Pp extends Wc{constructor(t,e,i,s,n,r){Op(e)?(e=Ep(r=e,"x",0),i=Ep(r,"y",0),s=Ep(r,"width",void 0),n=Ep(r,"height",void 0)):Op(s)&&(s=Ep(r=s,"width",void 0),n=Ep(r,"height",void 0)),super(t,e,i,s,n,r),this.type="rexOverlapSizer",this.sizerChildren={},this.addChildrenMap("items",this.sizerChildren)}destroy(t){this.scene&&(xa(this.sizerChildren),super.destroy(t))}childToKey(t){if("string"!=typeof t)return Tp(this.sizerChildren,t);var e=t;return this.sizerChildren.hasOwnPropery(e)?e:null}}Object.assign(Pp.prototype,Sp);var Mp=Pp;zr.register("overlapSizer",(function(t,e,i,s,n){var r=new Mp(this.scene,t,e,i,s,n);return this.scene.add.existing(r),r})),Qr(window,"RexPlugins.UI.OverlapSizer",Mp);const Ip=Phaser.GameObjects.Graphics;const Bp={rectangle:0,circle:1};var jp=class extends Ip{constructor(t,e,i){void 0===e&&(e=0),"string"==typeof e&&(e=Bp[e]),void 0===i&&(i=0),super(t.scene),this.parent=t,this.shape=e,this.padding=i,this.setPosition().resize()}destroy(){return this.parent=void 0,super.destroy(),this}setPosition(t,e){var i=this.parent;return void 0===t&&(t=i.x),void 0===e&&(e=i.y),super.setPosition(t,e),this}resize(t,e,i){var s=this.parent;if(void 0===t&&(t=s.width),void 0===e&&(e=s.height),void 0===i&&(i=this.padding),this.widthSave===t&&this.heightSave===e&&this.paddingSave===i)return this;switch(this.clear().fillStyle(16777215),this.shape){case 1:var n=Math.min(t,e)/2;this.fillCircle(0,0,n+i);break;default:this.fillRect(-t*s.originX-i,-e*s.originY-i,t+2*i,e+2*i)}return this.widthSave=t,this.heightSave=e,this.paddingSave=i,this}},zp=function(t,e,i,s){var n=new jp(e,i,s);return t&&!t.isRexSizer&&t.setMask(n.createGeometryMask()),this.pin(n),n};const Dp=Phaser.Utils.Objects.GetValue;class Lp extends pu{constructor(t,e){super(t,e),this.type="rexLabel";var i=Dp(e,"background",void 0),s=Dp(e,"icon",void 0),n=Dp(e,"iconMask",void 0),r=Dp(e,"text",void 0),a=Dp(e,"action",void 0),o=Dp(e,"actionMask",void 0),h=Dp(e,"align",void 0),l=Dp(e,"space.icon",0),d=Dp(e,"space.text",0);(i&&this.addBackground(i),"right"!==h&&"bottom"!==h&&"center"!==h||this.addSpace(),s)&&(0===this.orientation?(r||a)&&(u={right:l}):(r||a)&&(u={bottom:l}),this.add(s,0,"center",u),n&&(n=this.addChildMask(s,s,1)));if(r){var c,u,p,g=Dp(e,"expandTextWidth",!1),m=Dp(e,"expandTextHeight",!1);0===this.orientation?(c=g?1:0,a&&(u={right:d}),p=m):(c=m?1:0,a&&(u={bottom:d}),p=g),this.add(r,c,"center",u,p)}a&&(this.add(a),o&&(o=this.addChildMask(a,a,1))),"center"===h&&this.addSpace(),this.addChildrenMap("background",i),this.addChildrenMap("icon",s),this.addChildrenMap("iconMask",n),this.addChildrenMap("text",r),this.addChildrenMap("action",a),this.addChildrenMap("actionMask",o)}get text(){var t=this.childrenMap.text;return void 0===t?"":t.text?t.text:t.getData("text")}set text(t){var e=this.childrenMap.text;void 0!==e&&(e.setText?e.setText(t):e.setData("text",t))}setText(t){return this.text=t,this}appendText(t){return this.text+=t,this}_layout(t,e,i){if(this.rexSizer.hidden||!this.dirty)return this;super._layout(t,e,i);var s=this.childrenMap.iconMask;s&&(s.setPosition(),this.resetChildPositionState(s));var n=this.childrenMap.actionMask;return n&&(n.setPosition(),this.resetChildPositionState(n)),this}resize(t,e){super.resize(t,e);var i=this.childrenMap.iconMask;i&&i.resize();var s=this.childrenMap.actionMask;return s&&s.resize(),this}}var Rp={addChildMask:zp};Object.assign(Lp.prototype,Rp);var Up=Lp;zr.register("label",(function(t){var e=new Up(this.scene,t);return this.scene.add.existing(e),e})),Qr(window,"RexPlugins.UI.Label",Up);const Fp=Phaser.Utils.Objects.GetValue;class Wp{constructor(t,e){this.gameObject=t,this.scene=Wd(t),this.setEventEmitter(Fp(e,"eventEmitter",void 0)),this._enable=void 0,t.setInteractive(Fp(e,"inputConfig",void 0)),this.resetFromJSON(e),this.boot()}resetFromJSON(t){return this.pointer=void 0,this.lastClickTime=void 0,this.setEnable(Fp(t,"enable",!0)),this.setMode(Fp(t,"mode",1)),this.setClickInterval(Fp(t,"clickInterval",100)),this.setDragThreshold(Fp(t,"threshold",void 0)),this}boot(){this.gameObject.on("pointerdown",this.onPress,this),this.gameObject.on("pointerup",this.onRelease,this),this.gameObject.on("pointerout",this.onPointOut,this),this.gameObject.on("pointermove",this.onMove,this),this.gameObject.on("destroy",this.destroy,this)}shutdown(){this.destroyEventEmitter(),this.pointer=null,this.gameObject=null,this.scene=null}destroy(){this.shutdown()}get enable(){return this._enable}set enable(t){if(this._enable!==t){t||this.cancel(),this._enable=t;var e=t?"enable":"disable";this.emit(e,this,this.gameObject)}}setEnable(t){return void 0===t&&(t=!0),this.enable=t,this}toggleEnable(){return this.setEnable(!this.enable),this}setMode(t){return"string"==typeof t&&(t=Yp[t]),this.mode=t,this}setClickInterval(t){return this.clickInterval=t,this}setDragThreshold(t){return this.dragThreshold=t,this}onPress(t,e,i,s){void 0===this.pointer&&(this.pointer=t,0===this.mode&&this.click(t.downTime,t,s))}onRelease(t,e,i,s){this.pointer===t&&(1===this.mode&&this.click(t.upTime,t,s),this.pointer=void 0)}onPointOut(t,e){this.pointer===t&&this.cancel()}onMove(t,e,i,s){this.pointer===t&&void 0!==this.dragThreshold&&t.getDistance()>=this.dragThreshold&&this.cancel()}click(t,e,i){if(!this.enable)return this;if(void 0===t)return this.emit("click",this,this.gameObject,e,i),this;this.pointer=void 0;var s=this.lastClickTime;return void 0!==s&&t-s<=this.clickInterval||(this.lastClickTime=t,this.emit("click",this,this.gameObject,e,i)),this}cancel(){return this.pointer=void 0,this}}Object.assign(Wp.prototype,Rd);const Yp={press:0,pointerdown:0,release:1,pointerup:1};var Ap=Wp,Hp=Ap,Vp=function(t,e){t._buttonBehavior=new Hp(t,e),t._buttonBehavior.on("click",(function(t,e,i,s){Np.call(this,"button.click",e,i,s)}),this).on("enable",(function(t,e){Np.call(this,"button.enable",e)}),this).on("disable",(function(t,e){Np.call(this,"button.disable",e)}),this),t.on("pointerover",(function(e,i,s,n){Np.call(this,"button.over",t,e,n)}),this).on("pointerout",(function(e,i){Np.call(this,"button.out",t,e,i)}),this)},Np=function(t,e,i,s){var n;if("number"==typeof e){if(n=e,!(e=this.buttons[n]))return}else if(-1===(n=this.buttons.indexOf(e)))return;this.eventEmitter!==this&&this.emit(t,e,n,i,s),void 0!==this.groupName?this.eventEmitter.emit(t,e,this.groupName,n,i,s):this.eventEmitter.emit(t,e,n,i,s)};const Gp=pu.prototype.add,Xp=pu.prototype.addSpace,Jp=pu.prototype.insert;var Kp=function(t){if(0===this.buttons.length){if(!this.buttonsExpand)switch(this.buttonsAlign){case"right":case"bottom":case"center":Xp.call(this)}Gp.call(this,t,this.buttonProportion,"center",0,!0),this.buttonsExpand||"center"===this.buttonsAlign&&Xp.call(this)}else{var e=this.sizerChildren.length-1;this.sizerChildren[e].isRexSpace?Jp.call(this,e,t,this.buttonProportion,"center",0,!0):Gp.call(this,t,this.buttonProportion,"center",0,!0)}return this.buttons.push(t),Vp.call(this,t,this.clickConfig),this},Zp={addButton(t){if(Mh(t))for(var e=t,i=0,s=e.length;i<s;i++)Kp.call(this,e[i]);else Kp.call(this,t);return this},addButtons(t){for(var e=0,i=t.length;e<i;e++)Kp.call(this,t[e]);return this}};const qp=Phaser.Utils.Array.Remove,$p=pu.prototype.remove,Qp=pu.prototype.clear;var tg=function(t,e){return(t=this.getButton(t))?(1===this.buttons.length?this.clear(e):(qp(this.buttons,t),$p.call(this,t,e)),this):this},eg={remove(t,e){if(Mh(t))for(var i=t,s=0,n=i.length;s<n;s++)tg.call(this,i[s],e);else tg.call(this,t,e);return this},clear(t){return this.buttons.length=0,Qp.call(this,t),this},removeButton(t,e){return this.remove(t,e),this},clearButtons(t){return this.clear(t),this}},ig=function(t,e){return t?t.hasOwnProperty("name")?t.name===e?t:null:GetElementByName(t,e):null},sg=function(t,e){if(!t)return null;if(Mh(t)){for(var i,s=0,n=t.length;s<n;s++)if(i=ig(t[s],e))return i}else for(var r in t)if(i=ig(t[r],e))return i},ng=function(t){og(t,!1)},rg=function(t){og(t,!0)},ag=function(t){return!!t&&!Il(t).hidden},og=function(t,e){t&&(Il(t).hidden=e,t.setVisible(!e))},hg={getButton(t){var e;switch(typeof t){case"number":e=this.buttons[t];break;case"string":e=sg(this.buttons,t);break;default:e=t,-1===this.buttons.indexOf(e)&&(e=void 0)}return e},setButtonEnable(t,e){if(void 0===t||"boolean"==typeof t){e=t;for(var i=0,s=this.buttons.length;i<s;i++)this.buttons[i]._buttonBehavior.setEnable(e)}else this.getButton(t)._buttonBehavior.setEnable(e);return this},toggleButtonEnable(t){if(void 0===t||"boolean"==typeof t)for(var e=0,i=this.buttons.length;e<i;e++)this.buttons[e]._buttonBehavior.toggleEnable();else this.getButton(t)._buttonBehavior.toggleEnable();return this},getButtonEnable(t){return void 0===t&&(t=0),this.getButton(t)._buttonBehavior.enable},emitButtonClick(t){return Np.call(this,"button.click",t),this},showButton(t){return ng(this.getButton(t)),this},hideButton(t){return rg(this.getButton(t)),this},isButtonShown(t){return ag(this.getButton(t)),this},forEachButtton(t,e){for(var i=0,s=this.buttons.length;i<s;i++)e?t.call(e,this.buttons[i],i,this.buttons):t(this.buttons[i],i,this.buttons);return this}};const lg=Phaser.Utils.Objects.GetValue;var dg=function(t,e){void 0===e&&(e=!1);var i=lg(t,"dataManager",void 0),s=lg(t,"setValueCallback",void 0),n=lg(t,"setValueCallbackScope",void 0);void 0===i&&(this.setDataEnabled(),i=this.data),this.buttons.forEach((function(t){var r=t.name;s&&i.events.on("changedata-"+r,(function(e,i,r){n?s.call(n,t,i,r):s(t,i,r)}),this),i.set(r,void 0),i.set(r,e)})),this._dataManager=i},cg=function(t){dg.call(this,t),this._value=void 0,Object.defineProperty(this,"value",{get:function(){return this._value}.bind(this),set:function(t){if(t!==this._value){this._value=t;var e=this._dataManager;this.buttons.forEach((function(i){var s=i.name,n=e.get(s);s===t?n||e.set(s,!0):n&&e.set(s,!1)}))}}.bind(this),enumerable:!0,configurable:!0}),this.on("button.click",(function(t){this.value=t.name}),this)},ug=function(t){dg.call(this,t),this.on("button.click",(function(t){var e=this._dataManager,i=t.name,s=e.get(i);e.set(i,!s)}),this)};const pg=Phaser.Utils.Objects.GetValue,gg={radio:cg,checkboxes:ug};var mg=function(t){var e=pg(t,"type",void 0);e&&gg.hasOwnProperty(e)&&gg[e].call(this,t)};const fg=Phaser.Utils.Objects.GetValue;class vg extends pu{constructor(t,e){void 0===e&&(e={});var i=e.space;"number"==typeof i&&(e.space={item:i}),super(t,e),this.type="rexButtons",this.eventEmitter=fg(e,"eventEmitter",this),this.groupName=fg(e,"groupName",void 0),this.buttons=[];var s=fg(e,"background",void 0),n=fg(e,"buttons",void 0);this.buttonsExpand=fg(e,"expand",!1),this.buttonsAlign=fg(e,"align",void 0),this.buttonProportion=this.buttonsExpand?1:0,this.clickConfig=fg(e,"click",void 0),s&&this.addBackground(s),n&&this.addButtons(n),mg.call(this,e),this.addChildrenMap("background",s),this.addChildrenMap("buttons",this.buttons)}}Object.assign(vg.prototype,Zp,eg,hg);var bg=vg;zr.register("buttons",(function(t){var e=new bg(this.scene,t);return this.scene.add.existing(e),e})),Qr(window,"RexPlugins.UI.Buttons",bg);const xg=Ru.prototype.add;var yg={addButton(t,e,i){return xg.call(this,t,e,i,void 0,0,this.buttonsExpand),this.buttons.push(t),Vp.call(this,t,this.clickConfig),this},addButtons(t,e){for(var i=0,s=t;i<s;i++)this.addButton(t[i],void 0,e);return this}};const wg=Phaser.Utils.Array.Remove,kg=Ru.prototype.remove,Cg=Ru.prototype.clear;var _g=function(t,e){return(t=this.getButton(t))?(wg(this.buttons,t),kg.call(this,t,e),this):this},Sg={remove(t,e){if(Mh(t))for(var i=t,s=0,n=i.length;s<n;s++)_g.call(this,i[s],e);else _g.call(this,t,e);return this},clear(t){return this.buttons.length=0,Cg.call(this,t),this},removeButton(t,e){return this.remove(t,e),this},clearButtons(t){return this.clear(t),this}};const Tg=Phaser.Utils.Objects.GetValue;class Og extends Ru{constructor(t,e){void 0===e&&(e={});var i=Tg(e,"row",0),s=Tg(e,"col",0),n=Tg(e,"buttons",void 0),r=Tg(e,"expand",!0),a=r?1:0;if(void 0!==n){i=Math.max(i,n.length);for(var o=0,h=n.length;o<h;o++)s=Math.max(s,n[o].length)}e.row=i,e.column=s,e.columnProportions=a,e.rowProportions=a,super(t,e),this.type="rexGridButtons",this.eventEmitter=Tg(e,"eventEmitter",this),this.groupName=Tg(e,"groupName",void 0),this.buttons=[];var l=Tg(e,"background",void 0);this.buttonsExpand=r;var d=Tg(e,"space",void 0);if("number"==typeof d&&(d={itemX:d,itemY:d}),this.clickConfig=Tg(e,"click",void 0),l&&this.addBackground(l),n)for(var c,u,p=0,g=n.length;p<g;p++)for(var m=0,f=(c=n[p]).length;m<f;m++)(u=c[m])&&this.addButton(u,m,p);mg.call(this,e),this.addChildrenMap("background",l),this.addChildrenMap("buttons",this.buttons)}}Object.assign(Og.prototype,yg,Sg,hg);var Eg=Og;zr.register("gridButtons",(function(t){var e=new Eg(this.scene,t);return this.scene.add.existing(e),e})),Qr(window,"RexPlugins.UI.GridButtons",Eg);const Pg=dp.prototype.add;var Mg=function(t){return Pg.call(this,t),this.buttons.push(t),Vp.call(this,t,this.clickConfig),this},Ig={addButton(t){if(Mh(t))for(var e=t,i=0,s=e.length;i<s;i++)Mg.call(this,e[i]);else Mg.call(this,t);return this},addButtons(t){if(Mh(t[0]))for(var e,i=t,s=0,n=i.length-1;s<=n;s++){for(var r=0,a=(e=i[s]).length;r<a;r++)Mg.call(this,e[r]);s>n&&Pg.addNewLine(this)}else for(r=0,a=t.length;r<a;r++)Mg.call(this,t[r]);return this}};const Bg=Phaser.Utils.Array.Remove,jg=dp.prototype.remove,zg=dp.prototype.clear;var Dg=function(t,e){return(t=this.getButton(t))?(1===this.buttons.length?this.clear(e):(Bg(this.buttons,t),jg.call(this,t,e)),this):this},Lg={remove(t,e){if(Mh(t))for(var i=t,s=0,n=i.length;s<n;s++)Dg.call(this,i[s],e);else Dg.call(this,t,e);return this},clear(t){return this.buttons.length=0,zg.call(this,t),this},removeButton(t,e){return this.remove(t,e),this},clearButtons(t){return this.clear(t),this}};const Rg=Phaser.Utils.Objects.GetValue;class Ug extends dp{constructor(t,e){void 0===e&&(e={});var i=e.space;"number"==typeof i&&(e.space={item:i,line:i}),super(t,e),this.type="rexFixWidthButtons",this.eventEmitter=Rg(e,"eventEmitter",this),this.groupName=Rg(e,"groupName",void 0),this.buttons=[];var s=Rg(e,"background",void 0),n=Rg(e,"buttons",void 0);this.buttonsAlign=Rg(e,"align",void 0),this.clickConfig=Rg(e,"click",void 0),s&&this.addBackground(s),n&&this.addButtons(n),mg.call(this,e),this.addChildrenMap("background",s),this.addChildrenMap("buttons",this.buttons)}}Object.assign(Ug.prototype,Ig,Lg,hg);var Fg=Ug;zr.register("fixWidthButtons",(function(t){var e=new Fg(this.scene,t);return this.scene.add.existing(e),e})),Qr(window,"RexPlugins.UI.FixWidthButtons",Fg);var Wg={getChoice(t){return this.childrenMap.choicesSizer.getButton(t)},getAction(t){return this.childrenMap.actionsSizer.getButton(t)},getToolbar(t){return this.childrenMap.toolbarSizer.getButton(t)},getLeftToolbar(t){return this.childrenMap.leftToolbarSizer.getButton(t)},setChoiceEnable(t,e){return this.childrenMap.choicesSizer.setButtonEnable(t,e),this},setActionEnable(t,e){return this.childrenMap.actionsSizer.setButtonEnable(t,e),this},setToolbarEnable(t,e){return this.childrenMap.toolbarSizer.setButtonEnable(t,e),this},setLeftToolbarEnable(t,e){return this.childrenMap.leftToolbarSizer.setButtonEnable(t,e),this},toggleChoiceEnable(t){return this.childrenMap.choicesSizer.toggleButtonEnable(t),this},toggleActionEnable(t){return this.childrenMap.actionsSizer.toggleButtonEnable(t),this},toggleToolbarEnable(t){return this.childrenMap.toolbarSizer.toggleButtonEnable(t),this},toggleLeftToolbarEnable(t){return this.childrenMap.leftToolbarSizer.toggleButtonEnable(t),this},getChoiceEnable(t){return this.childrenMap.choicesSizer.getButtonEnable(t)},getActionEnable(t){return this.childrenMap.actionsSizer.getButtonEnable(t)},getToolbarEnable(t){return this.childrenMap.toolbarSizer.getButtonEnable(t)},getLeftToolbarEnable(t){return this.childrenMap.leftToolbarSizer.getButtonEnable(t)},emitChoiceClick(t){return this.childrenMap.choicesSizer.emitButtonClick(t),this},emitActionClick(t){return this.childrenMap.actionsSizer.emitButtonClick(t),this},emitToolbarClick(t){return this.childrenMap.toolbarSizer.emitButtonClick(t),this},emitLeftToolbarClick(t){return this.childrenMap.leftToolbarSizer.emitButtonClick(t),this},showChoice(t){return this.childrenMap.choicesSizer.showButton(t),this},showAction(t){return this.childrenMap.actionsSizer.showButton(t),this},showToolbar(t){return this.childrenMap.toolbarSizer.showButton(t),this},showLeftToolbar(t){return this.childrenMap.leftToolbarSizer.showButton(t),this},hideChoice(t){return this.childrenMap.choicesSizer.hideButton(t),this},hideAction(t){return this.childrenMap.actionsSizer.hideButton(t),this},hideToolbar(t){return this.childrenMap.toolbarSizer.hideButton(t),this},hideLeftToolbar(t){return this.childrenMap.leftToolbarSizer.hideButton(t),this},addChoice(t){return this.childrenMap.choicesSizer.addButton(t),this},addAction(t){return this.childrenMap.actionsSizer.addButton(t),this},addToolbar(t){return this.childrenMap.toolbarSizer.addButton(t),this},addLeftToolbar(t){return this.childrenMap.leftToolbarSizer.addButton(t),this},removeChoice(t,e){return this.childrenMap.choicesSizer.removeButton(t,e),this},removeAction(t,e){return this.childrenMap.actionsSizer.removeButton(t,e),this},removeToolbar(t,e){return this.childrenMap.toolbarSizer.removeButton(t,e),this},removeLeftToolbar(t,e){return this.childrenMap.leftToolbarSizer.removeButton(t,e),this},clearChoices(t){return this.childrenMap.choicesSizer.clearButtons(t),this},clearActions(t){return this.childrenMap.actionsSizer.clearButtons(t),this},clearToolbar(t){return this.childrenMap.toolbarSizer.clearButtons(t),this},clearLeftToolbar(t){return this.childrenMap.leftToolbarSizer.clearButtons(t),this},forEachChoice(t,e){return this.childrenMap.choicesSizer.forEachButtton(t,e),this},forEachAction(t,e){return this.childrenMap.actionsSizer.forEachButtton(t,e),this},forEachToolbar(t,e){return this.childrenMap.toolbarSizer.forEachButtton(t,e),this},forEachLeftToolbar(t,e){return this.childrenMap.leftToolbarSizer.forEachButtton(t,e),this}};const Yg=Phaser.Utils.Objects.GetValue;class Ag extends pu{constructor(t,e){void 0===e&&(e={}),e.orientation=1,super(t,e),this.type="rexDialog",this.eventEmitter=Yg(e,"eventEmitter",this);var i,s,n,r,a=Yg(e,"background",void 0),o=Yg(e,"title",void 0),h=Yg(e,"toolbar",void 0),l=Yg(e,"toolbarBackground",void 0),d=Yg(e,"leftToolbar",void 0),c=Yg(e,"leftToolbarBackground",void 0),u=Yg(e,"content",void 0),p=Yg(e,"description",void 0),g=Yg(e,"choices",void 0),m=Yg(e,"choicesBackground",void 0),f=Yg(e,"actions",void 0),v=Yg(e,"actionsBackground",void 0),b=Yg(e,"click",void 0);if(a&&this.addBackground(a),h&&(n=new bg(t,{groupName:"toolbar",background:l,buttons:h,orientation:0,space:{item:Yg(e,"space.toolbarItem",0)},click:b,eventEmitter:this.eventEmitter})),d&&(r=new bg(t,{groupName:"leftToolbar",background:c,buttons:d,orientation:0,space:{item:Yg(e,"space.leftToolbarItem",0)},click:b,eventEmitter:this.eventEmitter})),o&&!h&&!d){var x=Yg(e,"align.title","center"),y=Yg(e,"space.title",0);(u||p||g||f)&&(C={bottom:y});var w=Yg(e,"expand.title",!0);this.add(o,0,x,C,w)}if(h&&!o&&!d){y=Yg(e,"space.title",0);(u||p||g||f)&&(C={bottom:y});w=Yg(e,"expand.toolbar",!0);this.add(n,0,"right",C,w)}if(d&&!o&&!h){y=Yg(e,"space.title",0);(u||p||g||f)&&(C={bottom:y});w=Yg(e,"expand.leftToolbar",!0);this.add(r,0,"left",C,w)}if(o&&(h||d)){var k=new pu(t,{orientation:0});r&&k.add(r,0,"right",0,!1);x=Yg(e,"align.title","left");(w=Yg(e,"expand.title",!0))||"right"!==x&&"center"!==x||k.addSpace();var C={left:Yg(e,"space.titleLeft",0),right:Yg(e,"space.titleRight",0)},_=w?1:0;k.add(o,_,"center",C,w),w||"left"!==x&&"center"!==x||k.addSpace(),n&&k.add(n,0,"right",0,!1);y=Yg(e,"space.title",0);(u||p||g||f)&&(C={bottom:y}),this.add(k,0,"center",C,!0)}if(u){x=Yg(e,"align.content","center");var S=Yg(e,"space.content",0);C={left:Yg(e,"space.contentLeft",0),right:Yg(e,"space.contentRight",0),bottom:p||g||f?S:0},w=Yg(e,"expand.content",!0);this.add(u,0,x,C,w)}if(p){x=Yg(e,"align.description","center");var T=Yg(e,"space.description",0);C={left:Yg(e,"space.descriptionLeft",0),right:Yg(e,"space.descriptionRight",0),bottom:g||f?T:0},w=Yg(e,"expand.description",!0);this.add(p,0,x,C,w)}if(g){x=Yg(e,"align.choices","center");i=new bg(t,{groupName:"choices",background:m,buttons:g,orientation:1,space:{item:Yg(e,"space.choice",0)},click:b,eventEmitter:this.eventEmitter,type:Yg(e,"choicesType",void 0),setValueCallback:Yg(e,"choicesSetValueCallback",void 0),setValueCallbackScope:Yg(e,"choicesSetValueCallbackScope",void 0)});var O=Yg(e,"space.choices",0);C={left:Yg(e,"space.choicesLeft",0),right:Yg(e,"space.choicesRight",0),bottom:f?O:0},w=Yg(e,"expand.choices",!0);this.add(i,0,x,C,w)}if(f){s=new bg(t,{groupName:"actions",background:v,buttons:f,orientation:0,space:{item:Yg(e,"space.action",0)},expand:Yg(e,"expand.actions",!1),align:Yg(e,"align.actions","center"),click:b,eventEmitter:this.eventEmitter});C={left:Yg(e,"space.actionsLeft",0),right:Yg(e,"space.actionsRight",0)};this.add(s,0,"center",C,!0)}this.addChildrenMap("background",a),this.addChildrenMap("title",o),this.addChildrenMap("toolbar",h),this.addChildrenMap("leftToolbar",d),this.addChildrenMap("content",u),this.addChildrenMap("description",p),this.addChildrenMap("choices",g),this.addChildrenMap("actions",f),this.addChildrenMap("choicesSizer",i),this.addChildrenMap("actionsSizer",s),this.addChildrenMap("toolbarSizer",n),this.addChildrenMap("leftToolbarSizer",r)}}Object.assign(Ag.prototype,Wg);var Hg=Ag;zr.register("dialog",(function(t){var e=new Hg(this.scene,t);return this.scene.add.existing(e),e})),Qr(window,"RexPlugins.UI.Dialog",Hg);var Vg={getButtonsSizer(t){return this.childrenMap[t+"ButtonsSizer"]},getButton(t,e){var i=this.getButtonsSizer(t);return i?i.getButton(e):void 0},setButtonEnable(t,e,i){return this.getButtonsSizer(t).setButtonEnable(e,i),this},setLeftButtonEnable(t,e){return this.childrenMap.leftButtonsSizer.setButtonEnable(t,e),this},setRightButtonEnable(t,e){return this.childrenMap.rightButtonsSizer.setButtonEnable(t,e),this},setTopButtonEnable(t,e){return this.childrenMap.topButtonsSizer.setButtonEnable(t,e),this},setBottomButtonEnable(t,e){return this.childrenMap.bottomButtonsSizer.setButtonEnable(t,e),this},toggleButtonEnable(t,e){return this.getButtonsSizer(t).toggleButtonEnable(e),this},toggleLeftButtonEnable(t){return this.childrenMap.leftButtonsSizer.toggleButtonEnable(t),this},toggleRightButtonEnable(t){return this.childrenMap.rightButtonsSizer.toggleButtonEnable(t),this},toggleTopButtonEnable(t){return this.childrenMap.topButtonsSizer.toggleButtonEnable(t),this},toggleBottomButtonEnable(t){return this.childrenMap.bottomButtonsSizer.toggleButtonEnable(t),this},getButtonEnable(t,e){return this.getButtonsSizer(t).getButtonEnable(e)},getLeftButtonEnable(t){return this.childrenMap.leftButtonsSizer.getButtonEnable(t)},getRightButtonEnable(t){return this.childrenMap.rightButtonsSizer.getButtonEnable(t)},getTopButtonEnable(t){return this.childrenMap.topButtonsSizer.getButtonEnable(t)},getBottomButtonEnable(t){return this.childrenMap.bottomButtonsSizer.getButtonEnable(t)},emitButtonClick(t,e){var i=this.getButtonsSizer(t);return i?(i.emitButtonClick(e),this):this},emitLeftButtonClick(t){return this.childrenMap.leftButtonsSizer.emitButtonClick(t),this},emitRightButtonClick(t){return this.childrenMap.rightButtonsSizer.emitButtonClick(t),this},emitTopButtonClick(t){return this.childrenMap.topButtonsSizer.emitButtonClick(t),this},emitBottomButtonClick(t){return this.childrenMap.bottomButtonsSizer.emitButtonClick(t),this},getLeftButton(t){return this.childrenMap.leftButtonsSizer.getButton(t)},getRightButton(t){return this.childrenMap.rightButtonsSizer.getButton(t)},getTopButton(t){return this.childrenMap.topButtonsSizer.getButton(t)},getBottomButton(t){return this.childrenMap.bottomButtonsSizer.getButton(t)},showButton(t,e){return ng(this.getButton(t,e)),this},showLeftButton(t){return ng(this.getLeftButton(t)),this},showRightButton(t){return ng(this.getRightButton(t)),this},showTopButton(t){return ng(this.getTopButton(t)),this},showBottomButton(t){return ng(this.getBottomButton(t)),this},hideButton(t,e){return rg(this.getButton(t,e)),this},hideLeftButton(t){return rg(this.getLeftButton(t)),this},hideRightButton(t){return rg(this.getRightButton(t)),this},hideTopButton(t){return rg(this.getTopButton(t)),this},hideBottomButton(t){return rg(this.getBottomButton(t)),this},addButton(t,e){return this.getButtonsSizer(t).addButton(e),this},addLeftButton(t){return this.addButton("left",t),this},addRightButton(t){return this.addButton("right",t),this},addTopButton(t){return this.addButton("top",t),this},removeButton(t,e,i){return this.getButtonsSizer(t).removeButton(e,i),this},removeLeftButton(t,e){return this.removeButton("left",t,e),this},removeRightButton(t,e){return this.removeButton("right",t,e),this},removeTopButton(t,e){return this.removeButton("top",t,e),this},removeBottomButton(t,e){return this.removeButton("bottom",t,e),this},clearButtons(t,e){return this.getButtonsSizer(t).clearButtons(e),this},clearLeftButtons(t){return this.clearButtons("left",t),this},clearRightButtons(t){return this.clearButtons("right",t),this},clearTopButtons(t){return this.clearButtons("top",t),this},clearBottomButtonss(t){return this.clearButtons("bottom",t),this},forEachLeftButton(t,e){return this.childrenMap.leftButtonsSizer.forEachButtton(t,e),this},forEachRightButton(t,e){return this.childrenMap.rightButtonsSizer.forEachButtton(t,e),this},forEachTopButton(t,e){return this.childrenMap.topButtonsSizer.forEachButtton(t,e),this},forEachBottomButton(t,e){return this.childrenMap.bottomButtonsSizer.forEachButtton(t,e),this}};const Ng=Phaser.Utils.Objects.GetValue;class Gg extends Ru{constructor(t,e){void 0===e&&(e={}),e.column=3,e.row=3,super(t,e),this.type="rexTabs",this.eventEmitter=Ng(e,"eventEmitter",this);var i,s,n,r,a=Ng(e,"background",void 0),o=Ng(e,"panel",void 0),h=Ng(e,"leftButtons",void 0),l=Ng(e,"leftButtonsBackground",void 0),d=Ng(e,"rightButtons",void 0),c=Ng(e,"rightButtonsBackground",void 0),u=Ng(e,"topButtons",void 0),p=Ng(e,"topButtonsBackground",void 0),g=Ng(e,"bottomButtons",void 0),m=Ng(e,"bottomButtonsBackground",void 0),f=Ng(e,"click",void 0);if(a&&this.addBackground(a),o&&this.add(o,1,1,"center",0,!0),h){var v=Ng(e,"space.leftButtonsOffset",0),b=Ng(e,"space.leftButton",0);i=new bg(t,{groupName:"left",background:l,buttons:h,orientation:1,space:{item:b},align:Ng(e,"align.leftButtons",void 0),click:f,eventEmitter:this.eventEmitter});var x={top:v};this.add(i,0,1,"top",x,!1)}if(d){var y=Ng(e,"space.rightButtonsOffset",0),w=Ng(e,"space.rightButton",0);s=new bg(t,{groupName:"right",background:c,buttons:d,orientation:1,space:{item:w},align:Ng(e,"align.rightButtons",void 0),click:f,eventEmitter:this.eventEmitter});x={top:y};this.add(s,2,1,"top",x,!1)}if(u){var k=Ng(e,"space.topButtonsOffset",0),C=Ng(e,"space.topButton",0);n=new bg(t,{groupName:"top",background:p,buttons:u,orientation:0,space:{item:C},align:Ng(e,"align.topButtons",void 0),click:f,eventEmitter:this.eventEmitter});x={left:k};this.add(n,1,0,"left",x,!1)}if(g){var _=Ng(e,"space.bottomButtonsOffset",0),S=Ng(e,"space.bottomButton",0);r=new bg(t,{groupName:"bottom",background:m,buttons:g,orientation:0,space:{item:S},align:Ng(e,"align.bottomButtons",void 0),click:f,eventEmitter:this.eventEmitter});x={left:_};this.add(r,1,2,"left",x,!1)}this.addChildrenMap("background",a),this.addChildrenMap("panel",o),this.addChildrenMap("leftButtons",h),this.addChildrenMap("rightButtons",d),this.addChildrenMap("topButtons",u),this.addChildrenMap("bottomButtons",g),this.addChildrenMap("leftButtonsSizer",i),this.addChildrenMap("rightButtonsSizer",s),this.addChildrenMap("topButtonsSizer",n),this.addChildrenMap("bottomButtonsSizer",r)}}Object.assign(Gg.prototype,Vg);var Xg=Gg;zr.register("tabs",(function(t){var e=new Xg(this.scene,t);return this.scene.add.existing(e),e})),Qr(window,"RexPlugins.UI.Tabs",Xg);const Jg=Phaser.Math.Percent;var Kg=function(t,e,i){var s,n,r;return t.y===e.y?(s=Math.min(t.x,e.x),n=Math.max(t.x,e.x),r=Jg(i.x,s,n)):t.x===e.x&&(s=Math.min(t.y,e.y),n=Math.max(t.y,e.y),r=Jg(i.y,s,n)),r},Zg={},qg=function(t,e,i){this.enable&&(Zg.x=e,Zg.y=i,this.value=Kg(this.getStartPoint(),this.getEndPoint(),Zg))},$g={},Qg=function(t,e,i){this.enable&&t.isDown&&($g.x=t.worldX,$g.y=t.worldY,this.value=Kg(this.getStartPoint(),this.getEndPoint(),$g))},tm={},em=function(t,e){void 0===e&&(e=tm);var i=this.childrenMap.thumb,s=i.x,n=i.y;return Rl.setPosition(this.innerLeft,this.innerTop).setSize(this.innerWidth,this.innerHeight),dd(i,Rl,t),e.x=i.x,e.y=i.y,i.x=s,i.y=n,e};const im=Phaser.Display.Align.LEFT_CENTER,sm=Phaser.Display.Align.TOP_CENTER;var nm={},rm=function(t){if(void 0===t&&(t=nm),this.childrenMap.thumb){var e=0===this.orientation?im:sm;em.call(this,e,t)}else 0===this.orientation?(t.x=this.innerLeft+1,t.y=this.centerY):(t.x=this.centerX,t.y=this.innerTop+1);return t};const am=Phaser.Display.Align.RIGHT_CENTER,om=Phaser.Display.Align.BOTTOM_CENTER;var hm={},lm=function(t){if(void 0===t&&(t=hm),this.childrenMap.thumb){var e=0===this.orientation?am:om;em.call(this,e,t)}else 0===this.orientation?(t.x=this.innteRight-1,t.y=this.centerY):(t.x=this.centerX,t.y=this.innerBottom-1);return t};const dm=Phaser.Math.Linear;var cm={},um=function(t,e,i,s){return void 0===s&&(s=cm),s.x=dm(e.x,i.x,t),s.y=dm(e.y,i.y,t),s},pm=function(t){var e=this.childrenMap.thumb;return void 0===e||(void 0===t&&(t=this.value),um(t,this.getStartPoint(),this.getEndPoint(),e),this.resetChildPositionState(e)),this};const gm=Phaser.Display.Align.LEFT_CENTER,mm=Phaser.Display.Align.TOP_CENTER;var fm=function(t){var e,i,s=this.childrenMap.indicator;if(void 0===s)return this;void 0===t&&(t=this.value);var n=this.childrenMap.thumb;if(n)if(0===this.orientation){var r=Fl(n);e=n.x-r*n.originX+r-this.left}else{var a=Wl(n);i=n.y-a*n.originY+a-this.top}else 0===this.orientation?e=this.width*t:i=this.height*t;zc(s,e,i);var o=0===this.orientation?gm:mm;dd(s,this,o),this.resetChildPositionState(s)};const vm=Phaser.Utils.Objects.GetValue,bm=Phaser.Math.Clamp,xm=Phaser.Math.Linear,ym=Phaser.Math.Percent,wm=Phaser.Math.Snap.To;class km extends pu{constructor(t,e){super(t,e),this.type="rexSlider",this.eventEmitter=vm(e,"eventEmitter",this);var i=vm(e,"background",void 0),s=vm(e,"track",void 0),n=vm(e,"indicator",void 0),r=vm(e,"thumb",void 0);i&&this.addBackground(i),s&&this.add(s,1,"center",0,!0),n&&this.pin(n),r&&this.pin(r);var a=vm(e,"input",0);switch("string"==typeof a&&(a=Cm[a]),a){case 0:r&&(r.setInteractive(),this.scene.input.setDraggable(r),r.on("drag",qg,this));break;case 1:this.setInteractive().on("pointerdown",Qg,this).on("pointermove",Qg,this)}this.addChildrenMap("background",i),this.addChildrenMap("track",s),this.addChildrenMap("indicator",n),this.addChildrenMap("thumb",r);var o=vm(e,"valuechangeCallback",null);if(null!==o){var h=vm(e,"valuechangeCallbackScope",void 0);this.eventEmitter.on("valuechange",o,h)}this.setEnable(vm(e,"enable",void 0)),this.setGap(vm(e,"gap",void 0)),this.setValue(vm(e,"value",0))}setEnable(t){return void 0===t&&(t=!0),this.enable=t,this}setGap(t){return this.gap=t,this}get value(){return this._value}set value(t){void 0!==this.gap&&(t=wm(t,this.gap));var e=this._value;this._value=bm(t,0,1),e!==this._value&&(this.updateThumb(this._value),this.updateIndicator(this._value),this.eventEmitter.emit("valuechange",this._value,e,this.eventEmitter))}setValue(t,e,i){return null==t||(void 0!==e&&(t=ym(t,e,i)),this.value=t),this}addValue(t,e,i){return void 0!==e&&(t=ym(t,e,i)),this.value+=t,this}getValue(t,e){var i=this.value;return void 0!==t&&(i=xm(t,e,i)),i}_layoutInit(){var t=this.getElement("track");t&&(1===this.orientation?zc(t,void 0,0):zc(t,0,void 0)),super._layoutInit()}_layout(t,e,i){return this.rexSizer.hidden||!this.dirty||(super._layout(t,e,i),this.updateThumb(),this.updateIndicator()),this}}const Cm={drag:0,click:1,none:-1};var _m={getStartPoint:rm,getEndPoint:lm,updateThumb:pm,updateIndicator:fm};Object.assign(km.prototype,_m);var Sm=km;zr.register("slider",(function(t){var e=new Sm(this.scene,t);return this.scene.add.existing(e),e})),Qr(window,"RexPlugins.UI.Slider",Sm);var Tm={v:0,vertical:0,h:1,horizontal:1};const Om=Phaser.Utils.Objects.GetValue;var Em=function(t,e){void 0===e&&(e="scrollMode");var i=Om(t,"scrollMode",0);return"string"==typeof i&&(i=Tm[i]),i},Pm=i(0),Mm=i.n(Pm);class Im{constructor(t){var e=Mm()(t,"states",void 0);e&&this.addStates(e);var i=Mm()(t,"extend",void 0);if(i)for(var s in i)this.hasOwnProperty(s)&&void 0!==this[s]||(this[s]=i[s]);var n=Mm()(t,"eventEmitter",void 0),r=Mm()(t,"EventEmitterClass",void 0);this.setEventEmitter(n,r),this._stateLock=!1,this.resetFromJSON(t)}shutdown(){this.destroyEventEmitter()}destroy(){this.shutdown()}resetFromJSON(t){this.setEnable(Mm()(t,"enable",!0)),this.start(Mm()(t,"start",void 0));var e=Mm()(t,"init",void 0);return e&&e.call(this),this}toJSON(){return{curState:this.state,prevState:this.prevState,enable:this.enable,start:this._start}}setEnable(t){return void 0===t&&(t=!0),this.enable=t,this}set state(t){if(this.enable&&!this._stateLock&&this._state!==t){if(this._prevState=this._state,this._state=t,this._stateLock=!0,this.emit("statechange",this),null!=this._prevState){var e="exit_"+this._prevState,i=this[e];i&&i.call(this),this.emit(e,this)}if(this._stateLock=!1,null!=this._state){var s="enter_"+this._state,n=this[s];n&&n.call(this),this.emit(s,this)}}}get state(){return this._state}get prevState(){return this._prevState}start(t){return this._start=t,this._prevState=void 0,this._state=t,this}goto(t){return null!=t&&(this.state=t),this}next(){var t,e=this["next_"+this.state];return e&&(t="string"==typeof e?e:e.call(this)),this.goto(t),this}addState(t,e){var i=Mm()(e,"next",void 0);i&&(this["next_"+t]=i);var s=Mm()(e,"exit",void 0);s&&(this["exit_"+t]=s);var n=Mm()(e,"enter",void 0);return n&&(this["enter_"+t]=n),this}addStates(t){for(var e in t)this.addState(e,t[e]);return this}update(t,e,i){void 0===i&&(i="update");var s=this[i+"_"+this.state];s&&s.call(this,t,e)}preupdate(t,e){this.update(t,e,"preupdate")}postupdate(t,e){this.update(t,e,"postupdate")}}Object.assign(Im.prototype,Rd);var Bm=Im;var jm=class extends Bm{constructor(t,e){super(e),this.parent=t,this.init()}init(){this.start("IDLE")}next_IDLE(){var t,e=this.parent;return e.dragState.isDown&&(t=0===e.dragThreshold?"DRAG":"DRAGBEGIN"),t}update_IDLE(t,e){this.next()}next_DRAGBEGIN(){var t=this.parent,e=t.dragState;return e.isDown?e.pointer.getDistance()>=t.dragThreshold?"DRAG":"DRAGBEGIN":"IDLE"}update_DRAGBEGIN(t,e){this.next()}next_DRAG(){var t,e=this.parent;return e.dragState.isUp&&(t=e.outOfBounds?"BACK":e.slidingEnable?"SLIDE":"IDLE"),t}update_DRAG(t,e){var i=this.parent;i.dragState.justMoved&&i.dragging(),this.next()}next_SLIDE(){var t,e=this.parent;return e.dragState.isDown?t="DRAG":e.isSliding||(t="IDLE"),t}enter_SLIDE(){this.parent.onSliding()}exit_SLIDE(){this.parent.stop()}update_SLIDE(t,e){this.parent.sliding(t,e),this.next()}next_BACK(){var t,e=this.parent;return e.dragState.isDown?t="DRAG":e.isPullBack||(t="IDLE"),t}enter_BACK(){this.parent.onPullBack()}exit_BACK(){this.parent.stop()}update_BACK(t,e){this.parent.pullBack(t,e),this.next()}};const zm=Phaser.Utils.Objects.GetValue,Dm=Phaser.Math.Distance.Between;class Lm{constructor(t,e){this.gameObject=t,this.scene=Wd(t),this.setEventEmitter(zm(e,"eventEmitter",void 0)),this._enable=void 0,t.setInteractive(zm(e,"inputConfig",void 0)),this.resetFromJSON(e),this.boot()}resetFromJSON(t){return this.pointer=void 0,this.isInTouched=!1,this.holdStartTime=void 0,this.x=void 0,this.y=void 0,this.preX=void 0,this.preY=void 0,this.localX=void 0,this.localY=void 0,this.justMoved=!1,this.setEnable(zm(t,"enable",!0)),this.holdThreshold=zm(t,"holdThreshold",50),this}boot(){this.gameObject.on("pointerdown",this.onPointIn,this),this.gameObject.on("pointerup",this.onPointOut,this),this.gameObject.on("pointerout",this.onPointOut,this),this.gameObject.on("pointermove",this.onPointerMove,this),this.gameObject.on("destroy",this.destroy,this),this.scene.events.on("preupdate",this.preupdate,this)}shutdown(){this.scene&&this.scene.events.off("preupdate",this.preupdate,this),this.pointer=void 0,this.gameObject=void 0,this.scene=void 0,this.destroyEventEmitter()}destroy(){this.shutdown()}get enable(){return this._enable}set enable(t){this._enable!==t&&(t||(this.isInTouched=!1,this.pointer=void 0),this._enable=t)}setEnable(t){return void 0===t&&(t=!0),this.enable=t,this}toggleEnable(){return this.setEnable(!this.enable),this}get isDown(){return this.pointer&&this.pointer.isDown}get isUp(){return!this.isDown}get dx(){return this.x-this.preX}get dy(){return this.y-this.preY}get dt(){return this.scene.sys.game.loop.delta}get speed(){return this.x===this.preX&&this.y===this.preY?0:Dm(this.preX,this.preY,this.x,this.y)/(.001*this.dt)}get speedX(){return this.dx/(.001*this.dt)}get speedY(){return this.dy/(.001*this.dt)}onPointIn(t,e,i){this.enable&&t.isDown&&void 0===this.pointer&&(this.pointer=t,this.localX=e,this.localY=i)}onPointOut(t){this.enable&&this.pointer===t&&(this.pointer=void 0)}onPointerMove(t,e,i){this.enable&&t.isDown&&this.pointer===t&&(this.localX=e,this.localY=i)}preupdate(t,e){if(this.enable){var i=this.pointer;this.justMoved=!1,i&&!this.isInTouched?(this.x=i.x,this.y=i.y,this.preX=i.x,this.preY=i.y,this.isInTouched=!0,this.holdStartTime=void 0,this.emit("touchstart",i,this.localX,this.localY)):i&&this.isInTouched?this.x===i.x&&this.y===i.y?void 0===this.holdStartTime?this.holdStartTime=t:t-this.holdStartTime>this.holdThreshold&&(this.preX=this.x,this.preY=this.y):(this.preX=this.x,this.preY=this.y,this.x=i.x,this.y=i.y,this.holdStartTime=void 0,this.justMoved=!0,this.emit("touchmove",i,this.localX,this.localY)):!i&&this.isInTouched&&(this.isInTouched=!1,this.holdStartTime=void 0,this.emit("touchend",i))}}}Object.assign(Lm.prototype,Rd);var Rm=Lm;const Um=Phaser.Utils.Objects.GetValue;var Fm=class{constructor(t){this.resetFromJSON(t)}resetFromJSON(t){return this.setValue(Um(t,"value",0)),this.setSpeed(Um(t,"speed",0)),this.setAcceleration(Um(t,"acceleration",0)),this}reset(){this.setValue(0),this.setSpeed(0),this.setAcceleration(0)}setValue(t){return this.value=t,this}setSpeed(t){return this.speed=t,this}setAcceleration(t){return this.acceleration=t,this}updateSpeed(t){return 0!==this.acceleration&&(this.speed+=this.acceleration*t,this.speed<0&&(this.speed=0)),this}getDeltaValue(t){return this.updateSpeed(t),this.speed<=0?0:this.speed*t}update(t){return this.updateSpeed(t),this.speed>0&&(this.value+=this.getDeltaValue(t)),this}get isMoving(){return this.speed>0}};var Wm=class{constructor(){this.value,this.dir,this.movement=new Fm}init(t,e,i,s,n){return this.value=t,this.end=n,this.dir=void 0!==n?t<n:e,this.movement.setSpeed(i).setAcceleration(-s),this}stop(){this.movement.reset()}update(t){var e=this.movement.getDeltaValue(t);return this.dir||(e=-e),void 0===this.end?this.value+=e:0===e?this.value=this.end:(this.value+=e,this.dir?this.value>this.end&&(this.value=this.end):this.value<this.end&&(this.value=this.end)),this}get isMoving(){return this.movement.isMoving}};const Ym=Phaser.Utils.Objects.GetValue;class Am{constructor(t,e){this.gameObject=t,this.scene=Wd(t),this.setEventEmitter(Ym(e,"eventEmitter",void 0));var i=Ym(e,"enable",!0),s={enable:i,eventEmitter:!1};this._state=new jm(this,s);var n={inputConfig:Ym(e,"inputConfig",void 0),enable:i,eventEmitter:!1};this.dragState=new Rm(t,n),this._enable=void 0,this._value=void 0,this._slowDown=new Wm;var r=Ym(e,"valuechangeCallback",null);if(null!==r){var a=Ym(e,"valuechangeCallbackScope",void 0);this.on("valuechange",r,a)}if(null!==(r=Ym(e,"overmaxCallback",null))){a=Ym(e,"overmaxCallbackScope",void 0);this.on("overmax",r,a)}if(null!==(r=Ym(e,"overminCallback",null))){a=Ym(e,"overminCallbackScope",void 0);this.on("overmin",r,a)}this.resetFromJSON(e),this.boot()}resetFromJSON(t){this.setOrientationMode(Ym(t,"orientation",0)),this.setDragThreshold(Ym(t,"threshold",10)),this.setSlidingDeceleration(Ym(t,"slidingDeceleration",5e3)),this.setBackDeceleration(Ym(t,"backDeceleration",2e3));var e=Ym(t,"bounds",void 0);return e?this.setBounds(e):this.setBounds(Ym(t,"max",0),Ym(t,"min",0)),this.setValue(Ym(t,"value",this.maxValue||0)),this.setEnable(Ym(t,"enable",!0)),this}boot(){this.scene.events.on("update",this._state.update,this._state),this.gameObject.on("destroy",this.destroy,this)}shutdown(){this.destroyEventEmitter(),this.scene&&this.scene.events.off("update",this._state.update,this._state),this.gameObject=void 0,this.scene=void 0,this._state.destroy(),this.dragState.destroy()}destroy(){this.shutdown()}get enable(){return this._enable}set enable(t){if(this._enable!==t)return this._enable=t,this._state.setEnable(t),this.dragState.setEnable(t),this}setEnable(t){return void 0===t&&(t=!0),this.enable=t,this}toggleEnable(){return this.setEnable(!this.enable),this}setOrientationMode(t){return"string"==typeof t&&(t=Hm[t]),this.orientationMode=t,this}setDragThreshold(t){return this.dragThreshold=t,this}setSlidingDeceleration(t){return this.slidingDeceleration=t,this}setBackDeceleration(t){return this.backDeceleration=t,this}setBounds(t,e){if(Array.isArray(t)){var i=t;t=i[0],e=i[1]}return t<e?(this.minValue=t,this.maxValue=e):(this.minValue=e,this.maxValue=t),this}get value(){return this._value}set value(t){if(t!==this._value){var e=this._value,i=this.overMax(t),s=this.overMin(t);i&&this.emit("overmax",t,e),s&&this.emit("overmin",t,e),this.backEnable||(i&&(t=this.maxValue),s&&(t=this.minValue)),this._value=t,this.emit("valuechange",t,e)}}setValue(t){this.value=t}get state(){return this._state.state}get isDragging(){return this.dragState.isInTouched}get outOfMaxBound(){return this.overMax(this.value)}get outOfMinBound(){return this.overMin(this.value)}get outOfBounds(){return this.outOfMinBound||this.outOfMaxBound}overMax(t){return null!=this.maxValue&&t>this.maxValue}overMin(t){return null!=this.minValue&&t<this.minValue}get backEnable(){return"number"==typeof this.backDeceleration}get isPullBack(){return this._slowDown.isMoving}get slidingEnable(){return"number"==typeof this.slidingDeceleration}get isSliding(){return this._slowDown.isMoving}get dragDelta(){return 0===this.orientationMode?this.dragState.dy:1===this.orientationMode?this.dragState.dx:0}get dragSpeed(){return 0===this.orientationMode?this.dragState.speedY:1===this.orientationMode?this.dragState.speedX:0}dragging(){this.value+=this.dragDelta}onSliding(){var t=this.value,e=this.dragSpeed;if(0===e)return this._slowDown.stop(),void this._state.next();var i=this.slidingDeceleration;this._slowDown.init(t,e>0,Math.abs(e),i)}sliding(t,e){e*=.001;var i=this._slowDown.update(e).value;this.overMax(i)?(this.value=this.maxValue,this._slowDown.stop()):this.overMin(i)?(this.value=this.minValue,this._slowDown.stop()):this.value=i}onPullBack(){var t=this.value,e=this.outOfMinBound?this.minValue:this.maxValue,i=Math.abs(e-t),s=this.backDeceleration,n=Math.sqrt(2*s*i);this._slowDown.init(t,void 0,n,s,e)}pullBack(t,e){e*=.001,this.value=this._slowDown.update(e).value,this._slowDown.isMoving||this._state.next()}stop(){this._slowDown.stop()}}Object.assign(Am.prototype,Rd);const Hm={y:0,v:0,vertical:0,x:1,h:1,horizontal:1};var Vm=Am;const Nm=Phaser.Utils.Objects.GetValue;var Gm={right:0,left:1,bottom:0,top:1},Xm=function(t){var e,i,s,n=this.scene,r=Em(t),a=new pu(n,{orientation:r}),o=Nm(t,"child.gameObject",void 0),h=Nm(t,"slider",void 0),l=Nm(t,"scroller",!0);if(o){var d,c=Nm(t,"space.child",0);if(this.childPadding={},"number"!=typeof c){var u=c;0===r?(c=Nm(u,"right",0),this.childPadding.top=Nm(u,"top",0),this.childPadding.bottom=Nm(u,"bottom",0)):(c=Nm(u,"bottom",0),this.childPadding.top=Nm(u,"left",0),this.childPadding.bottom=Nm(u,"right",0))}else this.childPadding.top=0,this.childPadding.bottom=0;if(h)!0===h&&(h={}),"string"==typeof(i=Nm(h,"position",0))&&(i=Gm[i]),d=0===r?0===i?{left:c}:{right:c}:0===i?{top:c}:{bottom:c},h.orientation=0===a.orientation?1:0,e=new Sm(n,h);l&&(!0===l&&(l={}),l.orientation=r,s=new Vm(o,l)),e&&1===i&&a.add(e,0,"center",d,!0);var p=Nm(t,"child.proportion",1),g=Nm(t,"child.expand",!0);a.add(o,p,"center",0,g),e&&0===i&&a.add(e,0,"center",d,!0)}return e&&e.on("valuechange",(function(t){this.t=t,this.emit("scroll",this)}),this),s&&s.on("valuechange",(function(t){this.childOY=t,this.emit("scroll",this)}),this),this.addChildrenMap("child",o),this.addChildrenMap("slider",e),this.addChildrenMap("scroller",s),a},Jm=function(){var t=this.topChildOY,e=this.bottomChildOY,i=this.childrenMap.scroller,s=this.childrenMap.slider;return i&&i.setBounds(e,t),s&&s.setEnable(e!==t),this.updateController(),this},Km=function(){var t=this.childrenMap.scroller,e=this.childrenMap.slider;t&&t.setValue(this.childOY),e&&e.setValue(this.t)};const Zm=Phaser.Utils.Objects.GetValue;class qm extends pu{constructor(t,e){void 0===e&&(e={});var i=Em(e);e.orientation=0===i?1:0,super(t,e),this.type=Zm(e,"type","rexScrollable");var s=Zm(e,"background",void 0),n=Xm.call(this,e),r=Zm(e,"header",void 0),a=Zm(e,"footer",void 0);if(s&&this.addBackground(s),r){var o=Zm(e,"align.header","center"),h=Zm(e,"space.header",0);d=0===i?{bottom:h}:{right:h};var l=Zm(e,"expand.header",!0);this.add(r,0,o,d,l)}if(n&&this.add(n,1,"center",0,!0),a){o=Zm(e,"align.footer","center");var d,c=Zm(e,"space.footer",0);d=0===i?{top:c}:{left:c};l=Zm(e,"expand.footer",!0);this.add(a,0,o,d,l)}this.addChildrenMap("background",s),this.addChildrenMap("header",r),this.addChildrenMap("footer",a)}_layout(t,e,i){return this.rexSizer.hidden||!this.dirty||(super._layout(t,e,i),this.resizeController()),this}set t(t){var e=this.childPadding;if(0!==e.top||0!==e.bottom){var i=this.childrenMap.child,s=i.topChildOY-i.bottomChildOY;t=((s+e.top+e.bottom)*t-e.top)/s}this.childrenMap.child.t=t,this.updateController()}get t(){var t=this.childrenMap.child.t,e=this.childPadding;if(0!==e.top||0!==e.bottom){var i=this.childrenMap.child,s=i.topChildOY-i.bottomChildOY,n=s+e.top+e.bottom;t=(s*t+e.top)/n}return t}set childOY(t){this.childrenMap.child.childOY=t,this.updateController()}get childOY(){return this.childrenMap.child.childOY}get topChildOY(){return this.childrenMap.child.topChildOY+this.childPadding.top}get bottomChildOY(){return this.childrenMap.child.bottomChildOY-this.childPadding.bottom}setChildOY(t){return this.childOY=t,this}setT(t){return this.t=t,this}scrollToTop(){return this.t=0,this}scrollToBottom(){return this.t=1,this}get sliderEnable(){var t=this.childrenMap.slider;if(t)return t.enable}set sliderEnable(t){var e=this.childrenMap.slider;e&&e.setEnable(t)}setSliderEnable(t){return void 0===t&&(t=!0),this.sliderEnable=t,this}get scrollerEnable(){var t=this.childrenMap.scroller;if(t)return t.enable}set scrollerEnable(t){var e=this.childrenMap.scroller;e&&e.setEnable(t)}setScrollerEnable(t){return void 0===t&&(t=!0),this.scrollerEnable=t,this}}var $m={resizeController:Jm,updateController:Km};Object.assign(qm.prototype,$m);var Qm=qm,tf={enableData(){return void 0===this.data&&(this.data={}),this},getData(t,e){return this.enableData(),void 0===t?this.data:Mm()(this.data,t,e)},setData(t,e){return this.enableData(),this.data[t]=e,this},incData(t,e,i){return void 0===i&&(i=0),this.enableData(),this.setData(t,this.getData(t,i)+e),this},mulData(t,e,i){return void 0===i&&(i=0),this.enableData(),this.setData(t,this.getData(t,i)*e),this},clearData(){return this.data&&xa(this.data),this},resetData(t){if(this.clearData(),t)for(var e in this.enableData(),t)this.data[e]=t[e];return this},cloneData(){return this.data?ya(this.data):{}}};class ef{constructor(t,e){this.container=null,this._deltaHeight=0,this.setParent(t)}setParent(t){this.parent=t,this.parentContainer=t.getParentContainer()}destroy(t){void 0===t&&(t=!1),t||this.destroyContainer(),this.deltaHeight=0,this.data=void 0,this.container=null,this.parent=void 0,this.parentContainer=void 0}get table(){return this.parent}get scrollMode(){return this.parentContainer.scrollMode}get colIndx(){return this.parent.cellIndxeToColIndex(this.index)}get rowIndx(){return this.parent.cellIndxeToRowIndex(this.index)}getContainer(){return this.container}setContainer(t){return t?(this.container&&this.container.destroy(),this.container=t,this.parentContainer.add(t),this):(this.destroyContainer(),this)}destroyContainer(){return this.container&&(this.container.destroy(),this.container=null),this}popContainer(){if(this.container){var t=this.container;return this.container=null,this.parentContainer.remove(t),t}return null}setXY(t,e){return this.container&&this.parentContainer.setChildLocalPosition(this.container,t,e),this}get deltaHeight(){return this._deltaHeight}set deltaHeight(t){null==t&&(t=0);var e=this.parent;0===this._deltaHeight&&0!==t?e.nonZeroDeltaHeightCount++:0!==this._deltaHeight&&0===t&&e.nonZeroDeltaHeightCount--,this._deltaHeight=t}get deltaWidth(){return this.deltaHeight}set deltaWidth(t){this.deltaHeight=t}setDeltaHeight(t){return this.deltaHeight=t,this}setDeltaWidth(t){return this.deltaHeight=t,this}get height(){return 0===this.scrollMode?this.deltaHeight+this.parent.defaultCellHeight:this.parent.defaultCellWidth}set height(t){1!==this.scrollMode&&this.setDeltaHeight(t-this.parent.defaultCellHeight)}setHeight(t){return this.height=t,this}get width(){return 0===this.scrollMode?this.parent.defaultCellWidth:this.deltaHeight+this.parent.defaultCellHeight}set width(t){0!==this.scrollMode&&this.setDeltaHeight(t-this.parent.defaultCellHeight)}setWidth(t){return this.width=t,this}get scene(){return this.parentContainer.scene}}Object.assign(ef.prototype,tf);var sf=ef;const nf=Phaser.Utils.Objects.GetValue,rf=Phaser.Utils.Array.SpliceOne;var af=class{constructor(t,e){this.parent=t,this.cells=[],this.cellPool=new ga,this.resetFromJSON(e)}resetFromJSON(t){return this.colCount=void 0,this._nonZeroDeltaHeightCount=0,this.resetTotalRowsHeight(),this.setDefaultCellHeight(nf(t,"cellHeight",30)),this.setDefaultCellWidth(nf(t,"cellWidth",30)),this.initCells(nf(t,"cellsCount",0)),this.setColumnCount(nf(t,"columns",1)),this}destroy(t){for(var e=0,i=this.cells.length;e<i;e++)this.freeCell(this.cells[e],t);this.cellPool.destroy(),this.cells=void 0,this.parent=void 0}get nonZeroDeltaHeightCount(){return this._nonZeroDeltaHeightCount}set nonZeroDeltaHeightCount(t){this._nonZeroDeltaHeightCount!==t&&(this._nonZeroDeltaHeightCount=t,this.resetTotalRowsHeight())}get defaultCellHeightMode(){return 0===this.nonZeroDeltaHeightCount}setDefaultCellHeight(t){return this.defaultCellHeight=t,this}setDefaultCellWidth(t){return this.defaultCellWidth=t,this}initCells(t){var e=this.cells;e.length=t;for(var i=0;i<t;i++)e[i]=null;return this}insertNewCells(t,e){var i=this.cells;if(t===i.length){var s=t+e;i.legth=s;for(var n=t;n<s;n++)i[n]=null}else{var r=[];r.length=e;for(n=0;n<e;n++)r[n]=null;this.cells.splice(t,0,...r)}return this.resetTotalRowsHeight(),this}removeCells(t,e){for(var i=t+e,s=t;s<i;s++)this.freeCell(s);return i===this.cells.length?this.cells.length=t:(1===e?rf(this.cells,t):this.cells.splice(t,e),this.buildCellIndex(t)),this.resetTotalRowsHeight(),this}setColumnCount(t){return this.colCount=t,this.resetTotalRowsHeight(),this}get rowCount(){return Math.ceil(this.cells.length/this.colCount)}get cellsCount(){return this.cells.length}isValidCellIdx(t){return t>=0&&t<this.cells.length}heightToRowIndex(t,e){if(this.defaultCellHeightMode){var i=t/this.defaultCellHeight;return i=e?Math.ceil(i):Math.floor(i)}var s,n=this.rowCount,r=t;for(i=0;;){if(s=i>=0&&i<n,!((r-=this.getRowHeight(i))>0&&s)){if(0===r)return i;if(e){var a=i;(s=(i+=1)>=0&&i<n)||(i=a)}return i}i+=1}}widthToColIndex(t,e){var i=t/this.defaultCellWidth;return i=e?Math.ceil(i):Math.floor(i)}colRowToCellIndex(t,e){return t>=this.colCount?null:e*this.colCount+t}rowIndexToHeight(t,e){if(this.defaultCellHeightMode)return(e-t+1)*this.defaultCellHeight;for(var i=0,s=t;s<=e;s++)i+=this.getRowHeight(s);return i}colIndexToWidth(t,e){return(e-t+1)*this.defaultCellWidth}getRowHeight(t){var e=this.colCount;if(e<=1)return this.getCellHeight(this.colRowToCellIndex(0,t));for(var i,s=0,n=0;n<e;n++)s<(i=this.getCellHeight(this.colRowToCellIndex(n,t)))&&(s=i);return s}getColWidth(t){return this.defaultCellWidth}getCellHeight(t){if(!this.isValidCellIdx(t))return 0;var e;if(this.defaultCellHeightMode)e=this.defaultCellHeight;else{var i=this.getCell(t,!1),s=i?i.deltaHeight:0;e=this.defaultCellHeight+s}return e}resetTotalRowsHeight(){this._totalRowsHeight=null}get totalRowsHeight(){return null===this._totalRowsHeight&&(this._totalRowsHeight=this.rowIndexToHeight(0,this.rowCount-1)),this._totalRowsHeight}get totalColumnWidth(){return this.colCount*this.defaultCellWidth}cellIndxeToColIndex(t){return t%this.colCount}cellIndxeToRowIndex(t){return Math.floor(t/this.colCount)}getCell(t,e){if(!this.isValidCellIdx(t))return null;if(void 0===e&&(e=!0),null===this.cells[t]&&e){var i=this.newCell(t);this.cells[t]=i}return this.cells[t]}newCell(t){var e=this.cellPool.pop();return null===e?e=new sf(this):e.setParent(this),e.index=t,e}buildCellIndex(t){void 0===t&&(t=0);for(var e,i=this.cells,s=t,n=i.length;s<n;s++)(e=i[s])&&(e.index=s);return this}getParentContainer(){return this.parent}freeCell(t,e){return"number"==typeof t&&(t=this.cells[t]),t?(t.destroy(e),e||this.cellPool.push(t),this):this}},of=function(t){return t.hasOwnProperty("geometryMask")?t.geometryMask:t.bitmapMask},hf=function(t){var e=this.table,i=this.topTableOY,s=this.bottomTableOY,n=t>this.topTableOY,r=t<this.bottomTableOY;this.clampTableOXY&&(e.rowCount<e.heightToRowIndex(this.instHeight,!0)?t=0:n?t=i:r&&(t=s));return this._tableOY!==t&&(this._tableOY=t),n&&(this.execeedTopState||this.emit("execeedtop",this,t,i)),this.execeedTopState=n,r&&(this.execeedBottomState||this.emit("execeedbottom",this,t,s)),this.execeedBottomState=r,this},lf=function(t){var e=this.table,i=this.leftTableOX,s=this.rightTableOX,n=t>this.leftTableOX,r=t<this.rightTableOX;this.clampTableOXY&&(e.colCount<e.widthToColIndex(this.instWidth,!0)?t=0:n?t=i:r&&(t=s));return this._tableOX!==t&&(this._tableOX=t),n&&(this.execeedLeftState||this.emit("execeedleft",this,t,i)),this.execeedLeftState=n,r&&(this.execeedRightState||this.emit("execeedright",this,t,s)),this.execeedRightState=r,this};const df=Phaser.Geom.Intersects.RectangleToRectangle,cf=Phaser.Geom.Rectangle.Overlaps;var uf=function(t,e){var i=0,s=e.top,n=e.bottom,r=e.left,a=e.right;return i+=t.contains(r,s)?1:0,i+=t.contains(r,n)?1:0,i+=t.contains(a,s)?1:0,i+=t.contains(a,n)?1:0},pf=function(t,e,i){t.setChildMaskVisible(e,!0),e.clearMask&&e.clearMask()},gf=function(t,e,i){t.setChildMaskVisible(e,!0),e.setMask&&e.setMask(i)},mf=function(t,e,i){t.setChildMaskVisible(e,!1),e.clearMask&&e.clearMask()},ff=function(t,e,i){if(e){void 0===i&&(i=t.getAllChildren());for(var s,n,r=t.getBounds(),a=of(e),o=0,h=i.length;o<h;o++)if(!(s=i[o]).hasOwnProperty("isRexContainerLite")&&s!==a&&t.getLocalState(s).visible)if(s.getBounds)switch(n=s.getBounds(n),uf(r,n)){case 4:pf(t,s,e);break;case 0:df(r,n)||cf(r,n)?gf(t,s,e):mf(t,s,e);break;default:gf(t,s,e)}else gf(t,s,e)}},vf=function(){if(!this.cellsMask)return this;if(1===this.maskUpdateMode&&(0===this.alpha||!this.visible))return this;for(var t,e=[],i=this.visibleCells.entries,s=0,n=i.length;s<n;s++)(t=i[s].getContainer())&&(t.hasOwnProperty("isRexContainerLite")?t.getAllChildren(e):e.push(t));return ff(this,this.cellsMask,e),this},bf=function(t){if(this.emit("cellinvisible",t),this.cellContainersPool){var e=t.popContainer();e&&this.cellContainersPool.killAndHide(e)}t.destroyContainer()},xf=function(){var t=this.preVisibleCells,e=this.visibleCells;t.iterate((function(t){e.contains(t)||bf.call(this,t)}),this)},yf=function(t){var e,i=null;((e=t.getContainer())?(i=e,t.popContainer()):this.cellContainersPool&&null!==(i=this.cellContainersPool.getFirstDead())&&i.setActive(!0).setVisible(!0),this.emit("cellvisible",t,i,this),this.cellContainersPool)&&((e=t.getContainer())?null===i?this.cellContainersPool.add(e):i!==e&&(this.cellContainersPool.add(e),this.cellContainersPool.killAndHide(i)):null!==i&&this.cellContainersPool.killAndHide(i))},wf=function(t){var e=0===this.scrollMode?this.topLeftX:this.topLeftY;return this.tableOX+this.table.colIndexToWidth(0,t-1)+e},kf=function(t){var e=0===this.scrollMode?this.topLeftY:this.topLeftX;return this.tableOY+this.table.rowIndexToHeight(0,t-1)+e},Cf=function(){if(0!==this.cellsCount){var t=this.table,e=t.heightToRowIndex(-this.tableOY);e<0&&(e=0);var i=e,s=t.widthToColIndex(-this.tableOX);s<0&&(s=0);for(var n=s,r=t.colRowToCellIndex(n,i),a=this.bottomBound,o=this.rightBound,h=t.cellsCount-1,l=t.colCount-1,d=wf.call(this,n),c=d,u=kf.call(this,i);u<a&&r<=h;){if(this.table.isValidCellIdx(r)){var p=t.getCell(r,!0);this.visibleCells.set(p),this.preVisibleCells.contains(p)||yf.call(this,p),0===this.scrollMode?p.setXY(c,u):p.setXY(u,c)}c<o&&n<l?(c+=t.getColWidth(n),n+=1):(c=d,u+=t.getRowHeight(i),n=s,i+=1),r=t.colRowToCellIndex(n,i)}}},_f=function(){var t=this.preVisibleCells;this.preVisibleCells=this.visibleCells,this.visibleCells=t,this.visibleCells.clear()},Sf=function(t){return void 0===t&&(t=!1),t&&(_f.call(this),xf.call(this)),_f.call(this),Cf.call(this),xf.call(this),0===this.maskUpdateMode&&this.maskCells(),this},Tf=function(t){var e=this.table.getCell(t,!1);return e&&this.visibleCells.contains(e)},Of=function(t,e){e-=this.y+this.topLeftY,t-=this.x+this.topLeftX;var i=this.tableOY-(0===this.scrollMode?e:t),s=this.tableOX-(0===this.scrollMode?t:e),n=this.table,r=n.heightToRowIndex(-i),a=n.widthToColIndex(-s),o=n.colRowToCellIndex(a,r);return null===o?null:this.isCellVisible(o)?o:null},Ef=function(t){var e=this.cellsCount;return e===t||(e>t?this.removeCells(t,e-t):this.insertNewCells(e,t-e)),this};const Pf=Phaser.Math.Clamp;var Mf={setTableOY:hf,setTableOX:lf,maskCells:vf,updateTable:Sf,isCellVisible:Tf,pointToCellIndex:Of,pointToCellContainer:function(t,e){var i=Of.call(this,t,e);if(null!==i)return this.getCellContainer(i)},eachVisibleCell:function(t,e){return this.visibleCells.each(t,e),this},iterateVisibleCell:function(t,e){return this.visibleCells.iterate(t,e),this},eachCell:function(t,e){return this.table.cells.slice().forEach(t,e),this},iterateCell:function(t,e){return this.table.cells.forEach(t,e),this},setCellsCount:Ef,insertNewCells:function(t,e){return"object"==typeof t&&(t=t.index),void 0===e&&(e=1),e<=0||(t=Pf(t,0,this.cellsCount),this.table.insertNewCells(t,e)),this},removeCells:function(t,e){if("object"==typeof t&&(t=t.index),void 0===e&&(e=1),t<0&&(e+=t,t=0),e<=0)return this;if(t>this.cellsCount)return this;for(var i,s=t,n=t+e;s<n;s++)(i=this.getCell(s,!1))&&(this.visibleCells.contains(i)&&(bf.call(this,i),this.visibleCells.delete(i)),this.preVisibleCells.delete(i));return this.table.removeCells(t,e),this},setColumnCount:function(t){return this.table.colCount===t||this.table.setColumnCount(t),this},setGridSize:function(t,e){return this.setCellsCount(t*e),this.table.setColumnCount(t),this},updateVisibleCell:function(t){var e=this.table.getCell(t,!1);return e&&e.container?(yf.call(this,e),this):this}};const If=Phaser.GameObjects.Group,Bf=Phaser.GameObjects.Components,jf=Phaser.Structs.Set,zf=Phaser.Utils.Objects.GetValue;class Df extends Dh{constructor(t,e,i,s,n,r){void 0===r&&(r={}),super(t,e,i,s,n),this.type="rexGridTable",this._tableOX=0,this._tableOY=0,this.visibleCells=new jf,this.preVisibleCells=new jf,this.execeedTopState=!1,this.execeedBottomState=!1,this.execeedLeftState=!1,this.execeedRightState=!1,zf(r,"reuseCellContainer",!1)&&(this.cellContainersPool=new If(t));var a=zf(r,"cellVisibleCallback",null);if(null!==a){var o=zf(r,"cellVisibleCallbackScope",void 0);this.on("cellvisible",a,o)}if(null!==(a=zf(r,"cellInvisibleCallback",null))){o=zf(r,"cellInvisibleCallbackScope",void 0);this.on("cellinvisible",a,o)}if(this.setCellsMask(zf(r,"mask",!0)),this.setScrollMode(zf(r,"scrollMode",0)),this.setClampMode(zf(r,"clamplTableOXY",!0)),0===this.scrollMode){var h=zf(r,"cellWidth",void 0);if(this.expandCellSize=void 0===h,void 0===h){var l=zf(r,"columns",1);r.cellWidth=this.width/l}}else{h=zf(r,"cellHeight",void 0);var d=zf(r,"cellWidth",void 0);this.expandCellSize=void 0===h,r.cellWidth=h,r.cellHeight=d}this.table=new af(this,r),this.updateTable()}destroy(t){this.scene&&(1===this.maskUpdateMode&&this.scene.game.events.off("poststep",this.maskCells,this),this.table.destroy(t),this.table=void 0,this.cellContainersPool&&(this.cellContainersPool.destroy(!0),this.cellContainersPool=void 0),super.destroy(t))}setScrollMode(t){return"string"==typeof t&&(t=Lf[t.toLowerCase()]),this.scrollMode=t,this}setClampMode(t){return void 0===t&&(t=!0),this.clampTableOXY=t,this}get tableOY(){return this._tableOY}get tableOX(){return this._tableOX}set tableOY(t){this.setTableOY(t).updateTable()}set tableOX(t){this.setTableOX(t).updateTable()}setTableOXY(t,e){return this.setTableOY(e).setTableOX(t),this}addTableOY(t){return this.setTableOY(this.tableOY+t),this}addTableOX(t){return this.setTableOX(this.tableOX+t),this}addTableOXY(t,e){return this.addTableOY(e).addTableOX(t),this}setTableOYByPercentage(t){return this.setTableOY(-this.tableVisibleHeight*t),this}getTableOYPercentage(){var t=this.tableVisibleHeight;return 0===t?0:this.tableOY/-t}set t(t){this.setTableOYByPercentage(t).updateTable()}get t(){return this.getTableOYPercentage()}getCell(t){return this.table.getCell(t,!0)}getCellContainer(t){var e,i=this.table.getCell(t,!1);return i&&(e=i.getContainer()),e}get cellsCount(){return this.table.cellsCount}get columnCount(){return this.table.colCount}setCellHeight(t,e){return("number"==typeof t?this.table.getCell(t,!0):t).height=e,this}setCellWidth(t,e){return("number"==typeof t?this.table.getCell(t,!0):t).width=e,this}setCellsMask(t){var e,i,s;if(!0===t?(e=!0,i=0,s=0):!1===t?e=!1:(e=zf(t,"mask",!0),i=zf(t,"padding",0),s=zf(t,"updateMode",0)),this.maskUpdateMode=s,e){var n=new jp(this,0,i);this.cellsMask=n.createGeometryMask(),this.add(n),"string"==typeof s&&(s=Rf[s]),1===s&&this.scene.game.events.on("poststep",this.maskCells,this)}return this}get instHeight(){return 0===this.scrollMode?this.height:this.width}get instWidth(){return 0===this.scrollMode?this.width:this.height}get tableHeight(){return this.table.totalRowsHeight}get tableWidth(){return this.table.totalColumnWidth}get topTableOY(){return 0}get bottomTableOY(){return-this.tableVisibleHeight}get leftTableOX(){return 0}get rightTableOX(){return-this.tableVisibleWidth}get tableVisibleHeight(){var t=this.tableHeight,e=this.instHeight;return t>e?t-e:0}get tableVisibleWidth(){var t=this.tableWidth,e=this.instWidth;return t>e?t-e:0}get bottomLeftY(){return-this.displayHeight*this.originY+this.displayHeight}get topRightX(){return-this.displayWidth*this.originX+this.displayWidth}get topLeftX(){return-this.displayWidth*this.originX}get topLeftY(){return-this.displayHeight*this.originY}get bottomBound(){return 0===this.scrollMode?this.bottomLeftY:this.topRightX}get rightBound(){return 0===this.scrollMode?this.topRightX:this.bottomLeftY}resize(t,e){return this.width===t&&this.height===e||(super.resize(t,e),this.cellsMask&&zc(of(this.cellsMask),t,e),this.expandCellSize&&this.table.setDefaultCellWidth(this.instWidth/this.table.colCount),this.updateTable(!0)),this}}Object.assign(Df.prototype,Bf.GetBounds,Mf);const Lf={v:0,vertical:0,h:1,horizontal:1},Rf={update:0,everyTick:1};var Uf=Df,Ff=function(t){Object.defineProperty(t,"childOY",{configurable:!0,get:function(){return t.tableOY},set:function(e){t.tableOY=e}}),Object.defineProperty(t,"topChildOY",{get:function(){return t.topTableOY}}),Object.defineProperty(t,"bottomChildOY",{get:function(){return t.bottomTableOY}})},Wf=function(t){t.on("cellvisible",(function(t,e,i){var s=this.createCellContainerCallback,n=this.createCellContainerCallbackScope;t.item=this.items[t.index],(e=n?s.call(n,t,e,i):s(t,e,i))&&(e.setOrigin&&e.setOrigin(0),e.isRexSizer&&e.layout()),t.item=void 0,t.setContainer(e)}),this)},Yf=function(t,e,i,s,n,r){var a;if(null!=(a=void 0===n?s:i.pointToCellIndex(s,n))){var o=i.getCellContainer(a);o&&t.emit(e,o,a,r)}},Af=function(t,e){t.on("pointerdown",(function(e){Yf(this.eventEmitter,"cell.down",t,e.x,e.y,e)}),this).on("pointerup",(function(e){Yf(this.eventEmitter,"cell.up",t,e.x,e.y,e)}),this)},Hf=function(t){var e=this.childrenMap.child,i=e.pointToCellIndex(t.x,t.y);if(i!==e.input.lastOverCellIndex){var s=e.input.lastOverCellIndex;e.input.lastOverCellIndex=i,Yf(this.eventEmitter,"cell.out",e,s,void 0,t),Yf(this.eventEmitter,"cell.over",e,i,void 0,t)}},Vf=function(t){var e=this.childrenMap.child,i=e.input.lastOverCellIndex;e.input.lastOverCellIndex=void 0,Yf(this.eventEmitter,"cell.out",e,i,void 0,t)},Nf=function(t,e){t.on("pointermove",Hf,this).on("pointerover",Hf,this).on("pointerout",Vf,this)};const Gf=Phaser.Utils.Objects.GetValue;var Xf=function(t,e){var i=Gf(e,"button",void 0);!1!==i&&(void 0===i&&(i={}),i.threshold=10,t._click=new Ap(t,i),t._click.on("click",(function(t,e,i){Yf(this.eventEmitter,"cell.click",e,i.x,i.y,i)}),this))};const Jf=Phaser.Utils.Objects.GetValue;class Kf{constructor(t,e){this.parent=t,this._isRunning=!1,this.tickingState=!1,this.setEventEmitter(Jf(e,"eventEmitter",void 0)),this.setTickingMode(Jf(e,"tickingMode",1))}boot(){2!==this.tickingMode||this.tickingState||this.startTicking()}shutdown(){this.destroyEventEmitter(),this.tickingState&&this.stopTicking()}setTickingMode(t){"string"==typeof t&&(t=Zf[t]),this.tickingMode=t}startTicking(){this.tickingState=!0}stopTicking(){this.tickingState=!1}get isRunning(){return this._isRunning}set isRunning(t){this._isRunning!==t&&(this._isRunning=t,1===this.tickingMode&&t!=this.tickingState&&(t?this.startTicking():this.stopTicking()))}start(){return this.isRunning=!0,this}pause(){return this.isRunning=!1,this}resume(){return this.isRunning=!0,this}stop(){return this.isRunning=!1,this}complete(){this.isRunning=!1,this.emit("complete",this.parent,this)}}Object.assign(Kf.prototype,Rd);const Zf={no:0,lazy:1,always:2};var qf=Kf;const $f=Phaser.Utils.Objects.GetValue;const Qf=0,tv=1,ev="IDLE";var iv=class extends qf{constructor(t,e){var i=Wd(t);i===t&&(t=void 0),super(i,e),this.scene=i,this.gameObject=t,t&&t.setInteractive($f(e,"inputConfig",void 0)),this._enable=void 0,this.resetFromJSON(e),this.boot()}resetFromJSON(t){return this.setEnable($f(t,"enable",!0)),void 0===this.gameObject?this.bounds=$f(t,"bounds",void 0):this.bounds=void 0,this.tracerState=Qf,this.pointer=void 0,this.lastPointer=void 0,this.movedState=!1,this.isTouchingAnyObject=!1,this}boot(){super.boot(),this.gameObject?this.gameObject.on("pointerdown",this.onPointerDown,this):this.scene.input.on("pointerdown",this.onPointerDown,this),this.scene.input.on("pointerup",this.onPointerUp,this),this.scene.input.on("pointermove",this.onPointerMove,this),this.scene.events.once("shutdown",this.destroy,this)}shutdown(){this.gameObject?this.gameObject.off("pointerdown",this.onPointerDown,this):this.scene&&this.scene.input.off("pointerdown",this.onPointerDown,this),this.scene&&(this.scene.input.off("pointerup",this.onPointerUp,this),this.scene.input.off("pointermove",this.onPointerMove,this),this.scene.events.off("destroy",this.destroy,this),this.scene=void 0),this.scene=void 0,this.gameObject=void 0,this.bounds=void 0,this.pointer=void 0,this.lastPointer=void 0,this.movedState=!1,super.shutdown()}destroy(){this.shutdown()}get enable(){return this._enable}set enable(t){if(this._enable!==t)return t||this.dragCancel(),this._enable=t,this}setEnable(t){return void 0===t&&(t=!0),this.enable=t,this}toggleEnable(){return this.setEnable(!this.enable),this}onPointerDown(t,e){this.enable&&(void 0===this.pointer&&(!this.bounds||this.bounds.contains(t.x,t.y))&&this.pointer!==t&&(this.pointer=t,this.lastPointer=t,this.movedState=!1,this.tracerState=tv,void 0===this.gameObject&&(this.isTouchingAnyObject=e.length>0),this.onDragStart()))}onPointerUp(t){this.enable&&((!this.bounds||this.bounds.contains(t.x,t.y))&&this.pointer===t&&(this.pointer=void 0,this.movedState=!1,this.tracerState=Qf,this.onDragEnd()))}onPointerMove(t){if(this.enable&&t.isDown){var e=!this.bounds||this.bounds.contains(t.x,t.y),i=this.pointer===t;!i&&e||(i&&!e?this.onPointerUp(t):(this.movedState||(this.movedState=t.x!==t.downX||t.y!==t.downY),this.movedState&&this.onDrag()))}}dragCancel(){return this.tracerState===tv&&this.onDragEnd(),this.pointer=void 0,this.tracerState=Qf,this}onDragStart(){this.emit("dragstart",this)}onDragEnd(){this.emit("dragend",this)}onDrag(){this.emit("drag",this)}preUpdate(t,e){}postUpdate(t,e){}startTicking(){super.startTicking(),this.scene.events.on("preupdate",this.preUpdate,this),this.scene.events.on("postupdate",this.postUpdate,this)}stopTicking(){super.stopTicking(),this.scene&&(this.scene.events.off("preupdate",this.preUpdate,this),this.scene.events.off("postupdate",this.postUpdate,this))}setRecongizedStateObject(t){return this.recongizedState=t,this}get state(){return this.recongizedState.state}set state(t){this.recongizedState.state=t}cancel(){return this.state=ev,this}};const sv=Phaser.Utils.Objects.GetValue,nv=Phaser.Math.Distance.Between;const rv="IDLE",av="BEGIN",ov="RECOGNIZED";var hv=class extends iv{constructor(t,e){super(t,e);var i=this,s={states:{IDLE:{enter:function(){i.stop(),i.tapsCount=0,i.x=0,i.y=0,i.worldX=0,i.worldY=0},exit:function(){var t=i.lastPointer;i.x=t.x,i.y=t.y,i.worldX=t.worldX,i.worldY=t.worldY}},BEGIN:{enter:function(){i.start(),i.tapsCount=0,i.emit("tappingstart",i,i.gameObject,i.lastPointer)}},RECOGNIZED:{enter:function(){i.start(),i.emit("tap",i,i.gameObject,i.lastPointer),i.emit(i.tapsCount+"tap",i,i.gameObject,i.lastPointer)}}},init:function(){this.state=rv},eventEmitter:!1};this.setRecongizedStateObject(new Bm(s))}resetFromJSON(t){super.resetFromJSON(t),this.setMaxHoldTime(sv(t,"time",250)),this.setTapInterval(sv(t,"tapInterval",200)),this.setDragThreshold(sv(t,"threshold",9)),this.setTapOffset(sv(t,"tapOffset",10));var e=sv(t,"taps",void 0);return void 0!==e?this.setTaps(e):(this.setMaxTaps(sv(t,"maxTaps",void 0)),this.setMinTaps(sv(t,"minTaps",void 0))),this}onDragStart(){switch(this.state){case rv:this.state=av;break;case av:var t=this.lastPointer;nv(t.upX,t.upY,t.x,t.y)>this.tapOffset&&(this.state=ov,this.state=av);break;case ov:this.state=av}}onDragEnd(){this.state===av&&(this.tapsCount++,this.emit("tapping",this,this.gameObject,this.lastPointer),void 0!==this.maxTaps&&this.tapsCount===this.maxTaps&&(this.state=ov))}onDrag(){this.state!==rv&&this.pointer.getDistance()>this.dragThreshold&&(this.state=rv)}preUpdate(t,e){if(this.state===av){var i=this.lastPointer;if(i.isDown)t-i.downTime>this.holdTime&&(this.state=rv);else t-i.upTime>this.tapInterval&&(void 0===this.minTaps||this.tapsCount>=this.minTaps?this.state=ov:this.state=rv)}}postUpdate(t,e){this.state===ov&&(this.state=rv)}get isTapped(){return this.state===ov}setMaxHoldTime(t){return this.holdTime=t,this}setTapInterval(t){return this.tapInterval=t,this}setDragThreshold(t){return this.dragThreshold=t,this}setTapOffset(t){return this.tapOffset=t,this}setMaxTaps(t){return this.maxTaps=t,this}setMinTaps(t){return this.minTaps=t,this}setTaps(t,e){return void 0===e&&(e=t),this.setMinTaps(t).setMaxTaps(e),this}};const lv=Phaser.Utils.Objects.GetValue;var dv=function(t,e){var i=lv(e,"tap",void 0);!1!==i&&(t._tap=new hv(t,i),t._tap.on("tap",(function(t,e,i){var s=`cell.${t.tapsCount}tap`;Yf(this.eventEmitter,s,t.gameObject,t.x,t.y,i)}),this))};const cv=Phaser.Utils.Objects.GetValue;const uv="IDLE",pv="BEGIN",gv="RECOGNIZED";var mv=class extends iv{constructor(t,e){super(t,e);var i=this,s={states:{IDLE:{enter:function(){i.x=0,i.y=0,i.worldX=0,i.worldY=0},exit:function(){var t=i.lastPointer;i.x=t.x,i.y=t.y,i.worldX=t.worldX,i.worldY=t.worldY}},BEGIN:{enter:function(){i.start()},exit:function(){i.stop()}},RECOGNIZED:{enter:function(){i.emit("pressstart",i,i.gameObject,i.lastPointer)},exit:function(){i.emit("pressend",i,i.gameObject,i.lastPointer)}}},init:function(){this.state=uv},eventEmitter:!1};this.setRecongizedStateObject(new Bm(s))}resetFromJSON(t){return super.resetFromJSON(t),this.setDragThreshold(cv(t,"threshold",9)),this.setMinHoldTime(cv(t,"time",251)),this}onDragStart(){this.state=pv,0===this.holdTime&&(this.state=gv)}onDragEnd(){this.state=uv}onDrag(){this.state!==uv&&this.pointer.getDistance()>this.dragThreshold&&(this.state=uv)}preUpdate(t,e){this.state===pv&&(t-this.pointer.downTime>=this.holdTime&&(this.state=gv))}get isPressed(){return this.state===gv}setDragThreshold(t){return this.dragThreshold=t,this}setMinHoldTime(t){return this.holdTime=t,this}};const fv=Phaser.Utils.Objects.GetValue;var vv=function(t,e){var i=fv(e,"press",void 0);!1!==i&&(t._press=new mv(t,i),t._press.on("pressstart",(function(e,i,s){Yf(this.eventEmitter,"cell.pressstart",t,e.x,e.y,s)}),this).on("pressend",(function(e,i,s){Yf(this.eventEmitter,"cell.pressend",t,e.x,e.y,s)}),this))};const bv=Phaser.Math.Distance.Between,xv=Phaser.Math.Angle.Between;var yv={getDt:function(){return this.scene.sys.game.loop.delta},getVelocity:function(){var t=this.pointer.position,e=this.pointer.prevPosition;return bv(e.x,e.y,t.x,t.y)/(.001*this.getDt())},getVelocityX:function(){var t=this.pointer.position,e=this.pointer.prevPosition;return Math.abs(t.x-e.x)/(.001*this.getDt())},getVelocityY:function(){var t=this.pointer.position,e=this.pointer.prevPosition;return Math.abs(t.y-e.y)/(.001*this.getDt())},getVelocityAngle:function(){var t=this.pointer.position,e=this.pointer.prevPosition;return xv(e.x,e.y,t.x,t.y)}},wv={"up&down":0,"left&right":1,"4dir":2,"8dir":3},kv={},Cv=function(t,e,i){switch(void 0===i?i={}:!0===i&&(i=kv),i.left=!1,i.right=!1,i.up=!1,i.down=!1,t=(t+360)%360,e){case 0:t<180?i.down=!0:i.up=!0;break;case 1:t>90&&t<=270?i.left=!0:i.right=!0;break;case 2:t>45&&t<=135?i.down=!0:t>135&&t<=225?i.left=!0:t>225&&t<=315?i.up=!0:i.right=!0;break;case 3:t>22.5&&t<=67.5?(i.down=!0,i.right=!0):t>67.5&&t<=112.5?i.down=!0:t>112.5&&t<=157.5?(i.down=!0,i.left=!0):t>157.5&&t<=202.5?i.left=!0:t>202.5&&t<=247.5?(i.left=!0,i.up=!0):t>247.5&&t<=292.5?i.up=!0:t>292.5&&t<=337.5?(i.up=!0,i.right=!0):i.right=!0}return i};const _v=Phaser.Utils.Objects.GetValue,Sv=Phaser.Math.RadToDeg;class Tv extends iv{constructor(t,e){super(t,e);var i=this,s={states:{IDLE:{enter:function(){i.x=0,i.y=0,i.worldX=0,i.worldY=0},exit:function(){var t=i.lastPointer;i.x=t.x,i.y=t.y,i.worldX=t.worldX,i.worldY=t.worldY}},BEGIN:{enter:function(){i.validDrag=!1}},RECOGNIZED:{enter:function(){i.start(),i.updateDirectionStates(),i.emit("swipe",i,i.gameObject,i.lastPointer)},exit:function(){i.stop(),i.clearDirectionStates()}}},init:function(){this.state=Ov},eventEmitter:!1};this.setRecongizedStateObject(new Bm(s)),this.clearDirectionStates()}resetFromJSON(t){return super.resetFromJSON(t),this.setDragThreshold(_v(t,"threshold",10)),this.setMinDragVelocity(_v(t,"velocityThreshold",1e3)),this.setDirectionMode(_v(t,"dir","8dir")),this}onDragStart(){this.state=Ev}onDragEnd(){this.state=Ov}onDrag(){this.state===Ev&&(this.validDrag||(this.validDrag=0===this.dragThreshold||this.pointer.getDistance()>=this.dragThreshold),this.validDrag&&this.dragVelocity>this.minDragVelocity&&(this.state=Pv))}postUpdate(t,e){this.state===Pv&&(this.state=Ov)}get isSwiped(){return this.state===Pv}get dragVelocity(){var t;switch(this.dirMode){case 0:t=this.getVelocityY();break;case 1:t=this.getVelocityX();break;default:t=this.getVelocity()}return t}setDragThreshold(t){return this.dragThreshold=t,this}setMinDragVelocity(t){return this.minDragVelocity=t,this}setDirectionMode(t){return"string"==typeof t&&(t=wv[t]),this.dirMode=t,this}updateDirectionStates(){var t=Sv(this.getVelocityAngle());return Cv(t,this.dirMode,this),this}clearDirectionStates(){return this.left=!1,this.right=!1,this.up=!1,this.down=!1,this}}Object.assign(Tv.prototype,yv);const Ov="IDLE",Ev="BEGIN",Pv="RECOGNIZED";var Mv=Tv;const Iv=Phaser.Utils.Objects.GetValue;var Bv=function(t,e){var i=Iv(e,"swipe",void 0);!1!==i&&(void 0===i&&(i={}),i.dir="4dir",t._swipe=new Mv(t,i),t._swipe.on("swipe",(function(e,i,s){var n=e.left?"left":e.right?"right":e.up?"up":"down";Yf(this.eventEmitter,"cell.swipe"+n,t,e.x,e.y,s)}),this))},jv=function(t,e){t.setInteractive(),Af.call(this,t,e),Nf.call(this,t,e),Xf.call(this,t,e),dv.call(this,t,e),vv.call(this,t,e),Bv.call(this,t,e)},zv=function(t){void 0===t?this.items.length=0:this.items=t;var e=this.childrenMap.child;return e.setCellsCount(this.items.length),e.updateTable(!0),this.resizeController(),this};const Dv=Phaser.Utils.Objects.GetValue;class Lv extends Qm{constructor(t,e){void 0===e&&(e={});var i=Em(e),s=Dv(e,"table",void 0);void 0===s&&(s={}),s.scrollMode=i,s.clamplTableOXY=Dv(e,"clamplChildOY",!1);var n,r,a=Dv(s,"width",void 0),o=Dv(s,"height",void 0),h=new Uf(t,0,0,a,o,s);t.add.existing(h),0===i?(n=void 0===a?1:0,r=void 0===o):(n=void 0===o?1:0,r=void 0===a),Ff(h),e.type="rexGridTable",e.child={gameObject:h,proportion:n,expand:r};var l=Dv(e,"space",void 0);l&&(l.child=l.table),super(t,e),this.addChildrenMap("table",h),this.eventEmitter=Dv(e,"eventEmitter",this);var d=Dv(e,"createCellContainerCallback",wa),c=Dv(e,"createCellContainerCallbackScope",void 0);this.setCreateCellContainerCallback(d,c),Wf.call(this,h),Dv(s,"interactive",!0)&&jv.call(this,h,s),this.setItems(Dv(e,"items",[]))}setCreateCellContainerCallback(t,e){return this.createCellContainerCallback=t,this.createCellContainerCallbackScope=e,this}refresh(){return this.setItems(this.items),this}getCellContainer(t){return this.childrenMap.child.getCellContainer(t)}updateVisibleCell(t){return this.childrenMap.child.updateVisibleCell(t)}}var Rv={setItems:zv};Object.assign(Lv.prototype,Rv);var Uv=Lv;zr.register("gridTable",(function(t){var e=new Uv(this.scene,t);return this.scene.add.existing(e),e})),Qr(window,"RexPlugins.UI.GridTable",Uv);var Fv=function(t,e){return t.sameOrientation?t.orientation=e.orientation:t.orientation=0===e.orientation?1:0,t},Wv={expandSubMenu:function(t,e){var i;this.collapseSubMenu(),i=this.root.toggleOrientation?0===this.orientation?1:0:this.orientation;var s=new this.constructor(this.scene,{items:e,orientation:i,createBackgroundCallback:this.root.createBackgroundCallback,createBackgroundCallbackScope:this.root.createBackgroundCallbackScope,createButtonCallback:this.root.createButtonCallback,createButtonCallbackScope:this.root.createButtonCallbackScope,easeIn:this.root.easeIn,easeOut:this.root.easeOut,_rootMenu:this.root,_parentMenu:this,_parentButton:t});return this.pin(s),this.childrenMap.subMenu=s,this.root.emit("expand",s,t,this),this},collapse:function(){return this.root.emit("collapse",this,this.parentButton,this.root),this.scaleDownDestroy(Fv(this.root.easeOut,this)),this.collapseSubMenu(),this},collapseSubMenu:function(){if(void 0===this.childrenMap.subMenu)return this;var t=this.childrenMap.subMenu;return this.childrenMap.subMenu=void 0,this.remove(t),t.collapse(),this}},Yv=function(t,e,i,s){var n;return i&&(e.scene=t,n=s?i.call(s,e):i(e),e.scene=void 0),n},Av=function(t,e,i,s){var n,r,a=[];if(e&&i)for(var o=0,h=e.length;o<h;o++)(n=e[o]).scene=t,r=s?i.call(s,n,o,e):i(n,o,e),n.scene=void 0,a.push(r);return a},Hv=function(t){t.on(t.root.expandEventName,(function(t,e){if(!this._isPassedEvent){var i=this.items[e].children;i&&this.expandSubMenu(t,i)}}),t).on("button.click",(function(t,e,i,s){this!==this.root&&(this.root._isPassedEvent=!0,this.root.emit("button.click",t,e,i,s),this.root._isPassedEvent=!1)}),t).on("button.over",(function(t,e,i,s){this!==this.root&&(this.root._isPassedEvent=!0,this.root.emit("button.over",t,e,i,s),this.root._isPassedEvent=!1)}),t).on("button.out",(function(t,e,i,s){this!==this.root&&(this.root._isPassedEvent=!0,this.root.emit("button.out",t,e,i,s),this.root._isPassedEvent=!1)}),t)};const Vv=Phaser.Utils.Objects.GetValue;class Nv extends bg{constructor(t,e){void 0===e&&(e={}),e.hasOwnProperty("orientation")||(e.orientation=1);var i=e._rootMenu,s=e._parentMenu,n=e._parentButton,r=Vv(e,"items",void 0),a=Vv(e,"createBackgroundCallback",void 0),o=Vv(e,"createBackgroundCallbackScope",void 0);e.background=Yv(t,r,a,o);var h=Vv(e,"createButtonCallback",void 0),l=Vv(e,"createButtonCallbackScope",void 0);e.buttons=Av(t,r,h,l),super(t,e),this.type="rexMenu",this.items=r,this.root=void 0===i?this:i,this.parentMenu=s,this.parentButton=n;var d=this.root===this;if(d){var c=e.bounds;void 0===c&&(c=Bl(t)),this.bounds=c,this.subMenuSide=[this.y<c.centerY?Zv:Kv,this.x<c.centerX?Jv:Xv],void 0!==(f=Vv(e,"subMenuSide",void 0))&&("string"==typeof f&&(f=qv[f]),this.subMenuSide[this.orientation]=f),this.toggleOrientation=Vv(e,"toggleOrientation",!1),this.expandEventName=Vv(e,"expandEvent","button.click"),this.easeIn=Gv(this,Vv(e,"easeIn",0)),this.easeOut=Gv(this,Vv(e,"easeOut",0)),this.createBackgroundCallback=a,this.createBackgroundCallbackScope=o,this.createButtonCallback=h,this.createButtonCallbackScope=l,this._isPassedEvent=!1}var u=0,p=0;if(!this.root.easeIn.sameOrientation){var g=Fv(this.root.easeIn,this).orientation,m=s?s.orientation:this.orientation,f=this.root.subMenuSide[m];0===g&&f===Xv&&(u=1),1===g&&f===Kv&&(p=1)}if(this.setOrigin(u,p).layout(),!d)switch(f=this.root.subMenuSide[s.orientation]){case Xv:this.alignTop(n.top).alignRight(n.left);break;case Jv:this.alignTop(n.top).alignLeft(n.right);break;case Kv:this.alignLeft(n.left).alignBottom(n.top);break;case Zv:this.alignLeft(n.left).alignTop(n.bottom)}this.pushIntoBounds(this.root.bounds),Hv(this),this.popUp(Fv(this.root.easeIn,this)),this.once("popup.complete",(function(){this!==this.root&&this.root.emit("popup.complete",this)}),this)}isInTouching(t){return!!super.isInTouching(t)||!!this.childrenMap.subMenu&&this.childrenMap.subMenu.isInTouching(t)}}var Gv=function(t,e){return"number"==typeof e&&(e={duration:e}),e.hasOwnProperty("orientation")&&void 0!==e.orientation?e.sameOrientation=lu(e.orientation)===t.orientation:e.sameOrientation=!0,e};const Xv=2,Jv=0,Kv=3,Zv=1,qv={up:Kv,down:Zv,left:Xv,right:Jv};Object.assign(Nv.prototype,Wv);var $v=Nv;zr.register("menu",(function(t){var e=new $v(this.scene,t);return this.scene.add.existing(e),e})),Qr(window,"RexPlugins.UI.Menu",$v);const Qv=Phaser.GameObjects.Text;var tb=function(t){return t instanceof Qv};const eb=Phaser.Utils.Objects.GetValue,ib=Phaser.Math.Clamp;var sb=function(t){return Array.isArray(t)?t=t.join("\n"):"number"==typeof t&&(t=t.toString()),t},nb=class{constructor(t,e){this.gameObject=t,this.scene=Wd(t),this.setTextObjectType(),this.lines=void 0,this.resetFromJSON(e),this.boot()}resetFromJSON(t){return this.setText(eb(t,"text","")),this.setStartIdx(eb(t,"start",0)),this.setPageIdx(eb(t,"page",-1)),this}toJSON(){return{text:this.text,start:this.startLineIdx,page:this.pageIndex,pageCount:this.pageCount}}boot(){this.gameObject.on("destroy",this.destroy,this)}shutdown(){return void 0===this.lines||(0===this.textObjectType?this.lines.length=0:this.lines.destroy()),this.gameObject=void 0,this.scene=void 0,this}destroy(){this.shutdown()}setTextObjectType(){return this.textObjectType=tb(this.gameObject)?0:1,this}get isFirstPage(){return this.pageIndex<=0}get isLastPage(){return this.pageIndex>=this.pageCount-1}setText(t,e){return void 0===e&&(e=!0),this.text=sb(t),0===this.textObjectType?this.lines=this.gameObject.getWrappedText(this.text):this.lines=this.gameObject.getPenManager(this.text,this.lines),this.pageCount=Math.ceil(this.totalLinesCount/this.pageLinesCount),e&&this.resetPageIdx(),this}appendText(t){return this.setText(this.text.concat(sb(t))),this}getPage(t){return void 0===t&&(t=this.pageIndex),this.setPageIdx(t).getLines()}getNextPage(){return this.getPage(this.pageIndex+1)}getPreviousPage(){return this.getPage(this.pageIndex-1)}showPage(t){return this.displayText(this.getPage()),this}showNextPage(){return this.displayText(this.getNextPage()),this}showPreviousPage(){return this.displayText(this.getPreviousPage()),this}show(){return this.displayText(this.getLines()),this}showNextLine(){return this.displayText(this.setStartIdx(this.startLineIdx+1).getLines()),this}showPreviousLine(){return this.displayText(this.setStartIdx(this.startLineIdx-1).getLines()),this}setStartIdx(t){return t=ib(t,0,this.totalLinesCount-1),this.startLineIdx=t,this}resetPageIdx(){this.pageIndex=-1}setPageIdx(t){return t=ib(t,0,this.pageCount-1),this.pageIndex=t,this.setStartIdx(this.pageIndex*this.pageLinesCount),this}get totalLinesCount(){return 0===this.textObjectType?this.lines.length:this.lines.linesCount}get pageLinesCount(){var t=this.gameObject.style.maxLines;return t>0?t:this.totalLinesCount}getLines(t){void 0===t&&(t=this.startLineIdx);var e,i=t+this.pageLinesCount;if(0===this.textObjectType)e=this.lines.slice(t,i).join("\n");else{var s=this.lines.getLineStartIndex(t),n=this.lines.getLineEndIndex(i-1);e=this.lines.getSliceTagText(s,n,!0)}return e}displayText(t){this.gameObject.setText(t)}};const rb=Phaser.Utils.Objects.GetFastValue,ab=Phaser.Utils.Objects.GetValue;class ob{constructor(t,e){this.gameObject=t,this.scene=Wd(t),this.setEventEmitter(ab(e,"eventEmitter",void 0)),this.timer=null,this.resetFromJSON(e),this.boot()}resetFromJSON(t){this.setTypeMode(ab(t,"typeMode",0)),this.setTypeSpeed(ab(t,"speed",333)),this.setTextCallback=rb(t,"setTextCallback",null),this.setTextCallbackScope=rb(t,"setTextCallbackScope",null),this.typingIdx=rb(t,"typingIdx",0),this.text=hb(rb(t,"text","")),this.textLen=rb(t,"textLen",0),this.insertIdx=rb(t,"insertIdx",null);var e=rb(t,"elapsed",null);return null!==e&&this.start(void 0,void 0,this.typingIdx,e),this}toJSON(){var t,e=this.getTimer();return t=e?e.elapsed:null,{typeMode:this.typeMode,speed:this.speed,setTextCallback:this.setTextCallback,setTextCallbackScope:this.setTextCallbackScope,typingIdx:this.typingIdx,text:this.text,textLen:this.textLen,insertIdx:this.insertIdx,elapsed:t}}boot(){return this.gameObject.once&&this.gameObject.on("destroy",this.destroy,this),this}shutdown(){return this.destroyEventEmitter(),this.freeTimer(),this.gameObject=void 0,this.scene=void 0,this}destroy(){return this.shutdown(),this}setTypeMode(t){return"string"==typeof t&&(t=lb[t]),this.typeMode=t,this}setTypeSpeed(t){return this.speed=t,this}get isTyping(){return null!==this.getTimer()}get isLastChar(){return this.typingIdx===this.textLen}start(t,e,i,s){return void 0!==t&&this.setTypingContent(t),void 0!==e&&(this.speed=e),void 0===i&&(i=0),this.typingIdx=i+1,0===this.speed?this.stop(!0):this.startTimer(s),this}appendText(t){var e=this.text.concat(hb(t));return this.isTyping?this.setTypingContent(e):this.start(e,void 0,this.textLen),this}stop(t){return this.getTimer()&&this.freeTimer(),t&&(this.typingIdx=this.textLen,this.setText(this.text),this.emit("type"),this.emit("complete",this,this.gameObject)),this}pause(){var t=this.getTimer();return t&&(t.paused=!0),this}resume(){var t=this.getTimer();return t&&(t.paused=!1),this}setTypingContent(t){return this.text=hb(t),this.textLen=this.getTextLength(this.text),this}onTyping(){var t=this.getTypingString(this.text,this.typingIdx,this.textLen,this.typeMode);this.setText(t),this.emit("type"),this.isLastChar?(this.freeTimer(),this.emit("complete",this,this.gameObject)):(this.timer.delay=this.speed,this.typingIdx++)}getTypingString(t,e,i,s){var n;if(0===s){var r=0,a=e;this.insertIdx=a,n=this.getSubString(t,r,a)}else if(1===s){r=(a=i)-e;this.insertIdx=0,n=this.getSubString(t,r,a)}else if(2===s){var o=i/2;a=(r=Math.floor(o-e/2))+e;this.insertIdx=e%2?e:0,n=this.getSubString(t,r,a)}else if(3===s){var h,l=Math.floor(e/2);if(l>0){r=(a=i)-l;h=this.getSubString(t,r,a)}else h="";var d,c=e-l;if(c>0){a=(r=0)+c;this.insertIdx=a,d=this.getSubString(t,r,a)}else d="",this.insertIdx=0;n=d+h}return n}startTimer(t){var e;return this.timer&&this.freeTimer(),void 0===t?(0,e=0):(this.speed,e=t),this.timer=this.scene.time.addEvent({delay:0,startAt:e,loop:!0,callback:this.onTyping,callbackScope:this}),this}getTimer(){return this.timer}freeTimer(){return this.timer&&(this.timer.remove(),this.timer=null),this}setText(t){this.setTextCallback&&(t=this.setTextCallbackScope?this.setTextCallback.call(this.setTextCallbackScope,t,this.isLastChar,this.insertIdx):this.setTextCallback(t,this.isLastChar,this.insertIdx)),this.gameObject.setText(t)}getTextLength(t){var e=this.gameObject;return e.getPlainText?e.getPlainText(t).length:t.length}getSubString(t,e,i){var s=this.gameObject;return s.getSubString?s.getSubString(t,e,i):t.slice(e,i)}}Object.assign(ob.prototype,Rd);var hb=function(t){return Array.isArray(t)?t=t.join("\n"):"number"==typeof t&&(t=t.toString()),t};const lb={"left-to-right":0,"right-to-left":1,"middle-to-sides":2,"sides-to-middle":3};var db=ob;const cb=Phaser.Utils.Objects.GetValue;var ub=function(t){return t.add.text(0,0,"",{wordWrap:{width:200},maxLines:5})},pb=class extends Up{constructor(t,e){void 0===e&&(e={text:ub(t)}),super(t,e),this.type="rexTextBox";var i=this.childrenMap.text;this.page=new nb(i,cb(e,"page",void 0)),this.typing=new db(i,cb(e,"type",void 0)),this.typing.on("complete",this.onPageEnd,this).on("type",this.onType,this),this.textWidth=i.width,this.textHeight=i.height}start(t,e){return this.page.setText(t),void 0!==e&&this.setTypeSpeed(e),this.typeNextPage(),this}typeNextPage(){if(this.page.isLastPage)this.emit("complete");else{var t=this.page.getNextPage();this.typing.start(t)}return this}pause(){return this.typing.pause(),this}resume(){return this.typing.resume(),this}stop(t){return this.typing.stop(t),this}setTypeSpeed(t){return this.typing.setTypeSpeed(t),this}get isTyping(){return this.typing.isTyping}get isLastPage(){return this.page.isLastPage}get isFirstPage(){return this.page.isFirstPage}get pageCount(){return this.page.pageCount}get pageIndex(){return this.page.pageIndex}onType(){var t=this.childrenMap.text;this.textWidth===t.width&&this.textHeight===t.height||(this.textWidth=t.width,this.textHeight=t.height,this.getTopmostSizer().layout()),this.emit("type")}onPageEnd(){this.emit("pageend")}};zr.register("textBox",(function(t){var e=new pb(this.scene,t);return this.scene.add.existing(e),e})),Qr(window,"RexPlugins.UI.TextBox",pb);const gb=Phaser.Utils.Objects.GetValue,mb=Phaser.Math.Percent,fb=Phaser.Math.Linear;class vb extends pu{constructor(t,e){super(t,e),this.type="rexNumberBar";var i,s=gb(e,"background",void 0),n=gb(e,"icon",void 0),r=gb(e,"iconMask",void 0),a=gb(e,"slider",void 0),o=gb(e,"text",void 0),h=gb(e,"space.icon",0),l=gb(e,"space.slider",0);(s&&this.addBackground(s),n)&&(0===this.orientation?(a||o)&&(d={right:h}):(a||o)&&(d={bottom:h}),this.add(n,0,"center",d),r&&(r=this.addChildMask(n,n,1)));if(a){var d,c;if(a.orientation=this.orientation,a.eventEmitter=this,a.value=null,a.hasOwnProperty("input")||(a.input=-1),i=new Sm(t,a),0===this.orientation?o&&(d={right:l}):o&&(d={bottom:l}),0===this.orientation)c=void 0===gb(a,"width",void 0)?1:0;else c=void 0===gb(a,"height",void 0)?1:0;this.add(i,c,"center",d)}o&&this.add(o),this.addChildrenMap("background",s),this.addChildrenMap("icon",n),this.addChildrenMap("iconMask",r),this.addChildrenMap("slider",i),this.addChildrenMap("text",o);var u=gb(e,"valuechangeCallback",null);if(null!==u){var p=gb(e,"valuechangeCallbackScope",void 0);this.on("valuechange",u,p)}this.setEnable(gb(e,"enable",void 0)),this.setValue(gb(e,"value",0))}setEnable(t){return this.childrenMap.slider||(void 0===t&&(t=!0),this.childrenMap.slider.enable=t),this}get value(){return this.childrenMap.slider?this.childrenMap.slider.value:0}set value(t){this.childrenMap.slider&&(this.childrenMap.slider.value=t)}setValue(t,e,i){return void 0!==e&&(t=mb(t,e,i)),this.value=t,this}addValue(t,e,i){return void 0!==e&&(t=mb(t,e,i)),this.value+=t,this}getValue(t,e){var i=this.value;return void 0!==t&&(i=fb(t,e,i)),i}get text(){var t=this.childrenMap.text;return void 0===t?"":t.text?t.text:t.getData("text")}set text(t){var e=this.childrenMap.text;void 0!==e&&(e.setText?e.setText(t):e.setData("text",t))}setText(t){return this.text=t,this}}var bb={addChildMask:zp};Object.assign(vb.prototype,bb);var xb=vb;zr.register("numberBar",(function(t){var e=new xb(this.scene,t);return this.scene.add.existing(e),e})),Qr(window,"RexPlugins.UI.NumberBar",xb);var yb=function(t,e,i,s,n){return t.setVisible(!1),this.add(t,e,i,s,n),this},wb=function(t){return void 0===t?null:this.sizerChildren.hasOwnProperty(t)?this.sizerChildren[t]:null};const kb=Lh.prototype.setChildVisible;var Cb={addPage:yb,getPage:wb,swapPage:function(t){this._previousKey=this._currentKey;var e=this.previousPage;e&&(0===this.swapMode?(kb.call(this,e,!1),this.emit("pageinvisible",e,this._previousKey,this)):e.destroy()),t&&!this.sizerChildren.hasOwnProperty(t)&&this.emit("createpage",t,this),this._currentKey=t;var i=this.currentPage;return i&&(kb.call(this,i,!0),this.emit("pagevisible",i,this._currentKey,this)),this}};const _b=Phaser.Utils.Objects.GetValue;class Sb extends Mp{constructor(t,e){super(t,e),this.type="rexPages",this.childrenMap=this.sizerChildren,this._previousKey=void 0,this._currentKey=void 0,this.setSwapMode(_b(e,"swapMode",0))}setSwapMode(t){return"string"==typeof t&&(t=Tb[t]),this.swapMode=t,this}get previousKey(){return this._previousKey}get currentKey(){return this._currentKey}set currentKey(t){this.swapPage(t)}get currentPage(){return this.getPage(this.currentKey)}get previousPage(){return this.getPage(this.previousKey)}get keys(){return Object.keys(this.sizerChildren)}}Object.assign(Sb.prototype,Cb);const Tb={invisible:0,destroy:1};var Ob=Sb;zr.register("pages",(function(t){var e=new Ob(this.scene,t);return this.scene.add.existing(e),e})),Qr(window,"RexPlugins.UI.Pages",Ob);const Eb=Phaser.Display.Align.TOP_LEFT;var Pb=function(t){return(t-this.textLineSpacing)/(this.textLineHeight+this.textLineSpacing)},Mb=function(t){return t*(this.textLineHeight+this.textLineSpacing)-this.textLineSpacing},Ib=function(t){var e,i=t+this.textObject.style.maxLines;if(0===this.textObjectType)e=this.lines.slice(t,i).join("\n");else{var s=this.lines.getLineStartIndex(t),n=this.lines.getLineEndIndex(i-1);e=this.lines.getSliceTagText(s,n,!0)}return e},Bb=function(){var t=this.textObject.rexSizer;this.textObject.y+=t.offsetY-t.preOffsetY,t.preOffsetY=t.offsetY,this.resetChildPositionState(this.textObject)},jb=function(t,e,i){if(i+=this.textLineHeight+this.textLineSpacing,t.width!==e||t.height!==i){t.setFixedSize(e,i);var s=t.style,n=Math.max(e,0),r=Math.ceil(Pb.call(this,i))+1;0===this.textObjectType?(s.wordWrapWidth=n,s.maxLines=r):(s.wrapWidth=n,s.maxLines=r),this.setText()}},zb={addChildMask:zp,setTextObject:function(t,e){void 0===e&&(e=!0),this.add(t);var i=this.getSizerConfig(t);return i.align=Eb,i.padding=vd(0),i.expand=!0,this.textObject=t,this.textObjectType=tb(t)?0:1,i.preOffsetY=0,i.offsetY=0,e&&(this.textMask=this.addChildMask(this.textObject,this)),this},setText:function(t){return void 0!==t&&(this.text=t),0===this.textObjectType?this.lines=this.textObject.getWrappedText(this.text):this.lines=this.textObject.getPenManager(this.text,this.lines),this.updateTextObject(),this},updateTextObject:function(){var t=Math.max(Math.floor(Pb.call(this,-this.textOY)),0),e=Mb.call(this,t)+this.textOY;return this.textObject.setText(Ib.call(this,t)),this.textObject.rexSizer.offsetY=e,Bb.call(this),this},_layout:function(t,e,i){if(this.rexSizer.hidden||!this.dirty)return this;var s,n,r;this.preLayout(t),void 0===e&&(e=this.minWidth),void 0===i&&(i=this.minHeight),this.resize(e,i);var a,o,h,l,d=this.left,c=this.top;return(s=this.textObject).rexSizer.hidden||(a=d+(r=(n=s.rexSizer).padding).left,o=c+r.top,h=this.width-r.left-r.right,l=this.height-r.top-r.bottom,jb.call(this,s,h,l),Rl.setPosition(a,o).setSize(h,l),dd(s,Rl,n.align),n.preOffsetY=0,Bb.call(this),this.textMask&&(this.textMask.setPosition().resize(),this.resetChildPositionState(this.textMask))),this.layoutBackgrounds(),this.postLayout()}};const Db=Phaser.Utils.Objects.IsPlainObject,Lb=Phaser.Utils.Objects.GetValue;class Rb extends Wc{constructor(t,e,i,s,n,r){Db(e)?(e=Lb(r=e,"x",0),i=Lb(r,"y",0),s=Lb(r,"width",void 0),n=Lb(r,"height",void 0)):Db(s)&&(s=Lb(r=s,"width",void 0),n=Lb(r,"height",void 0)),super(t,e,i,s,n,r),this.type="rexTextBlock",this.textObject=void 0,this.textMask=void 0,this.textObjectType=void 0,this.lines=void 0,this.text=Lb(r,"content",""),this._textOY=0,this.execeedTopState=!1,this.execeedBottomState=!1,this.setClampMode(Lb(r,"clamplTextOY",!0));var a=Lb(r,"background",void 0),o=Lb(r,"text",void 0);void 0===o&&(o=Ub(t));var h=Lb(r,"textMask",!0);a&&this.addBackground(a),this.setTextObject(o,h),this.addChildrenMap("background",a),this.addChildrenMap("text",o)}destroy(t){this.scene&&(this.textObject=void 0,this.textMask=void 0,void 0===this.lines||(0===this.textObjectType?this.lines.length=0:this.lines.destroy()),super.destroy(t))}setClampMode(t){return void 0===t&&(t=!0),this.clampTextOY=t,this}get textLineHeight(){var t=this.textObject.style;return t.metrics.fontSize+t.strokeThickness}get textLineSpacing(){return this.textObject.lineSpacing}get linesCount(){return void 0===this.lines?0:0===this.textObjectType?this.lines.length:this.lines.linesCount}get visibleLinesCount(){return Math.floor(Pb.call(this,this.textObject.height))}get topTextOY(){return 0}get bottomTextOY(){return-this.textVisibleHeight}get textHeight(){return Mb.call(this,this.linesCount)}get textObjectHeight(){return this.textObject.height-this.textLineHeight-this.textLineSpacing}get textVisibleHeight(){var t=this.textHeight,e=this.textObjectHeight;return t>e?t-e:0}textOYExceedTop(t){return void 0===t&&(t=this.textOY),t>this.topTextOY}textOYExeceedBottom(t){return void 0===t&&(t=this.textOY),t<this.bottomTextOY}get textOY(){return this._textOY}set textOY(t){var e=this.topTextOY,i=this.bottomTextOY,s=this.textOYExceedTop(t),n=this.textOYExeceedBottom(t);this.clampTextOY&&(this.visibleLinesCount>this.linesCount?t=0:s?t=e:n&&(t=i)),this._textOY!==t&&(this._textOY=t,this.updateTextObject()),s&&(this.execeedTopState||this.emit("execeedtop",this,t,e)),this.execeedTopState=s,n&&(this.execeedBottomState||this.emit("execeedbottom",this,t,i)),this.execeedBottomState=n}setTextOY(t){return this.textOY=t,this}set t(t){this.textOY=-this.textVisibleHeight*t}get t(){var t=this.textVisibleHeight;return 0===t?0:this.textOY/-t}setTextOYByPercentage(t){return this.t=t,this}}var Ub=function(t){return t.add.text(0,0,"")};Object.assign(Rb.prototype,zb);var Fb=Rb;zr.register("textBlock",(function(t,e,i,s,n,r){var a=new Fb(this.scene,t,e,i,s,n,r);return this.scene.add.existing(a),a})),Qr(window,"RexPlugins.UI.TextBlock",Fb);var Wb=function(t){Object.defineProperty(t,"childOY",{configurable:!0,get:function(){return t.textOY},set:function(e){t.textOY=e}}),Object.defineProperty(t,"topChildOY",{get:function(){return t.topTextOY}}),Object.defineProperty(t,"bottomChildOY",{get:function(){return t.bottomTextOY}})},Yb=function(t){return this.childrenMap.child.setText(t),this.resizeController(),this},Ab=function(t){return this.setText(this.text+t),this};const Hb=Phaser.Utils.Objects.GetValue;class Vb extends Qm{constructor(t,e){void 0===e&&(e={});var i=Hb(e,"text",void 0),s=Hb(e,"textWidth",void 0),n=Hb(e,"textHeight",void 0),r=Hb(e,"textMask",!0),a=Hb(e,"content",""),o=new Fb(t,{width:s,height:n,text:i,textMask:r,content:a,clamplTextOY:Hb(e,"clamplChildOY",!1)});t.add.existing(o);var h=void 0===s?1:0,l=void 0===n;Wb(o),e.scrollMode=0,e.type="rexTextArea",e.child={gameObject:o,proportion:h,expand:l};var d=Hb(e,"space",void 0);d&&(d.child=d.text),super(t,e),this.addChildrenMap("text",i)}get text(){return this.childrenMap.child.text}get linesCount(){return this.childrenMap.child.linesCount}get contentHeight(){return this.childrenMap.child.textHeight}}var Nb={setText:Yb,appendText:Ab};Object.assign(Vb.prototype,Nb);var Gb=Vb;zr.register("textArea",(function(t){var e=new Gb(this.scene,t);return this.scene.add.existing(e),e})),Qr(window,"RexPlugins.UI.TextArea",Gb);const Xb=Phaser.Utils.Objects.GetValue,Jb=Phaser.Display.Align.TOP_LEFT;const Kb={update:0,everyTick:1};var Zb={addChildMask:zp,enableChildrenMask(t){var e=this.addChildMask(null,this,0,t);return this.childrenMask=e.createGeometryMask(),this},maskChildren(t){return void 0===t&&(t=this.getAllChildren()),ff(this,this.childrenMask,t),this},layoutChildrenMask(){if(void 0===this.childrenMask)return this;var t=of(this.childrenMask);return t.setPosition().resize(),this.resetChildPositionState(t),this}},qb={setChild:function(t,e,i){t.setOrigin&&t.setOrigin(0),this.add(t);var s,n,r,a=this.getSizerConfig(t);return a.align=Jb,a.expand=e,this.child=t,!0===i?(s=!0,n=0,r=0):!1===i?s=!1:(s=Xb(i,"mask",!0),n=Xb(i,"padding",0),r=Xb(a,"updateMode",0)),this.maskUpdateMode=r,s&&("string"==typeof r&&(r=Kb[r]),1===r&&this.scene.game.events.on("poststep",this.maskChildren,this),this.enableChildrenMask(n)),this},getChildrenWidth:function(){if(this.rexSizer.hidden)return 0;var t=this.child;return t.rexSizer.hidden?0:0===this.scrollMode?t.isRexSizer?Math.max(t.minWidth,t.childrenWidth):Fl(t):0},getChildrenHeight:function(){if(this.rexSizer.hidden)return 0;var t=this.child;return t.rexSizer.hidden||0===this.scrollMode?0:t.isRexSizer?Math.max(t.minHeight,t.childrenHeight):Wl(t)},getChildrenSizers:function(t){return void 0===t&&(t=[]),this.child&&this.child.isRexSizer&&t.push(this.child),t},resetChildPosition:function(){var t=this.left,e=this.top;0===this.scrollMode?e+=this.childOY:t+=this.childOY,this.child.setPosition(t,e),this.resetChildPositionState(this.child),0===this.maskUpdateMode&&this.maskChildren()},_layout:function(t,e,i){if(this.rexSizer.hidden||!this.dirty)return this;this.preLayout(t),void 0===e&&(e=Math.max(this.childrenWidth,this.minWidth)),void 0===i&&(i=Math.max(this.childrenHeight,this.minHeight)),this.resize(e,i);var s,n,r=this.child;return r.rexSizer.hidden||(0===this.scrollMode?s=this.width:n=this.height,r.isRexSizer?r._layout(this,s,n):zc(r,s,n),this.layoutChildrenMask(),this.resetChildPosition()),this.postLayout()}};Object.assign(qb,Zb);var $b=qb;const Qb=Phaser.Utils.Objects.IsPlainObject,tx=Phaser.Utils.Objects.GetValue;class ex extends Wc{constructor(t,e,i,s,n,r){Qb(e)?(e=tx(r=e,"x",0),i=tx(r,"y",0),s=tx(r,"width",void 0),n=tx(r,"height",void 0)):Qb(s)&&(s=tx(r=s,"width",void 0),n=tx(r,"height",void 0)),super(t,e,i,s,n,r),this.type="rexScrollableBlock",this.child=void 0,this.childrenMask=void 0,this._childOY=0,this.execeedTopState=!1,this.execeedBottomState=!1,this.setScrollMode(tx(r,"scrollMode",!0)),this.setClampMode(tx(r,"clamplChildOY",!0));var a=tx(r,"child",void 0),o=tx(r,"expand",!0),h=tx(r,"mask",void 0);this.setChild(a,o,h)}destroy(t){this.scene&&(1===this.maskUpdateMode&&this.scene.game.events.off("poststep",this.maskChildren,this),this.child=void 0,this.childrenMask&&(this.childrenMask.destroy(),this.childrenMask=void 0),super.destroy(t))}setScrollMode(t){return"string"==typeof t&&(t=Tm[t.toLowerCase()]),this.scrollMode=t,this}setClampMode(t){return void 0===t&&(t=!0),this.clampChildOY=t,this}get instHeight(){return 0===this.scrollMode?this.height:this.width}get instWidth(){return 0===this.scrollMode?this.width:this.height}get childHeight(){return 0===this.scrollMode?Wl(this.child):Fl(this.child)}get childWidth(){return 0===this.scrollMode?Fl(this.child):Wl(this.child)}get topChildOY(){return 0}get bottomChildOY(){return-this.visibleHeight}get visibleHeight(){var t=this.childHeight,e=this.instHeight;return t>e?t-e:0}childOYExceedTop(t){return void 0===t&&(t=this.childOY),t>this.topChildOY}childOYExeceedBottom(t){return void 0===t&&(t=this.childOY),t<this.bottomChildOY}get childOY(){return this._childOY}set childOY(t){var e=this.topChildOY,i=this.bottomChildOY,s=this.childOYExceedTop(t),n=this.childOYExeceedBottom(t);this.clampChildOY&&(this.instHeight>this.childHeight?t=0:s?t=e:n&&(t=i)),this._childOY!==t&&(this._childOY=t,this.resetChildPosition()),s&&(this.execeedTopState||this.emit("execeedtop",this,t,e)),this.execeedTopState=s,n&&(this.execeedBottomState||this.emit("execeedbottom",this,t,i)),this.execeedBottomState=n}setChildOY(t){return this.childOY=t,this}set t(t){this.childOY=-this.visibleHeight*t}get t(){var t=this.visibleHeight;return 0===t?0:this.childOY/-t}setChildOYByPercentage(t){return this.t=t,this}}Object.assign(ex.prototype,$b);var ix=ex;zr.register("scrollableBlock",(function(t){var e=new ix(this.scene,t);return this.scene.add.existing(e),e})),Qr(window,"RexPlugins.UI.ScrollableBlock",ix);const sx=Phaser.Utils.Objects.GetValue;var nx=class extends Qm{constructor(t,e){void 0===e&&(e={});var i=Em(e),s=sx(e,"panel",void 0);void 0===s&&(s={}),s.scrollMode=i,s.clamplChildOY=sx(e,"clamplChildOY",!1);var n=new ix(t,s);t.add.existing(n);var r,a,o=sx(s,"width",void 0),h=sx(s,"height",void 0);0===i?(r=void 0===o?1:0,a=void 0===h):(r=void 0===h?1:0,a=void 0===o),e.type="rexScrollablePanel",e.child={gameObject:n,proportion:r,expand:a};var l=sx(e,"space",void 0);l&&(l.child=l.panel),super(t,e),this.addChildrenMap("panel",this.childrenMap.child.child)}};zr.register("scrollablePanel",(function(t){var e=new nx(this.scene,t);return this.scene.add.existing(e),e})),Qr(window,"RexPlugins.UI.ScrollablePanel",nx);var rx={popUp:0,fadeIn:1,scaleDown:0,fadeOut:1},ax=function(t,e){t.popUp(e)},ox=function(t,e){t.scaleDown(e)},hx=function(t,e){t.fadeIn(e)},lx=function(t,e){t.fadeOut(e)},dx=function(t){return Fd(t)?t.events:t.on?t:void 0};const cx=Phaser.Utils.Objects.GetValue;var ux=class extends qf{constructor(t,e){super(t,e),this.parent=t,this.scene=Wd(t),this.resetFromJSON(e),this.boot()}resetFromJSON(t){return this.isRunning=cx(t,"isRunning",!1),this.timeScale=cx(t,"timeScale",1),this.now=cx(t,"now",0),this}toJSON(){return{isRunning:this.isRunning,timeScale:this.timeScale,now:this.now,tickingMode:this.tickingMode}}boot(){super.boot();var t=dx(this.parent);t&&t.on("destroy",this.destroy,this)}shutdown(){super.shutdown(),this.parent=void 0,this.scene=void 0}destroy(){this.shutdown()}start(t){return void 0===t&&(t=0),this.now=t,super.start(),this}seek(t){return this.now=t,this}tick(t){return t*=this.timeScale,this.now+=t,this.emit("update",this.now,t),this}};var px=class extends ux{startTicking(){super.startTicking(),this.scene.events.on("update",this.update,this)}stopTicking(){super.stopTicking(),this.scene&&this.scene.events.off("update",this.update,this)}update(t,e){return this.isRunning&&0!==this.timeScale?(this.tick(e),this):this}},gx=function(t,e,i,s){void 0===i&&(i=0),void 0===s&&(s=e.length),t.length=s-i;for(var n=0,r=t.length;n<r;n++)t[n]=e[n+i];return t},mx=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,fx=function(t){return"string"!=typeof t||(""===t?t=null:mx.test(t)?t=parseFloat(t):"false"===t?t=!1:"true"===t&&(t=!0)),t};const vx=Phaser.Utils.Objects.GetValue;var bx=function(t,e,i){var s,n=vx(i,"reverse",!1);if(Mh(t[0]))if(n)for(r=(a=t.length)-1;r>=0;r--)s=bx(t[r],e,i);else for(var r=0,a=t.length;r<a;r++)s=bx(t[r],e,i);else s=xx(t,e,i);return s},xx=function(t,e,i){var s,n=vx(i,"argsConvert",void 0),r=vx(i,"argsConvertScope",void 0),a=t[0];if(yx=gx(yx,t,1),n){!0===n&&(n=fx,r=void 0);for(var o=0,h=yx.length;o<h;o++)yx[o]=r?n.call(r,yx[o],t):n(yx[o],t)}return"string"==typeof a?null==(s=e[a])&&(s=vx(e,a,null)):s=a,s.apply(e,yx)},yx=[],wx=bx;const kx=Phaser.Utils.Objects.GetValue;class Cx{constructor(t,e){this.parent=t,this.scene=Wd(t),this.setEventEmitter(kx(e,"eventEmitter",void 0));var i=kx(e,"clockClass",px);this.clock=new i(t,{eventEmitter:this.getEventEmitter()}),this.clock.on("update",this.update,this),this.resetFromJSON(e),this.boot()}resetFromJSON(t){return this.clock.resetFromJSON(kx(t,"clock",void 0)),this.state=kx(t,"state",0),this.commands=kx(t,"commands",[]),this.scope=kx(t,"scope",void 0),this.setTimeUnit(kx(t,"timeUnit",0)),this.setDtMode(kx(t,"dtMode",0)),this.index=kx(t,"index",0),this.nextTime=kx(t,"nextTime",0),this}toJSON(){return{clock:this.clock.toJSON(),state:this.state,commands:this.commands,scope:this.scope,timeUnit:this.timeUnit,dtMode:this.dtMode,index:this.index,nextTime:this.nextTime}}boot(){var t=dx(this.parent);t&&t.on("destroy",this.destroy,this)}shutdown(){this.clock.shutdown(),this.parent=void 0,this.scene=void 0,this.commands=void 0}destroy(){this.shutdown()}load(t,e,i){this.stop();var s=kx(i,"timeUnit",void 0);void 0!==s&&this.setTimeUnit(s);var n=kx(i,"dtMode",void 0);return void 0!==n&&this.setDtMode(n),t=t.filter((function(t){var e=t[0];return!isNaN(e)})).map((function(t){return"string"==typeof t[0]&&(t[0]=parseFloat(t[0])),t})),0===this.dtMode&&t.sort((function(t,e){var i=t[0],s=e[0];return i>s?1:i<s?-1:0})),this.commands=t,this.scope=e,this}start(t){return void 0===t&&(t=0),this.stop(),this.index=0,this.state=1,this.nextTime=this.getNextDt(0),this.clock.start(t),this.update(t),this}pause(){return this.clock.pause(),this}resume(){return this.clock.resume(),this}stop(){return this.clock.stop(),this.state=0,this}seek(t){return this.clock.seek(t),this}get isPlaying(){return this.clock.isRunning}get completed(){return 2===this.state}setTimeScale(t){return this.clock.timeScale=t,this}update(t){if(this.nextTime>t)return this;for(var e=this.commands.length-1;;){var i=this.commands[this.index],s=i[1];if(Mh(s)||(s=gx(_x,i,1)),wx(s,this.scope),this.emit("runcommand",s,this.scope),this.index===e)return this.complete(),this;if(this.index++,this.nextTime=this.getNextDt(this.nextTime),this.nextTime>t)return this}}complete(){this.clock.complete(),this.state=2}getNextDt(t){var e=this.commands[this.index][0];return 1===this.timeUnit&&(e*=1e3),1===this.dtMode&&(e+=t),e}setDtMode(t){return"string"==typeof t&&(t=Tx[t]),this.dtMode=t,this}setTimeUnit(t){return"string"==typeof t&&(t=Sx[t]),this.timeUnit=t,this}}Object.assign(Cx.prototype,Rd);var _x=[];const Sx={ms:0,s:1,sec:1},Tx={abs:0,absolute:0,inc:1,increment:1};var Ox=Cx;const Ex=Phaser.Utils.Objects.GetValue;var Px=class extends Up{constructor(t,e){void 0===e&&(e={text:createDefaultTextObject(t)}),super(t,e),this.type="rexToast",this.setTransitInTime(Ex(e,"duration.in",200)),this.setDisplayTime(Ex(e,"duration.hold",1200)),this.setTransitOutTime(Ex(e,"duration.out",200)),this.setTransitInCallback(Ex(e,"transitIn",rx.popUp)),this.setTransitOutCallback(Ex(e,"transitOut",rx.scaleDown)),this.player=new Ox(this,{dtMode:1}),this.messages=[],this.setVisible(!1)}destroy(t){this.scene&&(this.player.destroy(),this.player=void 0,this.messages=void 0,super.destroy(t))}setDisplayTime(t){return this.displayTime=t,this}setTransitOutTime(t){return this.transitOutTime=t,this}setTransitInTime(t){return this.transitInTime=t,this}setTransitInCallback(t){switch("string"==typeof t&&(t=rx[t]),t){case rx.popUp:t=ax;break;case rx.fadeIn:t=hx}return this.transitInCallback=t,this}setTransitOutCallback(t){switch("string"==typeof t&&(t=rx[t]),t){case rx.scaleDown:t=ox;break;case rx.fadeOut:t=lx}return this.transitOutCallback=t,this}show(t){if(void 0===t){if(0===this.messages.length)return this;t=this.messages.shift()}if(this.player.isPlaying)return this.messages.push(t),this;this.setScale(1,1).setVisible(!0),"string"==typeof t?this.setText(t):t(this),this.layout();var e=[[0,[this.transitInCallback,this,this.transitInTime]],[this.transitInTime,[wa]],[this.displayTime,[this.transitOutCallback,this,this.transitOutTime]],[this.transitOutTime,[this.setVisible,!1]],[30,[wa]]];return this.player.load(e,this).once("complete",(function(){this.show()}),this).start(),this}};zr.register("toast",(function(t){var e=new Px(this.scene,t);return this.scene.add.existing(e),e})),Qr(window,"RexPlugins.UI.Toast",Px);var Mx=function(t,e){return function(i,s,n,r){"panel"!==s&&n.moveChild(i,r?0:t,e)}},Ix=function(t,e){return function(i,s,n,r){"panel"===s&&n.moveChild(i,r?0:t,e)}};const Bx={visible:{show:function(){return function(t,e,i,s){"panel"!==e&&i.setChildVisible(t,!0)}},hide:function(){return function(t,e,i,s){"panel"!==e&&i.setChildVisible(t,!1)}}},fade:{show:function(t,e){return void 0===e&&(e=1),function(i,s,n,r){"panel"!==s&&n.fadeChild(i,r?0:t,e)}},hide:function(t,e){return void 0===e&&(e=0),function(i,s,n,r){"panel"!==s&&n.fadeChild(i,r?0:t,e)}}},move:{show:Mx,hide:Mx},"move-panel":{show:Ix,hide:Ix}};var jx=function(t){var e,i,s,n;return[e,...i]="string"==typeof t?[t]:t,Bx.hasOwnProperty(e)?(s=Bx[e].show.apply(null,i),n=Bx[e].hide.apply(null,i)):(s=wa,n=wa),{show:s,hide:n}},zx={showChild(t,e){var i=this.sizerChildren[t];return i&&(this.emit("showchild",i,t,this,e),this.resetChildState(i)),this},hideChild(t,e){var i=this.sizerChildren[t];return i&&(this.emit("hidechild",i,t,this,e),this.resetChildState(i)),this},swapChild(t,e){return this.currentChildKey===t||("panel"===this.currentChildKey||"panel"===t?(this.previousChildKey=this.currentChildKey,this.currentChildKey=t,this.hideChild(this.previousChildKey,e),this.showChild(this.currentChildKey,e)):(this.swapChild("panel",e),this.swapChild(t,e))),this},showPanel(t){return this.swapChild("panel",t),this},showLeftSide(){return this.swapChild("leftSide"),this},showRightSide(){return this.swapChild("rightSide"),this},showTopSide(){return this.swapChild("topSide"),this},showBottomSide(){return this.swapChild("bottomSide"),this},hideLeftSide(){return"leftSide"==this.currentChildKey&&this.showPanel(),this},hideRightSide(){return"rightSide"==this.currentChildKey&&this.showPanel(),this},hideTopSide(){return"topSide"==this.currentChildKey&&this.showPanel(),this},hideBottomSide(){return"bottomSide"==this.currentChildKey&&this.showPanel(),this},toggleLeftSide(){var t="panel"!==this.currentChildKey?"panel":"leftSide";return this.swapChild(t),this},toggleRightSide(){var t="panel"!==this.currentChildKey?"panel":"rightSide";return this.swapChild(t),this},toggleTopSide(){var t="panel"!==this.currentChildKey?"panel":"topSide";return this.swapChild(t),this},toggleBottomSide(){var t="panel"!==this.currentChildKey?"panel":"bottomSide";return this.swapChild(t),this}};const Dx=Lh.prototype.setChildVisible;var Lx={setChildVisible(t,e){if("string"==typeof t){var i=t;t=this.sizerChildren[i]}else i=Tp(this.sizerChildren,t);return void 0===e&&(e=this.currentChildKey===i),Dx.call(this,t,e),this}},Rx={fadeChild(t,e,i){var s;return"string"==typeof t?(s=t,t=this.sizerChildren[s]):s=Tp(this.sizerChildren,t),void 0===e&&(e=500),void 0===i&&(i=this.currentChildKey===s?1:0),t.fadeIn(e,{start:t.alpha,end:i}),this},fadeChildPromise(t,e,i){return"string"==typeof t&&(t=this.sizerChildren[key]),this.fadeChild(t,e,i),t._fade?tc(t._fade):Promise.resolve()}},Ux={moveChild(t,e,i,s){var n;"string"==typeof t?(n=t,t=this.sizerChildren[n]):n=Tp(this.sizerChildren,t),void 0===e&&(e=500);var r,a,o,h,l=this.currentChildKey===n;if(void 0===s)switch(n){case"leftSide":case"rightSide":s=Fl(t);break;case"topSide":case"bottomSide":s=Wl(t);break;default:if(l)switch(this.previousChildKey){case"leftSide":case"rightSide":s=Fl(this.sizerChildren[this.previousChildKey]);break;case"topSide":case"bottomSide":s=Wl(this.sizerChildren[this.previousChildKey]);break;default:s=0}else switch(this.currentChildKey){case"leftSide":case"rightSide":s=Fl(this.sizerChildren[this.currentChildKey]);break;case"topSide":case"bottomSide":s=Wl(this.sizerChildren[this.currentChildKey]);break;default:s=0}}if(l)switch(n){case"panel":switch(this.previousChildKey){case"leftSide":r=!0;break;case"rightSide":a=!0;break;case"topSide":o=!0;break;case"bottomSide":h=!0}break;case"leftSide":a=!0;break;case"rightSide":r=!0;break;case"topSide":h=!0;break;case"bottomSide":o=!0}else switch(n){case"panel":switch(this.currentChildKey){case"leftSide":a=!0;break;case"rightSide":r=!0;break;case"topSide":h=!0;break;case"bottomSide":o=!0}break;case"leftSide":r=!0;break;case"rightSide":a=!0;break;case"topSide":o=!0;break;case"bottomSide":h=!0}return r?t.moveTo(e,"-="+s,void 0,i):a?t.moveTo(e,"+="+s,void 0,i):o?t.moveTo(e,void 0,"-="+s,i):h?t.moveTo(e,void 0,"+="+s,i):t.moveTo(0),this},moveChildPromise(t,e,i,s){return"string"==typeof t&&(t=this.sizerChildren[key]),this.moveChild(t,e,i,s),t._easeMove?tc(t._easeMove):Promise.resolve()}},Fx={};Object.assign(Fx,Lx,Rx,Ux);var Wx=Fx;const Yx=Phaser.Utils.Objects.GetValue;class Ax extends Mp{constructor(t,e){super(t,e),this.type="rexSides",this.childrenMap=this.sizerChildren,this.previousChildKey=void 0,this.currentChildKey=void 0;var i=Yx(e,"showChildCallback",void 0);if(i)if(Oc(i)){var s=Yx(e,"showChildCallbackScope",void 0);this.on("showchild",i,s);var n=Yx(e,"hideChildCallback",void 0),r=Yx(e,"hideChildCallbackScope",void 0);this.on("hidechild",n,r)}else{var a=jx(i);this.on("showchild",a.show),this.on("hidechild",a.hide)}var o=Yx(e,"background",void 0),h=Yx(e,"panel",void 0),l=Yx(e,"leftSide",void 0),d=Yx(e,"rightSide",void 0),c=Yx(e,"topSide",void 0),u=Yx(e,"bottomSide",void 0);if(o&&this.addBackground(o),h&&this.add(h,"panel","center",0,!0),l){var p=Yx(e,"expand.left",!0);this.add(l,"leftSide","left-top",0,{height:p})}if(d){p=Yx(e,"expand.right",!0);this.add(d,"rightSide","right-top",0,{height:p})}if(c){p=Yx(e,"expand.top",!0);this.add(c,"topSide","left-top",0,{width:p})}if(u){p=Yx(e,"expand.bottom",!0);this.add(u,"bottomSide","left-bottom",0,{width:p})}}reset(){return this.previousChildKey=void 0,this.currentChildKey="panel",this.showChild("panel",!0),this.hideChild("leftSide",!0),this.hideChild("rightSide",!0),this.hideChild("topSide",!0),this.hideChild("bottomSide",!0),this}}Object.assign(Ax.prototype,zx,Wx);var Hx=Ax;zr.register("sides",(function(t){var e=new Hx(this.scene,t);return this.scene.add.existing(e),e})),Qr(window,"RexPlugins.UI.Sides",Hx);zr.register("click",(function(t,e){return Ad(t)||(e=t,t=this.scene),new Hp(t,e)})),Qr(window,"RexPlugins.UI.Click",Hp);zr.register("tap",(function(t,e){return Ad(t)||(e=t,t=this.scene),new hv(t,e)})),Qr(window,"RexPlugins.UI.Tap",hv);zr.register("press",(function(t,e){return Ad(t)||(e=t,t=this.scene),new mv(t,e)})),Qr(window,"RexPlugins.UI.Press",mv);zr.register("swipe",(function(t,e){return Ad(t)||(e=t,t=this.scene),new Mv(t,e)})),Qr(window,"RexPlugins.UI.Swipe",Mv);const Vx=Phaser.Utils.Objects.GetValue;const Nx="IDLE",Gx="BEGIN",Xx="RECOGNIZED";var Jx=class extends iv{constructor(t,e){super(t,e);var i=this,s={states:{IDLE:{},BEGIN:{enter:function(){var t=i.pointer;i.startX=t.x,i.startY=t.y,i.startWorldX=t.worldX,i.startWorldY=t.worldY}},RECOGNIZED:{enter:function(){i.emit("panstart",i,i.gameObject,i.lastPointer)},exit:function(){var t=i.lastPointer;i.endX=t.x,i.endY=t.y,i.endWorldX=t.worldX,i.endWorldY=t.worldY,i.emit("panend",i,i.gameObject,i.lastPointer)}}},init:function(){this.state=Nx},eventEmitter:!1};this.setRecongizedStateObject(new Bm(s))}resetFromJSON(t){return super.resetFromJSON(t),this.setDragThreshold(Vx(t,"threshold",10)),this}onDragStart(){this.state=Gx,0===this.dragThreshold&&(this.state=Xx)}onDragEnd(){this.state=Nx}onDrag(){switch(this.state){case Gx:this.pointer.getDistance()>=this.dragThreshold&&(this.state=Xx);break;case Xx:var t=this.pointer.position,e=this.pointer.prevPosition;this.dx=t.x-e.x,this.dy=t.y-e.y;var i=this.pointer;this.x=i.x,this.y=i.y,this.worldX=i.worldX,this.worldY=i.worldY,this.emit("pan",this,this.gameObject,this.lastPointer)}}get isPan(){return this.state===Xx}setDragThreshold(t){return this.dragThreshold=t,this}};zr.register("pan",(function(t,e){return Ad(t)||(e=t,t=this.scene),new Jx(t,e)})),Qr(window,"RexPlugins.UI.Pan",Jx);const Kx=Phaser.Utils.Objects.GetValue,Zx=Phaser.Utils.Array.SpliceOne,qx=Phaser.Math.Distance.Between,$x=Phaser.Math.Angle.Between;class Qx{constructor(t,e){var i=t.input.manager.pointersTotal-1;i<2&&t.input.addPointer(2-i),this.scene=t,this.setEventEmitter(Kx(e,"eventEmitter",void 0)),this._enable=void 0,this.pointers=[],this.movedState={},this.resetFromJSON(e),this.boot()}resetFromJSON(t){return this.setEnable(Kx(t,"enable",!0)),this.bounds=Kx(t,"bounds",void 0),this.tracerState=ey,this.pointers.length=0,xa(this.movedState),this}boot(){this.scene.input.on("pointerdown",this.onPointerDown,this),this.scene.input.on("pointerup",this.onPointerUp,this),this.scene.input.on("pointermove",this.onPointerMove,this),this.scene.events.once("shutdown",this.destroy,this)}shutdown(){this.destroyEventEmitter(),this.pointers.length=0,xa(this.movedState),this.scene&&(this.scene.input.off("pointerdown",this.onPointerDown,this),this.scene.input.off("pointerup",this.onPointerUp,this),this.scene.input.off("pointermove",this.onPointerMove,this),this.scene.events.off("destroy",this.destroy,this),this.scene=void 0),this.scene=void 0}destroy(){this.shutdown()}get enable(){return this._enable}set enable(t){if(this._enable!==t)return t||this.dragCancel(),this._enable=t,this}setEnable(t){return void 0===t&&(t=!0),this.enable=t,this}toggleEnable(){return this.setEnable(!this.enable),this}onPointerDown(t){if(this.enable&&(2!==this.pointers.length&&(!this.bounds||this.bounds.contains(t.x,t.y))&&-1===this.pointers.indexOf(t)))switch(this.movedState[t.id]=!1,this.pointers.push(t),this.tracerState){case ey:this.tracerState=iy,this.onDrag1Start();break;case iy:this.tracerState=sy,this.onDrag2Start()}}onPointerUp(t){if(this.enable&&(!this.bounds||this.bounds.contains(t.x,t.y))){var e=this.pointers.indexOf(t);if(-1!==e)switch(delete this.movedState[t.id],Zx(this.pointers,e),this.tracerState){case iy:this.tracerState=ey,this.onDrag1End();break;case sy:this.tracerState=iy,this.onDrag2End(),this.onDrag1Start()}}}onPointerMove(t){if(this.enable&&t.isDown){var e=!this.bounds||this.bounds.contains(t.x,t.y),i=-1!==this.pointers.indexOf(t);if(!i&&e);else if(i&&!e)this.onPointerUp(t);else if(this.movedState[t.id]||(this.movedState[t.id]=t.x!==t.downX||t.y!==t.downY),this.movedState[t.id])switch(this.tracerState){case iy:this.onDrag1();break;case sy:this.onDrag2()}}}dragCancel(){return this.tracerState===sy&&this.onDrag2End(),this.pointers.length=0,xa(this.movedState),this.tracerState=ey,this}onDrag1Start(){this.emit("drag1start",this)}onDrag1End(){this.emit("drag1end",this)}onDrag1(){this.emit("drag1",this)}onDrag2Start(){this.emit("drag2start",this)}onDrag2End(){this.emit("drag2end",this)}onDrag2(){this.emit("drag2",this)}get distanceBetween(){if(this.tracerState!==sy)return 0;var t=this.pointers[0],e=this.pointers[1];return qx(t.x,t.y,e.x,e.y)}get angleBetween(){if(this.tracerState!==sy)return 0;var t=this.pointers[0],e=this.pointers[1];return $x(t.x,t.y,e.x,e.y)}get drag1Vector(){var t=this.pointers[0];if(t&&this.movedState[t.id]){var e=t.position,i=t.prevPosition;ty.x=e.x-i.x,ty.y=e.y-i.y}else ty.x=0,ty.y=0;return ty}get centerX(){if(this.tracerState!==sy)return 0;var t=this.pointers[0].position,e=this.pointers[1].position;return(t.x+e.x)/2}get centerY(){if(this.tracerState!==sy)return 0;var t=this.pointers[0].position,e=this.pointers[1].position;return(t.y+e.y)/2}get prevCenterX(){if(this.tracerState!==sy)return 0;var t=this.movedState[this.pointers[0].id]?this.pointers[0].prevPosition:this.pointers[0].position,e=this.movedState[this.pointers[1].id]?this.pointers[1].prevPosition:this.pointers[1].position;return(t.x+e.x)/2}get prevCenterY(){if(this.tracerState!==sy)return 0;var t=this.movedState[this.pointers[0].id]?this.pointers[0].prevPosition:this.pointers[0].position,e=this.movedState[this.pointers[1].id]?this.pointers[1].prevPosition:this.pointers[1].position;return(t.y+e.y)/2}get movementCenterX(){return this.centerX-this.prevCenterX}get movementCenterY(){return this.centerY-this.prevCenterY}setRecongizedStateObject(t){return this.recongizedState=t,this}get state(){return this.recongizedState.state}set state(t){this.recongizedState.state=t}cancel(){return this.state=ny,this}}Object.assign(Qx.prototype,Rd);var ty={};const ey=0,iy=1,sy=2,ny="IDLE";var ry=Qx;const ay=Phaser.Utils.Objects.GetValue;const oy="IDLE",hy="BEGIN",ly="RECOGNIZED";var dy=class extends ry{constructor(t,e){super(t,e);var i=this,s={states:{IDLE:{enter:function(){i.prevDistance=void 0,i.scaleFactor=1}},BEGIN:{},RECOGNIZED:{enter:function(){i.emit("pinchstart",i)},exit:function(){i.emit("pinchend",i)}}},init:function(){this.state=oy},eventEmitter:!1};this.setRecongizedStateObject(new Bm(s))}resetFromJSON(t){return super.resetFromJSON(t),this.setDragThreshold(ay(t,"threshold",0)),this}onDrag2Start(){this.scaleFactor=1,this.prevDistance=this.distanceBetween,this.state=hy,0===this.dragThreshold&&(this.state=ly)}onDrag2End(){this.state=oy}onDrag2(){switch(this.state){case hy:if(this.pointers[0].getDistance()>=this.dragThreshold&&this.pointers[1].getDistance()>=this.dragThreshold){var t=this.distanceBetween;this.scaleFactor=t/this.prevDistance,this.prevDistance=t,this.state=ly}break;case ly:t=this.distanceBetween;this.scaleFactor=t/this.prevDistance,this.emit("pinch",this),this.prevDistance=t}}get isPinch(){return this.state===ly}setDragThreshold(t){return this.dragThreshold=t,this}};zr.register("pinch",(function(t){return new dy(this.scene,t)})),Qr(window,"RexPlugins.UI.Pinch",dy);const cy=Phaser.Math.RotateAround;var uy=function(t,e,i,s){return cy(t,e,i,s),t.rotation+=s,t},py={},gy=function(t,e){if(!this.isRotation)return this;void 0===e&&(e=this.pointers[0].camera);var i=this.movementCenterX,s=this.movementCenterY;e.getWorldPoint(this.centerX,this.centerY,py);var n=py.x,r=py.y,a=this.rotation;if(Array.isArray(t))for(var o=t,h=0,l=o.length;h<l;h++)(t=o[h]).x+=i,t.y+=s,uy(t,n,r,a);else t.x+=i,t.y+=s,uy(t,n,r,a);return this};const my=Phaser.Utils.Objects.GetValue,fy=Phaser.Math.Angle.WrapDegrees,vy=Phaser.Math.Angle.ShortestBetween,by=Phaser.Math.RadToDeg,xy=Phaser.Math.DegToRad;class yy extends ry{constructor(t,e){super(t,e);var i=this,s={states:{IDLE:{enter:function(){i.prevAngle=void 0,i.angle=0}},BEGIN:{},RECOGNIZED:{enter:function(){i.emit("rotatestart",i)},exit:function(){i.emit("rotateend",i)}}},init:function(){this.state=ky},eventEmitter:!1};this.setRecongizedStateObject(new Bm(s))}resetFromJSON(t){return super.resetFromJSON(t),this.setDragThreshold(my(t,"threshold",0)),this}onDrag2Start(){this.prevAngle=fy(by(this.angleBetween)),this.state=Cy,0===this.dragThreshold&&(this.state=_y)}onDrag2End(){this.state=ky}onDrag2(){switch(this.state){case Cy:if(this.pointers[0].getDistance()>=this.dragThreshold&&this.pointers[1].getDistance()>=this.dragThreshold){var t=fy(by(this.angleBetween));this.angle=vy(this.prevAngle,t),this.prevAngle=t,this.state=_y}break;case _y:t=fy(by(this.angleBetween));this.angle=vy(this.prevAngle,t),this.prevAngle=t,this.emit("rotate",this)}}get isRotation(){return this.state===_y}get rotation(){return xy(this.angle)}setDragThreshold(t){return this.dragThreshold=t,this}}var wy={spinObject:gy};Object.assign(yy.prototype,wy);const ky="IDLE",Cy="BEGIN",_y="RECOGNIZED";var Sy=yy;zr.register("rotate",(function(t){return new Sy(this.scene,t)})),Qr(window,"RexPlugins.UI.Rotate",Sy);const Ty=Phaser.Utils.Objects.IsPlainObject,Oy=Phaser.Utils.Objects.GetValue;var Ey=function(t,e,i){var s;if(void 0===t)t=i.texture.key,e=i.frame.name;else if(Ty(t)){var n=t;t=Oy(n,"key",i.texture.key),e=Oy(n,"frame",i.frame.name)}else"string"==typeof t||(s=t);return void 0===s&&(s=function(i){i.setTexture(t,e)}),s};const Py=Phaser.Utils.Objects.GetValue,My=Phaser.Utils.Objects.GetAdvancedValue;const Iy={x:0,horizontal:0,y:1,vertical:1},By={front:0,back:1};var jy=class extends Nd{constructor(t,e){super(t,{eventEmitter:!0}),this.gameObject=t,this.resetFromJSON(e)}resetFromJSON(t){return this.setOrientation(Py(t,"orientation",0)),this.setDelay(My(t,"delay",0)),this.setDuration(My(t,"duration",500)),this.setEase(Py(t,"ease","Sine")),this.setFrontFace(Py(t,"front",void 0)),this.setBackFace(Py(t,"back",void 0)),this.setFace(Py(t,"face",0)),this}shutdown(){return super.shutdown(),this.gameObject=void 0,this}setOrientation(t){return"string"==typeof t&&(t=Iy[t]),this.orientation=t,this}setDelay(t){return this.delay=t,this}setDuration(t){return this.duration=t,this}setEase(t){return void 0===t&&(t="Linear"),this.ease=t,this}get face(){return this._face}set face(t){"string"==typeof t&&(t=By[t]),this._face=t,0===t&&this.frontFaceCallback?this.frontFaceCallback(this.gameObject):1===t&&this.backFaceCallback&&this.backFaceCallback(this.gameObject)}setFace(t){return this.face=t,this}toggleFace(){var t=0===this.face?1:0;return this.setFace(t),this}setFrontFace(t,e){return this.frontFaceCallback=Ey(t,e,this.gameObject),this}setBackFace(t,e){return this.backFaceCallback=Ey(t,e,this.gameObject),this}start(){if(this.isRunning)return this;var t={targets:this.gameObject,delay:this.delay,duration:this.duration/2,ease:this.ease,yoyo:!0,repeat:0,onYoyo:this.toggleFace,onYoyoScope:this};return t[0===this.orientation?"scaleX":"scaleY"]={start:1,to:0},super.start(t),this}flip(t){return this.isRunning||(void 0!==t&&this.setDuration(t),this.start()),this}};zr.register("flip",(function(t,e){return new jy(t,e)})),Qr(window,"RexPlugins.UI.Flip",jy);const zy=Phaser.Math.Vector3,Dy=Phaser.Math.Matrix4;var Ly=new zy,Ry=new zy,Uy=new Dy,Fy=function(t,e,i,s,n,r,a){void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===a&&(a=0),Ly.set(e,i,s),Ry.set(n,r,a),Uy.fromRotationXYTranslation(Ry,Ly,!0);for(var o=0,h=t.vertices.length;o<h;o++)t.vertices[o].transformMat4(Uy)};const Wy=Phaser.GameObjects.Mesh,Yy=Phaser.Utils.Objects.IsPlainObject,Ay=Phaser.Utils.Objects.GetValue,Hy=Phaser.Geom.Mesh.GenerateGridVerts,Vy=Phaser.Math.RadToDeg,Ny=Phaser.Math.DegToRad,Gy=1+1/Math.sin(Ny(45));var Xy=class extends Wy{constructor(t,e,i,s,n,r){Yy(e)&&(e=Ay(r=e,"x",0),i=Ay(r,"y",0),s=Ay(r,"key",null),n=Ay(r,"frame",null)),super(t,e,i,s,n),this.type="rexPerspectiveImage",this.setSizeToFrame(),this.resetPerspective(),this.panZ(Gy),this.hideCCW=Ay(r,"hideCCW",!0);var a=Ay(r,"gridWidth",32),o=Ay(r,"girdHeight",a);this.resetVerts(a,o)}resetPerspective(){return this.setPerspective(this.width,this.height,45),this}resetVerts(t,e){if(void 0!==t&&(this.girdWidth=t),void 0!==e&&(this.girdHeight=e),this.clear(),this.dirtyCache[9]=-1,0===this.width||0===this.height)return this;var i=this.frame.cutWidth,s=this.frame.cutHeight;return Hy({mesh:this,texture:this.texture.key,frame:this.frame.name,width:i/this.height,height:s/this.height,widthSegments:Math.ceil(i/this.girdWidth),heightSegments:Math.ceil(s/this.girdHeight),flipY:this.frame.source.isRenderTexture}),this}syncSize(){return this.setSizeToFrame(),this.resetPerspective(),this.resetVerts(),this}get rotationX(){return this.modelRotation.x}set rotationX(t){this.modelRotation.x=t}get angleX(){return Vy(this.rotationX)}set angleX(t){this.rotationX=Ny(t)}get rotationY(){return this.modelRotation.y}set rotationY(t){this.modelRotation.y=t}get angleY(){return Vy(this.rotationY)}set angleY(t){this.rotationY=Ny(t)}get rotationZ(){return this.modelRotation.z}set rotationZ(t){this.modelRotation.z=t}get angleZ(){return Vy(this.rotationZ)}set angleZ(t){this.rotationZ=Ny(t)}transformVerts(t,e,i,s,n,r){return Fy(this,t,e,i,s,n,r),this}forceUpdate(){return this.dirtyCache[10]=1,this}};const Jy=Phaser.GameObjects.RenderTexture,Ky=Phaser.Utils.Objects.IsPlainObject,Zy=Phaser.Utils.Objects.GetValue;var qy=class extends Xy{constructor(t,e,i,s,n,r){Ky(e)&&(e=Zy(r=e,"x",0),i=Zy(r,"y",0),s=Zy(r,"width",32),n=Zy(r,"height",32));var a=new Jy(t,e,i,s,n).setOrigin(.5);super(t,e,i,a.texture.key,null,r),this.type="rexPerspectiveRenderTexture",this.rt=a}destroy(t){super.destroy(t),this.rt.destroy(t),this.rt=null}};const $y=Phaser.Geom.Rectangle,Qy=Phaser.Geom.Rectangle.Union;var tw,ew,iw=function(t,e){var i;void 0===e?e=new $y:!0===e&&(void 0===ew&&(ew=new $y),e=ew);for(var s=!0,n=0,r=t.length;n<r;n++)(i=t[n]).getBounds&&(tw=i.getBounds(tw),s?(e.setTo(tw.x,tw.y,tw.width,tw.height),s=!1):Qy(tw,e,e));return e},sw=function(t,e){if(0===t.length)return t;void 0===e&&(e=!1);var i=t[0].scene.sys.displayList;return i.depthSort(),e?t.sort((function(t,e){return i.getIndex(e)-i.getIndex(t)})):t.sort((function(t,e){return i.getIndex(t)-i.getIndex(e)})),t},nw=Phaser.Utils.Objects.GetValue,rw=function(t){var e=t.gameObjects,i=t.renderTexture;if(0===e.length)return i&&i.setSize(1,1).clear(),i;var s,n,r=nw(t,"x",void 0),a=nw(t,"y",void 0),o=nw(t,"width",void 0),h=nw(t,"height",void 0),l=nw(t,"originX",0),d=nw(t,"originY",0);if(void 0===o||void 0===h||void 0===r||void 0===a){var c=iw(e,!0);void 0!==r&&void 0!==a?(o=2*Math.max(r-c.left,c.right-r),h=2*Math.max(a-c.top,c.bottom-a),l=.5,d=.5):(r=c.x,a=c.y,o=c.width,h=c.height,l=0,d=0),s=c.x,n=c.y}else s=r+(0-l)*o,n=a+(0-d)*h;i?(i.setPosition(r,a),i.width===o&&i.height===h||i.setSize(o,h)):i=e[0].scene.add.renderTexture(r,a,o,h);return i.setOrigin(l,d),i.camera.setScroll(s,n),e=sw(ya(e)),i.draw(e),i};const aw=Dh.prototype.add,ow=Phaser.Utils.Objects.GetValue;var hw=class extends qy{constructor(t,e){var i=t.scene;super(i,t.x,t.y,1,1,e),i.add.existing(this),this.setVisible(!1),aw.call(t,this),this.visibleSibling=[],this.perspectiveState=!1,this.useParentBounds=ow(e,"useParentBounds",!1),this.boot()}boot(){this.rexContainer.parent.on("destroy",this.destroy,this)}destroy(t){this.exit(),super.destroy(t)}enter(){this.exit();var t=this.rexContainer.parent;return rw({gameObjects:t.getAllVisibleChildren(),renderTexture:this.rt,x:this.x,y:this.y,width:this.useParentBounds?t.displayWidth:void 0,height:this.useParentBounds?t.displayHeighth:void 0,originX:this.useParentBounds?t.originX:void 0,originY:this.useParentBounds?t.originY:void 0}),this.syncSize(),t.setChildVisible(this,!0),t.children.forEach((function(e){e!==this&&(t.setChildVisible(e,!1),this.visibleSibling.push(e))}),this),this.perspectiveState=!0,this}exit(){var t=this.rexContainer.parent;return this.visibleSibling.forEach((function(e){t.setChildVisible(e,!0)}),this),this.visibleSibling.length=0,t.setChildVisible(this,!1),this.perspectiveState=!1,this}};zr.register("perspective",(function(t,e){return new hw(t,e)})),Qr(window,"RexPlugins.UI.Perspective",hw);const lw=oh,dw=hh;var cw=function(t,e){if(this.scene.scale.autoRound&&(t=Math.floor(t),e=Math.floor(e)),this.width===t&&this.height===e)return this;var i=this.node.style;return i.width=t+"px",i.height=e+"px",this.updateSize(),this};const uw=Phaser.Utils.Objects.GetValue;var pw=function(t,e,i){var s,n;for(var r in void 0===i&&(i={}),t)s=t[r],void 0!==(n=uw(e,r,s[1]))&&(i[s[0]]=n);return i},gw=function(t,e,i){for(let s in i)e[i[s]]=function(e){t.emit(s,t,e)}},mw=function(t){t.stopPropagation()},fw=function(t){t.addEventListener("touchstart",mw,!1),t.addEventListener("touchmove",mw,!1),t.addEventListener("touchend",mw,!1),t.addEventListener("mousedown",mw,!1),t.addEventListener("mouseup",mw,!1),t.addEventListener("mousemove",mw,!1)};const vw=Phaser.GameObjects.DOMElement,bw=Phaser.Utils.Objects.IsPlainObject,xw=Phaser.Utils.Objects.GetValue;class yw extends vw{constructor(t,e,i,s,n,r){var a;bw(e)?(e=xw(r=e,"x",0),i=xw(r,"y",0),s=xw(r,"width",0),n=xw(r,"height",0)):bw(s)&&(s=xw(r=s,"width",0),n=xw(r,"height",0)),void 0===r&&(r={});var o=xw(r,"type","text");"textarea"===o?(a=document.createElement("textarea")).style.resize="none":(a=document.createElement("input")).type=o,pw(kw,r,a);var h=xw(r,"style",void 0);h=pw(Cw,r,h);var l=a.style;for(var d in r)d in kw||d in Cw||d in l&&(h[d]=r[d]);h["box-sizing"]="border-box",super(t,e,i,a,h),this.type="rexInputText",this.resize(s,n),gw(this,a,_w),fw(a),xw(r,"selectAll",!1)&&this.selectAll()}get text(){return this.node.value}set text(t){this.node.value=t}setText(t){return this.text=t,this}get maxLength(){return this.node.maxLength}set maxLength(t){this.node.maxLength=t}setMaxLength(t){return this.maxLength=t,this}get minLength(){return this.node.minLength}set minLength(t){this.node.minLength=t}setMinLength(t){return this.minLength=t,this}get placeholder(){return this.node.placeholder}set placeholder(t){this.node.placeholder=t}setPlaceholder(t){return this.placeholder=t,this}selectText(){return this.node.select(),this}get tooltip(){return this.node.title}set tooltip(t){this.node.title=t}setTooltip(t){return this.tooltip=t,this}setTextChangedCallback(t){return this.onTextChanged=t,this}get readOnly(){return this.node.readOnly}set readOnly(t){this.node.readOnly=t}setReadOnly(t){return void 0===t&&(t=!0),this.readOnly=t,this}get spellCheck(){return this.node.spellcheck}set spellCheck(t){this.node.spellcheck=t}setSpellCheck(t){return this.spellCheck=t,this}get fontColor(){return this.node.style.color}set fontColor(t){this.node.style.color=t}setFontColor(t){return this.fontColor=t,this}setStyle(t,e){return this.node.style[t]=e,this}getStyle(t){return this.node.style[t]}scrollToBottom(){return this.node.scrollTop=this.node.scrollHeight,this}setEnabled(t){return void 0===t&&(t=!0),this.node.disabled=!t,this}setBlur(){return this.node.blur(),this}setFocus(){return this.node.focus(),this}selectAll(){return this.node.select(),this}}var ww={resize:cw};Object.assign(yw.prototype,ww);const kw={id:["id",void 0],text:["value",void 0],maxLength:["maxLength",void 0],minLength:["minLength",void 0],placeholder:["placeholder",void 0],tooltip:["title",void 0],readOnly:["readOnly",!1],spellCheck:["spellcheck",!1],autoComplete:["autocomplete","off"]},Cw={align:["textAlign",void 0],paddingLeft:["padding-left",void 0],paddingRight:["padding-right",void 0],paddingTop:["padding-top",void 0],paddingBottom:["padding-bottom",void 0],fontFamily:["fontFamily",void 0],fontSize:["font-size",void 0],color:["color","#ffffff"],backgroundColor:["backgroundColor","transparent"],border:["border",0],borderColor:["borderColor","transparent"],outline:["outline","none"]},_w={textchange:"oninput",click:"onclick",dblclick:"ondblclick",focus:"onfocus",blur:"onblur"};var Sw=yw;const Tw=Phaser.Utils.Objects.GetValue;var Ow=function(t){return t.hasOwnProperty("align")?t.align:t.hasOwnProperty("halign")?t.halign:"left"},Ew=function(t,e){void 0===e&&(e={});var i=t.scene,s=t.style,n=Tw(e,"backgroundColor",s.backgroundColor);null===n&&(n="transparent"),e.text=Tw(e,"text",t.text),e.fontFamily=Tw(e,"fontFamily",s.fontFamily),e.fontSize=Tw(e,"fontSize",s.fontSize),e.color=Tw(e,"color",s.color),e.backgroundColor=n,e.align=Tw(e,"align",Ow(s));var r=new Sw(i,t.x,t.y,Tw(e,"width",t.width),Tw(e,"height",t.height),e);return r.setOrigin(t.originX,t.originY),i.add.existing(r),r};const Pw=Phaser.Utils.Objects.GetValue;var Mw=void 0,Iw=class{constructor(t){this.gameObject=t,this.scene=Wd(t),this.inputText=void 0,this.onClose=void 0,this.delayCall=void 0,this.boot()}boot(){return this.gameObject.on("destroy",this.destroy,this),this}shutdown(){return this.close(),this.gameObject=void 0,this.scene=void 0,Mw===this&&(Mw=void 0),this}destroy(){return this.shutdown(),this}open(t,e){void 0!==Mw&&Mw.close(),Mw=this,Oc(t)&&(e=t,t=void 0),void 0===e&&(e=Pw(t,"onClose",void 0));var i=Pw(t,"onTextChanged",void 0);return this.inputText=Ew(this.gameObject,t).on("textchange",(function(t){var e=t.text;i?i(this.gameObject,e):this.gameObject.text=e}),this).setFocus(),this.gameObject.setVisible(!1),this.onClose=e,this.scene.input.keyboard.once("keydown-ENTER",this.close,this),this.delayCall=this.scene.time.delayedCall(0,(function(){this.scene.input.once("pointerdown",this.close,this)}),[],this),this}close(){return Mw=void 0,this.inputText?(this.gameObject.setVisible(!0),this.inputText.destroy(),this.inputText=void 0,this.delayCall&&(this.delayCall.remove(),this.delayCall=void 0),this.scene.input.keyboard.off("keydown-ENTER",this.close,this),this.scene.input.off("pointerdown",this.close,this),this.onClose&&this.onClose(this.gameObject),this):this}get isOpened(){return void 0!==this.inputText}get text(){return this.isOpened?this.inputText.text:this.gameObject.text}},Bw=function(t,e,i){return t._edit||(t._edit=new Iw(t)),t._edit.open(e,i),t._edit},jw=function(t,e,i){for(var s,n=0,r=t.length;n<r;n++)if(s=t[n],Ic(s,e,i))return s.pointToChild(e,i);return null},zw=function(t,e,i,s,n,r){var a;(a=void 0===n?s:jw(i,s,n))&&t.emit(e,a,r)};const Dw=Phaser.Utils.Objects.GetValue;var Lw=function(t){var e=Dw(t,"click",void 0);!1!==e&&(void 0===e&&(e={}),e.hasOwnProperty("threshold")||(e.threshold=10),this._click=new Ap(this,e),this._click.on("click",(function(t,e,i){zw(this.eventEmitter,this.input.eventNamePrefix+"click",this.input.targetSizers,i.x,i.y,i)}),this))};const Rw=Phaser.Utils.Objects.GetValue;var Uw=function(t){var e=jw(this.input.targetSizers,t.x,t.y),i=this.input.lastOverChild;e&&i&&e===i||(this.input.lastOverChild=e,zw(this.eventEmitter,this.input.eventNamePrefix+"out",this.input.targetSizers,i,void 0,t),zw(this.eventEmitter,this.input.eventNamePrefix+"over",this.input.targetSizers,e,void 0,t))},Fw=function(t){var e=this.input.lastOverChild;this.input.lastOverChild=null,zw(this.eventEmitter,this.input.eventNamePrefix+"out",this.input.targetSizers,e,void 0,t)},Ww=function(t){!1!==Rw(t,"over",void 0)&&this.on("pointermove",Uw,this).on("pointerover",Uw,this).on("pointerout",Fw,this)};const Yw=Phaser.Utils.Objects.GetValue;var Aw=function(t){var e=Yw(t,"tap",void 0);!1!==e&&(this._tap=new hv(this,e),this._tap.on("tap",(function(t,e,i){zw(this.eventEmitter,`${this.input.eventNamePrefix}${t.tapsCount}tap`,this.input.targetSizers,t.x,t.y,i)}),this))};const Hw=Phaser.Utils.Objects.GetValue;var Vw=function(t){var e=Hw(t,"press",void 0);!1!==e&&(this._press=new mv(this,e),this._press.on("pressstart",(function(t,e,i){zw(this.eventEmitter,this.input.eventNamePrefix+"pressstart",this.input.targetSizers,t.x,t.y,i)}),this).on("pressend",(function(t,e,i){zw(this.eventEmitter,this.input.eventNamePrefix+"pressend",this.input.targetSizers,t.x,t.y,i)}),this))};const Nw=Phaser.Utils.Objects.GetValue;var Gw=function(t){var e=Nw(t,"swipe",void 0);!1!==e&&(void 0===e&&(e={}),e.dir="4dir",this._swipe=new Mv(this,e),this._swipe.on("swipe",(function(t,e,i){var s=t.left?"left":t.right?"right":t.up?"up":"down";zw(this.eventEmitter,`${this.input.eventNamePrefix}swipe${s}`,this.input.targetSizers,t.x,t.y,i)}),this))};const Xw=Phaser.Utils.Objects.GetValue;var Jw=function(t,e){return t.setInteractive(),t.eventEmitter=Xw(e,"eventEmitter",t),t.input.targetSizers=Xw(e,"targets",[t]),t.input.eventNamePrefix=Xw(e,"inputEventPrefix","child."),Lw.call(t,e),Ww.call(t,e),Aw.call(t,e),Vw.call(t,e),Gw.call(t,e),t};class Kw extends Phaser.Plugins.ScenePlugin{constructor(t,e){super(t,e),this.add=new zr(t)}start(){this.scene.events.on("destroy",this.destroy,this)}get viewport(){return zd(this.scene,!0)}}var Zw={getParentSizer:lw,getTopmostSizer:dw,hide:rg,show:ng,isShown:ag,edit:Bw,isInTouching:Sc,waitEvent:Qd,waitComplete:tc,setChildrenInteractive:Jw};Object.assign(Kw.prototype,Zw);var qw=Kw;class $w extends Phaser.Game{constructor(){super({type:Phaser.AUTO,parent:"game",width:600,height:900,scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},roundPixels:!0,plugins:{scene:[{key:"rexUI",plugin:qw,mapping:"rexUI"}]}}),this.scene.add("boot",s,!1),this.scene.add("menu",Ii,!1),this.scene.add("load",n,!1),this.scene.add("play",Mr,!1),this.scene.add("UI",Sr,!1),this.scene.start("boot")}}window.game=new $w}]);